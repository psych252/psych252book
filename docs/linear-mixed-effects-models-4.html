<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Linear mixed effects models 4 | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Linear mixed effects models 4 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Linear mixed effects models 4 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2024-08-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-mixed-effects-models-3.html"/>
<link rel="next" href="generalized-linear-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#install-all-packages-needed-for-this-book"><i class="fa fa-check"></i><b>1.3</b> Install all packages needed for this book</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#some-basics"><i class="fa fa-check"></i><b>2.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.4.2</b> Getting help</a></li>
<li class="chapter" data-level="2.4.3" data-path="visualization-1.html"><a href="visualization-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>2.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="2.4.4" data-path="visualization-1.html"><a href="visualization-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization"><i class="fa fa-check"></i><b>2.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization-1.html"><a href="visualization-1.html#bar-plot"><i class="fa fa-check"></i><b>2.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.5.4" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5.5" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.5.5</b> Line plot</a></li>
<li class="chapter" data-level="2.5.6" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="2.5.7" data-path="visualization-1.html"><a href="visualization-1.html#order-matters"><i class="fa fa-check"></i><b>2.5.7</b> Order matters</a></li>
<li class="chapter" data-level="2.5.8" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="2.5.9" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.5.9</b> Making facets</a></li>
<li class="chapter" data-level="2.5.10" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.3.1</b> Modes</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.3.2</b> Data types</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.3.3</b> Operators</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.3.4</b> Control flow</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.3.5</b> Functions</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>4.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.6.1</b> csv</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>6</b> Probability</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability.html"><a href="probability.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>6.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.2" data-path="probability.html"><a href="probability.html#counting"><i class="fa fa-check"></i><b>6.2</b> Counting</a></li>
<li class="chapter" data-level="6.3" data-path="probability.html"><a href="probability.html#the-random-secretary"><i class="fa fa-check"></i><b>6.3</b> The random secretary</a></li>
<li class="chapter" data-level="6.4" data-path="probability.html"><a href="probability.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability.html"><a href="probability.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="probability.html"><a href="probability.html#conditional-probability"><i class="fa fa-check"></i><b>6.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.5.2" data-path="probability.html"><a href="probability.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="probability.html"><a href="probability.html#probability-operations"><i class="fa fa-check"></i><b>6.6</b> Probability operations</a></li>
<li class="chapter" data-level="6.7" data-path="probability.html"><a href="probability.html#bayesian-reasoning-explained"><i class="fa fa-check"></i><b>6.7</b> Bayesian reasoning explained</a></li>
<li class="chapter" data-level="6.8" data-path="probability.html"><a href="probability.html#getting-bayes-right-matters"><i class="fa fa-check"></i><b>6.8</b> Getting Bayes right matters</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="probability.html"><a href="probability.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8.1</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.8.2" data-path="probability.html"><a href="probability.html#bayesian-reasoning-example-covid-rapid-test"><i class="fa fa-check"></i><b>6.8.2</b> Bayesian reasoning example (COVID rapid test)</a></li>
<li class="chapter" data-level="6.8.3" data-path="probability.html"><a href="probability.html#most-people-in-the-hospital-are-vaccinated"><i class="fa fa-check"></i><b>6.8.3</b> Most people in the hospital are vaccinated</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="probability.html"><a href="probability.html#building-a-bayesis"><i class="fa fa-check"></i><b>6.9</b> Building a Bayesis</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="probability.html"><a href="probability.html#dice-example"><i class="fa fa-check"></i><b>6.9.1</b> Dice example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability.html"><a href="probability.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="probability.html"><a href="probability.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability.html"><a href="probability.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability.html"><a href="probability.html#misc-2"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability.html"><a href="probability.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>7.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>7.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="7.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>7.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="7.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>7.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="7.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>7.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="7.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>7.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>8.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>8.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>8.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-2.html"><a href="simulation-2.html#misc-3"><i class="fa fa-check"></i><b>8.5.1</b> Misc</a></li>
<li class="chapter" data-level="8.5.2" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-1"><i class="fa fa-check"></i><b>8.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.2.2" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.2.2</b> Sampling distributions for median and mean</a></li>
<li class="chapter" data-level="9.2.3" data-path="modeling-data.html"><a href="modeling-data.html#residuals-need-to-be-normally-distributed-not-the-data-itself"><i class="fa fa-check"></i><b>9.2.3</b> Residuals need to be normally distributed, not the data itself</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#misc-4"><i class="fa fa-check"></i><b>9.5</b> Misc</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-2"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-8"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.2</b> Correlation</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.3.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.3.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.4</b> Credit example</a></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-3"><i class="fa fa-check"></i><b>10.5.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-5"><i class="fa fa-check"></i><b>10.5.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-9"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-3"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-4"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-6"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-10"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
<li class="chapter" data-level="11.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>11.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-4"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-5"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-7"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-11"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.2</b> Load data sets</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>13.3</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>13.4</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#linear-contrasts"><i class="fa fa-check"></i><b>13.5</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.5.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.5.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.5.2</b> Visualization</a></li>
<li class="chapter" data-level="13.5.3" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.5.3</b> Post-hoc tests</a></li>
<li class="chapter" data-level="13.5.4" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>13.5.4</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="13.5.5" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-sum-coding"><i class="fa fa-check"></i><b>13.5.5</b> Understanding sum coding</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="linear-model-4.html"><a href="linear-model-4.html#additional-resources-11"><i class="fa fa-check"></i><b>13.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="linear-model-4.html"><a href="linear-model-4.html#misc-8"><i class="fa fa-check"></i><b>13.6.1</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-12"><i class="fa fa-check"></i><b>13.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-5"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-1"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-12"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-6"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-5"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-9"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-13"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>15</b> Model comparison</a>
<ul>
<li class="chapter" data-level="15.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-6"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>15.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>15.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="15.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>15.3.2</b> F-test</a></li>
<li class="chapter" data-level="15.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>15.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="15.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>15.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="15.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>15.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>15.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>15.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="15.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>15.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-14"><i class="fa fa-check"></i><b>15.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="causation.html"><a href="causation.html"><i class="fa fa-check"></i><b>16</b> Causation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="causation.html"><a href="causation.html#learning-goals-7"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="causation.html"><a href="causation.html#recommended-reading"><i class="fa fa-check"></i><b>16.2</b> Recommended reading</a></li>
<li class="chapter" data-level="16.3" data-path="causation.html"><a href="causation.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.4" data-path="causation.html"><a href="causation.html#bayesian-networks"><i class="fa fa-check"></i><b>16.4</b> Bayesian networks</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="causation.html"><a href="causation.html#sprinkler-example"><i class="fa fa-check"></i><b>16.4.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="causation.html"><a href="causation.html#controlling-for-variables"><i class="fa fa-check"></i><b>16.5</b> Controlling for variables</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="causation.html"><a href="causation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>16.5.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="16.5.2" data-path="causation.html"><a href="causation.html#good-controls"><i class="fa fa-check"></i><b>16.5.2</b> Good controls</a></li>
<li class="chapter" data-level="16.5.3" data-path="causation.html"><a href="causation.html#bad-controls"><i class="fa fa-check"></i><b>16.5.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="causation.html"><a href="causation.html#mediation"><i class="fa fa-check"></i><b>16.6</b> Mediation</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="causation.html"><a href="causation.html#generate-data"><i class="fa fa-check"></i><b>16.6.1</b> Generate data</a></li>
<li class="chapter" data-level="16.6.2" data-path="causation.html"><a href="causation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>16.6.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="16.6.3" data-path="causation.html"><a href="causation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>16.6.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="16.6.4" data-path="causation.html"><a href="causation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>16.6.4</b> Method 3: Bootstrapping</a></li>
<li class="chapter" data-level="16.6.5" data-path="causation.html"><a href="causation.html#be-careful-about-mediation"><i class="fa fa-check"></i><b>16.6.5</b> Be careful about mediation!</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="causation.html"><a href="causation.html#moderation"><i class="fa fa-check"></i><b>16.7</b> Moderation</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="causation.html"><a href="causation.html#generate-data-1"><i class="fa fa-check"></i><b>16.7.1</b> Generate data</a></li>
<li class="chapter" data-level="16.7.2" data-path="causation.html"><a href="causation.html#moderation-analysis"><i class="fa fa-check"></i><b>16.7.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="causation.html"><a href="causation.html#additional-resources-14"><i class="fa fa-check"></i><b>16.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="causation.html"><a href="causation.html#books"><i class="fa fa-check"></i><b>16.8.1</b> Books</a></li>
<li class="chapter" data-level="16.8.2" data-path="causation.html"><a href="causation.html#tutorials-1"><i class="fa fa-check"></i><b>16.8.2</b> Tutorials</a></li>
<li class="chapter" data-level="16.8.3" data-path="causation.html"><a href="causation.html#misc-10"><i class="fa fa-check"></i><b>16.8.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="causation.html"><a href="causation.html#session-info-15"><i class="fa fa-check"></i><b>16.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-8"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-15"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-16"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-9"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>18.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>18.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="18.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>18.3.2</b> No pooling</a></li>
<li class="chapter" data-level="18.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>18.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="18.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>18.3.4</b> Compare results</a></li>
<li class="chapter" data-level="18.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>18.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="18.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>18.3.6</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>18.4</b> Simulating a linear mixed effects model</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.4.1</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.4.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.4.2</b> Different slopes</a></li>
<li class="chapter" data-level="18.4.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.4.3</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-16"><i class="fa fa-check"></i><b>18.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-17"><i class="fa fa-check"></i><b>18.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-10"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-4"><i class="fa fa-check"></i><b>19.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>19.3.1</b> Reasoning data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>19.5</b> ANOVA vs. lmer</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>19.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>19.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>19.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#additional-resources-17"><i class="fa fa-check"></i><b>19.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#readings-2"><i class="fa fa-check"></i><b>19.6.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-18"><i class="fa fa-check"></i><b>19.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html"><i class="fa fa-check"></i><b>20</b> Linear mixed effects models 4</a>
<ul>
<li class="chapter" data-level="20.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#learning-goals-11"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-data-sets-5"><i class="fa fa-check"></i><b>20.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-data"><i class="fa fa-check"></i><b>20.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="20.3.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#reasoning-data-1"><i class="fa fa-check"></i><b>20.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="20.3.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-data"><i class="fa fa-check"></i><b>20.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="20.3.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politness-data"><i class="fa fa-check"></i><b>20.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>20.4</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-study"><i class="fa fa-check"></i><b>20.4.1</b> Sleep study</a></li>
<li class="chapter" data-level="20.4.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-study"><i class="fa fa-check"></i><b>20.4.2</b> Weight loss study</a></li>
<li class="chapter" data-level="20.4.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politeness-study"><i class="fa fa-check"></i><b>20.4.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#mixtures-of-participants"><i class="fa fa-check"></i><b>20.5</b> Mixtures of participants</a></li>
<li class="chapter" data-level="20.6" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#simulating-different-random-effects-structures"><i class="fa fa-check"></i><b>20.6</b> Simulating different random effects structures</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#two-level-model"><i class="fa fa-check"></i><b>20.6.1</b> Two-level model</a></li>
<li class="chapter" data-level="20.6.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#three-level-model"><i class="fa fa-check"></i><b>20.6.2</b> Three-level model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#bootstrapping"><i class="fa fa-check"></i><b>20.7</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-model"><i class="fa fa-check"></i><b>20.7.1</b> Linear model</a></li>
<li class="chapter" data-level="20.7.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>20.7.2</b> Linear mixed effects model</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#session-info-19"><i class="fa fa-check"></i><b>20.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>21</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="21.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-12"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>21.3</b> Load data set</a></li>
<li class="chapter" data-level="21.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>21.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>21.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="21.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>21.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="21.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>21.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="21.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>21.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="21.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>21.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>21.5</b> Simulate a logistic regression</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#calculate-the-models-likelihood"><i class="fa fa-check"></i><b>21.5.1</b> Calculate the model’s likelihood</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>21.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="21.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>21.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="21.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>21.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#misc-11"><i class="fa fa-check"></i><b>21.8.1</b> Misc</a></li>
<li class="chapter" data-level="21.8.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-7"><i class="fa fa-check"></i><b>21.8.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-20"><i class="fa fa-check"></i><b>21.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 1</a>
<ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-13"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>22.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#coin-flip-example"><i class="fa fa-check"></i><b>22.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="22.3.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>22.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>22.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#attitude-data-set"><i class="fa fa-check"></i><b>22.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#frequentist-analysis"><i class="fa fa-check"></i><b>22.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-regression"><i class="fa fa-check"></i><b>22.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#additional-resources-18"><i class="fa fa-check"></i><b>22.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#books-and-chapters-5"><i class="fa fa-check"></i><b>22.5.1</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-21"><i class="fa fa-check"></i><b>22.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-14"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-6"><i class="fa fa-check"></i><b>23.3</b> Load data sets</a></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>23.4</b> Poker</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>23.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>23.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>23.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>23.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="23.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>23.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>23.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>23.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>23.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>23.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>23.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>23.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>23.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>23.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>23.6.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>23.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>23.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>23.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>23.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>23.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>23.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="23.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-3"><i class="fa fa-check"></i><b>23.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-3"><i class="fa fa-check"></i><b>23.7.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.7.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>23.7.3</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-19"><i class="fa fa-check"></i><b>23.8</b> Additional resources</a></li>
<li class="chapter" data-level="23.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-22"><i class="fa fa-check"></i><b>23.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>24</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="24.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-15"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>24.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>24.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="24.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>24.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>24.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-4"><i class="fa fa-check"></i><b>24.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="24.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>24.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="24.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>24.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>24.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="24.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>24.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>24.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-20"><i class="fa fa-check"></i><b>24.7</b> Additional resources</a></li>
<li class="chapter" data-level="24.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-23"><i class="fa fa-check"></i><b>24.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>25</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="25.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-16"><i class="fa fa-check"></i><b>25.1</b> Learning goals</a></li>
<li class="chapter" data-level="25.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-18"><i class="fa fa-check"></i><b>25.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="25.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>25.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>25.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="25.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>25.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="25.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>25.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="25.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>25.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="25.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>25.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-21"><i class="fa fa-check"></i><b>25.4</b> Additional resources</a></li>
<li class="chapter" data-level="25.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-24"><i class="fa fa-check"></i><b>25.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>26</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="26.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>26.1</b> General advice</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>26.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="26.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>26.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="26.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>26.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="26.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>26.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="26.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>26.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>26.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>26.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#additional-resources-22"><i class="fa fa-check"></i><b>26.3</b> Additional resources</a>
<ul>
<li class="chapter" data-level="26.3.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#misc-12"><i class="fa fa-check"></i><b>26.3.1</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-25"><i class="fa fa-check"></i><b>26.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html"><i class="fa fa-check"></i><b>27</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="27.1" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#statistics"><i class="fa fa-check"></i><b>27.1</b> Statistics</a></li>
<li class="chapter" data-level="27.2" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#r"><i class="fa fa-check"></i><b>27.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-mixed-effects-models-4" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">Chapter 20</span> Linear mixed effects models 4<a href="linear-mixed-effects-models-4.html#linear-mixed-effects-models-4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-11" class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Learning goals<a href="linear-mixed-effects-models-4.html#learning-goals-11" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Some worked examples.</li>
<li>Doing follow-up tests with the <code>emmeans</code> package</li>
<li>Simulating, plotting, and analyzing models with different random effects structures</li>
<li>Bootstrapping confidence intervals for fixed effects</li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-13" class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Load packages and set plotting theme<a href="linear-mixed-effects-models-4.html#load-packages-and-set-plotting-theme-13" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1097"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1097-1"><a href="linear-mixed-effects-models-4.html#cb1097-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)       <span class="co"># for knitting RMarkdown </span></span>
<span id="cb1097-2"><a href="linear-mixed-effects-models-4.html#cb1097-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>)  <span class="co"># for making nice tables</span></span>
<span id="cb1097-3"><a href="linear-mixed-effects-models-4.html#cb1097-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;janitor&quot;</span>)     <span class="co"># for cleaning column names</span></span>
<span id="cb1097-4"><a href="linear-mixed-effects-models-4.html#cb1097-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom.mixed&quot;</span>) <span class="co"># for tidying up linear mixed effects models </span></span>
<span id="cb1097-5"><a href="linear-mixed-effects-models-4.html#cb1097-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lme4&quot;</span>)        <span class="co"># for linear mixed effects models</span></span>
<span id="cb1097-6"><a href="linear-mixed-effects-models-4.html#cb1097-6" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;afex&quot;</span>)        <span class="co"># for ANOVAs</span></span>
<span id="cb1097-7"><a href="linear-mixed-effects-models-4.html#cb1097-7" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;car&quot;</span>)         <span class="co"># for ANOVAs</span></span>
<span id="cb1097-8"><a href="linear-mixed-effects-models-4.html#cb1097-8" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;datarium&quot;</span>)    <span class="co"># for ANOVA dataset</span></span>
<span id="cb1097-9"><a href="linear-mixed-effects-models-4.html#cb1097-9" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;modelr&quot;</span>)      <span class="co"># for bootstrapping</span></span>
<span id="cb1097-10"><a href="linear-mixed-effects-models-4.html#cb1097-10" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;boot&quot;</span>)        <span class="co"># also for bootstrapping</span></span>
<span id="cb1097-11"><a href="linear-mixed-effects-models-4.html#cb1097-11" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggeffects&quot;</span>)   <span class="co"># for plotting marginal effects</span></span>
<span id="cb1097-12"><a href="linear-mixed-effects-models-4.html#cb1097-12" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;emmeans&quot;</span>)     <span class="co"># for marginal effects</span></span>
<span id="cb1097-13"><a href="linear-mixed-effects-models-4.html#cb1097-13" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)   <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<div class="sourceCode" id="cb1098"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1098-1"><a href="linear-mixed-effects-models-4.html#cb1098-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb1098-2"><a href="linear-mixed-effects-models-4.html#cb1098-2" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb1098-3"><a href="linear-mixed-effects-models-4.html#cb1098-3" tabindex="-1"></a></span>
<span id="cb1098-4"><a href="linear-mixed-effects-models-4.html#cb1098-4" tabindex="-1"></a><span class="co"># knitr display options </span></span>
<span id="cb1098-5"><a href="linear-mixed-effects-models-4.html#cb1098-5" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb1098-6"><a href="linear-mixed-effects-models-4.html#cb1098-6" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span>
<span id="cb1098-7"><a href="linear-mixed-effects-models-4.html#cb1098-7" tabindex="-1"></a></span>
<span id="cb1098-8"><a href="linear-mixed-effects-models-4.html#cb1098-8" tabindex="-1"></a><span class="co"># suppress grouping warning messages</span></span>
<span id="cb1098-9"><a href="linear-mixed-effects-models-4.html#cb1098-9" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> F)</span></code></pre></div>
</div>
<div id="load-data-sets-5" class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Load data sets<a href="linear-mixed-effects-models-4.html#load-data-sets-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sleep-data" class="section level3 hasAnchor" number="20.3.1">
<h3><span class="header-section-number">20.3.1</span> Sleep data<a href="linear-mixed-effects-models-4.html#sleep-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1099"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1099-1"><a href="linear-mixed-effects-models-4.html#cb1099-1" tabindex="-1"></a><span class="co"># load sleepstudy data set </span></span>
<span id="cb1099-2"><a href="linear-mixed-effects-models-4.html#cb1099-2" tabindex="-1"></a>df.sleep <span class="ot">=</span> sleepstudy <span class="sc">%&gt;%</span> </span>
<span id="cb1099-3"><a href="linear-mixed-effects-models-4.html#cb1099-3" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1099-4"><a href="linear-mixed-effects-models-4.html#cb1099-4" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1099-5"><a href="linear-mixed-effects-models-4.html#cb1099-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subject =</span> <span class="fu">as.character</span>(subject)) <span class="sc">%&gt;%</span> </span>
<span id="cb1099-6"><a href="linear-mixed-effects-models-4.html#cb1099-6" tabindex="-1"></a>  <span class="fu">select</span>(subject, days, reaction)</span>
<span id="cb1099-7"><a href="linear-mixed-effects-models-4.html#cb1099-7" tabindex="-1"></a></span>
<span id="cb1099-8"><a href="linear-mixed-effects-models-4.html#cb1099-8" tabindex="-1"></a><span class="co"># add two fake participants (with missing data)</span></span>
<span id="cb1099-9"><a href="linear-mixed-effects-models-4.html#cb1099-9" tabindex="-1"></a>df.sleep <span class="ot">=</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1099-10"><a href="linear-mixed-effects-models-4.html#cb1099-10" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">subject =</span> <span class="st">&quot;374&quot;</span>,</span>
<span id="cb1099-11"><a href="linear-mixed-effects-models-4.html#cb1099-11" tabindex="-1"></a>                   <span class="at">days =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb1099-12"><a href="linear-mixed-effects-models-4.html#cb1099-12" tabindex="-1"></a>                   <span class="at">reaction =</span> <span class="fu">c</span>(<span class="dv">286</span>, <span class="dv">288</span>)),</span>
<span id="cb1099-13"><a href="linear-mixed-effects-models-4.html#cb1099-13" tabindex="-1"></a>            <span class="fu">tibble</span>(<span class="at">subject =</span> <span class="st">&quot;373&quot;</span>,</span>
<span id="cb1099-14"><a href="linear-mixed-effects-models-4.html#cb1099-14" tabindex="-1"></a>                   <span class="at">days =</span> <span class="dv">0</span>,</span>
<span id="cb1099-15"><a href="linear-mixed-effects-models-4.html#cb1099-15" tabindex="-1"></a>                   <span class="at">reaction =</span> <span class="dv">245</span>))</span></code></pre></div>
</div>
<div id="reasoning-data-1" class="section level3 hasAnchor" number="20.3.2">
<h3><span class="header-section-number">20.3.2</span> Reasoning data<a href="linear-mixed-effects-models-4.html#reasoning-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1100-1"><a href="linear-mixed-effects-models-4.html#cb1100-1" tabindex="-1"></a>df.reasoning <span class="ot">=</span> sk2011<span class="fl">.1</span></span></code></pre></div>
</div>
<div id="weight-loss-data" class="section level3 hasAnchor" number="20.3.3">
<h3><span class="header-section-number">20.3.3</span> Weight loss data<a href="linear-mixed-effects-models-4.html#weight-loss-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1101-1"><a href="linear-mixed-effects-models-4.html#cb1101-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;weightloss&quot;</span>, <span class="at">package =</span> <span class="st">&quot;datarium&quot;</span>)</span>
<span id="cb1101-2"><a href="linear-mixed-effects-models-4.html#cb1101-2" tabindex="-1"></a></span>
<span id="cb1101-3"><a href="linear-mixed-effects-models-4.html#cb1101-3" tabindex="-1"></a><span class="co"># Modify it to have three-way mixed design</span></span>
<span id="cb1101-4"><a href="linear-mixed-effects-models-4.html#cb1101-4" tabindex="-1"></a>df.weightloss <span class="ot">=</span> weightloss <span class="sc">%&gt;%</span></span>
<span id="cb1101-5"><a href="linear-mixed-effects-models-4.html#cb1101-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1101-6"><a href="linear-mixed-effects-models-4.html#cb1101-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> t1<span class="sc">:</span>t3,</span>
<span id="cb1101-7"><a href="linear-mixed-effects-models-4.html#cb1101-7" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;timepoint&quot;</span>,</span>
<span id="cb1101-8"><a href="linear-mixed-effects-models-4.html#cb1101-8" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1101-9"><a href="linear-mixed-effects-models-4.html#cb1101-9" tabindex="-1"></a>  <span class="fu">arrange</span>(id)</span></code></pre></div>
</div>
<div id="politness-data" class="section level3 hasAnchor" number="20.3.4">
<h3><span class="header-section-number">20.3.4</span> Politness data<a href="linear-mixed-effects-models-4.html#politness-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1102-1"><a href="linear-mixed-effects-models-4.html#cb1102-1" tabindex="-1"></a>df.politeness <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/politeness_data.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1102-2"><a href="linear-mixed-effects-models-4.html#cb1102-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">scenario =</span> <span class="fu">as.factor</span>(scenario))</span></code></pre></div>
<pre><code>Rows: 84 Columns: 5
── Column specification ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr (3): subject, gender, attitude
dbl (2): scenario, frequency

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div id="follow-up-tests-with-emmeans" class="section level2 hasAnchor" number="20.4">
<h2><span class="header-section-number">20.4</span> Follow-up tests with emmeans<a href="linear-mixed-effects-models-4.html#follow-up-tests-with-emmeans" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Just like with the linear model <code>lm()</code>, we can use linear contrasts to test more specific hypotheses with <code>lmer()</code>. The <code>emmeans()</code> function from the <code>emmeans</code> package will be our friend.</p>
<div id="sleep-study" class="section level3 hasAnchor" number="20.4.1">
<h3><span class="header-section-number">20.4.1</span> Sleep study<a href="linear-mixed-effects-models-4.html#sleep-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s ask some more specific question aboust the sleep study.</p>
<ol style="list-style-type: decimal">
<li>Do reaction times differ between day 0 and the first day of sleep deprivation?</li>
<li>Do reaction times differ between the first and the second half of the study?</li>
</ol>
<p>Let’s visualize the data first:</p>
<div class="sourceCode" id="cb1104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1104-1"><a href="linear-mixed-effects-models-4.html#cb1104-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1104-2"><a href="linear-mixed-effects-models-4.html#cb1104-2" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">days =</span> <span class="fu">as.factor</span>(days)),</span>
<span id="cb1104-3"><a href="linear-mixed-effects-models-4.html#cb1104-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1104-4"><a href="linear-mixed-effects-models-4.html#cb1104-4" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1104-5"><a href="linear-mixed-effects-models-4.html#cb1104-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>),</span>
<span id="cb1104-6"><a href="linear-mixed-effects-models-4.html#cb1104-6" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb1104-7"><a href="linear-mixed-effects-models-4.html#cb1104-7" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>And now let’s fit the model, and compute the contrasts:</p>
<div class="sourceCode" id="cb1105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1105-1"><a href="linear-mixed-effects-models-4.html#cb1105-1" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> subject),</span>
<span id="cb1105-2"><a href="linear-mixed-effects-models-4.html#cb1105-2" tabindex="-1"></a>           <span class="at">data =</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1105-3"><a href="linear-mixed-effects-models-4.html#cb1105-3" tabindex="-1"></a>             <span class="fu">mutate</span>(<span class="at">days =</span> <span class="fu">as.factor</span>(days)))</span>
<span id="cb1105-4"><a href="linear-mixed-effects-models-4.html#cb1105-4" tabindex="-1"></a></span>
<span id="cb1105-5"><a href="linear-mixed-effects-models-4.html#cb1105-5" tabindex="-1"></a>contrast <span class="ot">=</span> <span class="fu">list</span>(<span class="at">first_vs_second =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">8</span>)),</span>
<span id="cb1105-6"><a href="linear-mixed-effects-models-4.html#cb1105-6" tabindex="-1"></a>                <span class="at">early_vs_late =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">5</span>)<span class="sc">/</span><span class="dv">5</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>)<span class="sc">/</span><span class="dv">5</span>))</span>
<span id="cb1105-7"><a href="linear-mixed-effects-models-4.html#cb1105-7" tabindex="-1"></a></span>
<span id="cb1105-8"><a href="linear-mixed-effects-models-4.html#cb1105-8" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb1105-9"><a href="linear-mixed-effects-models-4.html#cb1105-9" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> <span class="st">&quot;days&quot;</span>,</span>
<span id="cb1105-10"><a href="linear-mixed-effects-models-4.html#cb1105-10" tabindex="-1"></a>          <span class="at">contr =</span> contrast) <span class="sc">%&gt;%</span> </span>
<span id="cb1105-11"><a href="linear-mixed-effects-models-4.html#cb1105-11" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>)</span></code></pre></div>
<pre><code> contrast        estimate    SE  df t.ratio p.value
 first_vs_second     7.82 10.10 156   0.775  0.4398
 early_vs_late      53.66  4.65 155  11.534  &lt;.0001

Degrees-of-freedom method: kenward-roger </code></pre>
<div class="sourceCode" id="cb1107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1107-1"><a href="linear-mixed-effects-models-4.html#cb1107-1" tabindex="-1"></a>df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1107-2"><a href="linear-mixed-effects-models-4.html#cb1107-2" tabindex="-1"></a>  <span class="co"># filter(days %in% c(0, 1)) %&gt;% </span></span>
<span id="cb1107-3"><a href="linear-mixed-effects-models-4.html#cb1107-3" tabindex="-1"></a>  <span class="fu">group_by</span>(days) <span class="sc">%&gt;%</span> </span>
<span id="cb1107-4"><a href="linear-mixed-effects-models-4.html#cb1107-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">reaction =</span> <span class="fu">mean</span>(reaction))</span></code></pre></div>
<pre><code># A tibble: 10 × 2
    days reaction
   &lt;dbl&gt;    &lt;dbl&gt;
 1     0     258.
 2     1     266.
 3     2     265.
 4     3     283.
 5     4     289.
 6     5     309.
 7     6     312.
 8     7     319.
 9     8     337.
10     9     351.</code></pre>
<div class="sourceCode" id="cb1109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1109-1"><a href="linear-mixed-effects-models-4.html#cb1109-1" tabindex="-1"></a>df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1109-2"><a href="linear-mixed-effects-models-4.html#cb1109-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">ifelse</span>(days <span class="sc">%in%</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&quot;early&quot;</span>, <span class="st">&quot;late&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1109-3"><a href="linear-mixed-effects-models-4.html#cb1109-3" tabindex="-1"></a>  <span class="fu">group_by</span>(index) <span class="sc">%&gt;%</span> </span>
<span id="cb1109-4"><a href="linear-mixed-effects-models-4.html#cb1109-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">reaction =</span> <span class="fu">mean</span>(reaction))</span></code></pre></div>
<pre><code># A tibble: 2 × 2
  index reaction
  &lt;chr&gt;    &lt;dbl&gt;
1 early     272.
2 late      325.</code></pre>
</div>
<div id="weight-loss-study" class="section level3 hasAnchor" number="20.4.2">
<h3><span class="header-section-number">20.4.2</span> Weight loss study<a href="linear-mixed-effects-models-4.html#weight-loss-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the weight loss data set, we want to check:</p>
<ol style="list-style-type: decimal">
<li>Whether there was a difference between the first two vs. the last time point.</li>
<li>Whether there was a linear trend across the time points.</li>
</ol>
<p>Let’s first visualize again:</p>
<div class="sourceCode" id="cb1111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1111-1"><a href="linear-mixed-effects-models-4.html#cb1111-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.weightloss,</span>
<span id="cb1111-2"><a href="linear-mixed-effects-models-4.html#cb1111-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> timepoint,</span>
<span id="cb1111-3"><a href="linear-mixed-effects-models-4.html#cb1111-3" tabindex="-1"></a>                     <span class="at">y =</span> score,</span>
<span id="cb1111-4"><a href="linear-mixed-effects-models-4.html#cb1111-4" tabindex="-1"></a>                     <span class="at">group =</span> diet,</span>
<span id="cb1111-5"><a href="linear-mixed-effects-models-4.html#cb1111-5" tabindex="-1"></a>                     <span class="at">color =</span> diet)) <span class="sc">+</span> </span>
<span id="cb1111-6"><a href="linear-mixed-effects-models-4.html#cb1111-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">dodge.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb1111-7"><a href="linear-mixed-effects-models-4.html#cb1111-7" tabindex="-1"></a>                                  <span class="at">jitter.width =</span> <span class="fl">0.1</span>,</span>
<span id="cb1111-8"><a href="linear-mixed-effects-models-4.html#cb1111-8" tabindex="-1"></a>                                  <span class="at">jitter.height =</span> <span class="dv">0</span>),</span>
<span id="cb1111-9"><a href="linear-mixed-effects-models-4.html#cb1111-9" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb1111-10"><a href="linear-mixed-effects-models-4.html#cb1111-10" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb1111-11"><a href="linear-mixed-effects-models-4.html#cb1111-11" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb1111-12"><a href="linear-mixed-effects-models-4.html#cb1111-12" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> exercises) <span class="sc">+</span> </span>
<span id="cb1111-13"><a href="linear-mixed-effects-models-4.html#cb1111-13" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span>
<span id="cb1111-14"><a href="linear-mixed-effects-models-4.html#cb1111-14" tabindex="-1"></a></span>
<span id="cb1111-15"><a href="linear-mixed-effects-models-4.html#cb1111-15" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.weightloss,</span>
<span id="cb1111-16"><a href="linear-mixed-effects-models-4.html#cb1111-16" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> timepoint,</span>
<span id="cb1111-17"><a href="linear-mixed-effects-models-4.html#cb1111-17" tabindex="-1"></a>                     <span class="at">y =</span> score)) <span class="sc">+</span> </span>
<span id="cb1111-18"><a href="linear-mixed-effects-models-4.html#cb1111-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>),</span>
<span id="cb1111-19"><a href="linear-mixed-effects-models-4.html#cb1111-19" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb1111-20"><a href="linear-mixed-effects-models-4.html#cb1111-20" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>) <span class="sc">+</span></span>
<span id="cb1111-21"><a href="linear-mixed-effects-models-4.html#cb1111-21" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-9-1.png" width="672" /><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-9-2.png" width="672" />
And then fit the model, and compute the contrasts:</p>
<div class="sourceCode" id="cb1112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1112-1"><a href="linear-mixed-effects-models-4.html#cb1112-1" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">&quot;id&quot;</span>,</span>
<span id="cb1112-2"><a href="linear-mixed-effects-models-4.html#cb1112-2" tabindex="-1"></a>       <span class="at">dv =</span> <span class="st">&quot;score&quot;</span>,</span>
<span id="cb1112-3"><a href="linear-mixed-effects-models-4.html#cb1112-3" tabindex="-1"></a>       <span class="at">between =</span> <span class="st">&quot;exercises&quot;</span>,</span>
<span id="cb1112-4"><a href="linear-mixed-effects-models-4.html#cb1112-4" tabindex="-1"></a>       <span class="at">within =</span> <span class="fu">c</span>(<span class="st">&quot;diet&quot;</span>, <span class="st">&quot;timepoint&quot;</span>),</span>
<span id="cb1112-5"><a href="linear-mixed-effects-models-4.html#cb1112-5" tabindex="-1"></a>       <span class="at">data =</span> df.weightloss)</span></code></pre></div>
<pre><code>Contrasts set to contr.sum for the following variables: exercises</code></pre>
<div class="sourceCode" id="cb1114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1114-1"><a href="linear-mixed-effects-models-4.html#cb1114-1" tabindex="-1"></a>contrasts <span class="ot">=</span> <span class="fu">list</span>(<span class="at">first_two_vs_last =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="dv">1</span>),</span>
<span id="cb1114-2"><a href="linear-mixed-effects-models-4.html#cb1114-2" tabindex="-1"></a>                 <span class="at">linear_increase =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1114-3"><a href="linear-mixed-effects-models-4.html#cb1114-3" tabindex="-1"></a></span>
<span id="cb1114-4"><a href="linear-mixed-effects-models-4.html#cb1114-4" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb1114-5"><a href="linear-mixed-effects-models-4.html#cb1114-5" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">spec =</span> <span class="st">&quot;timepoint&quot;</span>,</span>
<span id="cb1114-6"><a href="linear-mixed-effects-models-4.html#cb1114-6" tabindex="-1"></a>          <span class="at">contr =</span> contrasts)</span></code></pre></div>
<pre><code>$emmeans
 timepoint emmean    SE df lower.CL upper.CL
 t1          11.2 0.169 22     10.9     11.6
 t2          12.7 0.174 22     12.3     13.0
 t3          14.2 0.182 22     13.8     14.6

Results are averaged over the levels of: exercises, diet 
Confidence level used: 0.95 

$contrasts
 contrast          estimate    SE df t.ratio p.value
 first_two_vs_last     2.24 0.204 22  11.016  &lt;.0001
 linear_increase       2.97 0.191 22  15.524  &lt;.0001

Results are averaged over the levels of: exercises, diet </code></pre>
<p>Because we only had one observation in each cell of our design, the ANOVA was appropriate here (no data points needed to be aggregated).</p>
<p>Both contrasts are significant.</p>
</div>
<div id="politeness-study" class="section level3 hasAnchor" number="20.4.3">
<h3><span class="header-section-number">20.4.3</span> Politeness study<a href="linear-mixed-effects-models-4.html#politeness-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the politeness study, we’ll be interested in one particular contrast:</p>
<ol style="list-style-type: decimal">
<li>Was there an effect of attitude on frequency for female participants?</li>
</ol>
<p>Let’s visualize first:</p>
<div class="sourceCode" id="cb1116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1116-1"><a href="linear-mixed-effects-models-4.html#cb1116-1" tabindex="-1"></a><span class="co"># overview of the data </span></span>
<span id="cb1116-2"><a href="linear-mixed-effects-models-4.html#cb1116-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.politeness,</span>
<span id="cb1116-3"><a href="linear-mixed-effects-models-4.html#cb1116-3" tabindex="-1"></a>        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> attitude,</span>
<span id="cb1116-4"><a href="linear-mixed-effects-models-4.html#cb1116-4" tabindex="-1"></a>                      <span class="at">y =</span> frequency,</span>
<span id="cb1116-5"><a href="linear-mixed-effects-models-4.html#cb1116-5" tabindex="-1"></a>                      <span class="at">group =</span> gender,</span>
<span id="cb1116-6"><a href="linear-mixed-effects-models-4.html#cb1116-6" tabindex="-1"></a>                      <span class="at">color =</span> gender)) <span class="sc">+</span> </span>
<span id="cb1116-7"><a href="linear-mixed-effects-models-4.html#cb1116-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>),</span>
<span id="cb1116-8"><a href="linear-mixed-effects-models-4.html#cb1116-8" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb1116-9"><a href="linear-mixed-effects-models-4.html#cb1116-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1116-10"><a href="linear-mixed-effects-models-4.html#cb1116-10" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range
(`stat_summary()`).</code></pre>
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale
range (`geom_point()`).</code></pre>
<div class="sourceCode" id="cb1119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1119-1"><a href="linear-mixed-effects-models-4.html#cb1119-1" tabindex="-1"></a><span class="co"># variation across scenarios </span></span>
<span id="cb1119-2"><a href="linear-mixed-effects-models-4.html#cb1119-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.politeness,</span>
<span id="cb1119-3"><a href="linear-mixed-effects-models-4.html#cb1119-3" tabindex="-1"></a>        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> scenario,</span>
<span id="cb1119-4"><a href="linear-mixed-effects-models-4.html#cb1119-4" tabindex="-1"></a>                      <span class="at">y =</span> frequency)) <span class="sc">+</span> </span>
<span id="cb1119-5"><a href="linear-mixed-effects-models-4.html#cb1119-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>),</span>
<span id="cb1119-6"><a href="linear-mixed-effects-models-4.html#cb1119-6" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb1119-7"><a href="linear-mixed-effects-models-4.html#cb1119-7" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1119-8"><a href="linear-mixed-effects-models-4.html#cb1119-8" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range (`stat_summary()`).
Removed 1 row containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<div class="sourceCode" id="cb1121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1121-1"><a href="linear-mixed-effects-models-4.html#cb1121-1" tabindex="-1"></a><span class="co"># variation across participants</span></span>
<span id="cb1121-2"><a href="linear-mixed-effects-models-4.html#cb1121-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.politeness,</span>
<span id="cb1121-3"><a href="linear-mixed-effects-models-4.html#cb1121-3" tabindex="-1"></a>        <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> subject,</span>
<span id="cb1121-4"><a href="linear-mixed-effects-models-4.html#cb1121-4" tabindex="-1"></a>                      <span class="at">y =</span> frequency)) <span class="sc">+</span> </span>
<span id="cb1121-5"><a href="linear-mixed-effects-models-4.html#cb1121-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>),</span>
<span id="cb1121-6"><a href="linear-mixed-effects-models-4.html#cb1121-6" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb1121-7"><a href="linear-mixed-effects-models-4.html#cb1121-7" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1121-8"><a href="linear-mixed-effects-models-4.html#cb1121-8" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Removed 1 row containing non-finite outside the scale range (`stat_summary()`).
Removed 1 row containing missing values or values outside the scale range (`geom_point()`).</code></pre>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-11-1.png" width="672" /><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-11-2.png" width="672" /><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-11-3.png" width="672" /></p>
<p>We fit the model and compute the contrasts.</p>
<div class="sourceCode" id="cb1123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1123-1"><a href="linear-mixed-effects-models-4.html#cb1123-1" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> frequency <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> attitude <span class="sc">*</span> gender <span class="sc">+</span> </span>
<span id="cb1123-2"><a href="linear-mixed-effects-models-4.html#cb1123-2" tabindex="-1"></a>             (<span class="dv">1</span> <span class="sc">+</span> attitude <span class="sc">|</span> subject) <span class="sc">+</span> </span>
<span id="cb1123-3"><a href="linear-mixed-effects-models-4.html#cb1123-3" tabindex="-1"></a>             (<span class="dv">1</span> <span class="sc">+</span> attitude <span class="sc">|</span> scenario),</span>
<span id="cb1123-4"><a href="linear-mixed-effects-models-4.html#cb1123-4" tabindex="-1"></a>           <span class="at">data =</span> df.politeness)</span>
<span id="cb1123-5"><a href="linear-mixed-effects-models-4.html#cb1123-5" tabindex="-1"></a></span>
<span id="cb1123-6"><a href="linear-mixed-effects-models-4.html#cb1123-6" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb1123-7"><a href="linear-mixed-effects-models-4.html#cb1123-7" tabindex="-1"></a>  <span class="fu">joint_tests</span>()</span></code></pre></div>
<pre><code> model term      df1  df2 F.ratio p.value
 attitude          1 3.20   9.522  0.0495
 gender            1 4.00  26.600  0.0067
 attitude:gender   1 3.99   1.997  0.2305</code></pre>
<div class="sourceCode" id="cb1125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1125-1"><a href="linear-mixed-effects-models-4.html#cb1125-1" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb1125-2"><a href="linear-mixed-effects-models-4.html#cb1125-2" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> attitude <span class="sc">+</span> gender, </span>
<span id="cb1125-3"><a href="linear-mixed-effects-models-4.html#cb1125-3" tabindex="-1"></a>          <span class="at">adjust =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>$emmeans
 attitude gender emmean   SE   df lower.CL upper.CL
 inf      F         261 16.0 4.97    219.4      302
 pol      F         233 16.8 5.17    190.5      276
 inf      M         144 16.0 4.97    103.2      186
 pol      M         133 16.9 5.23     89.8      175

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 

$contrasts
 contrast      estimate    SE   df t.ratio p.value
 inf F - pol F     27.4  8.35 4.08   3.283  0.0295
 inf F - inf M    116.2 21.33 4.00   5.448  0.0055
 inf F - pol M    128.1 21.99 4.73   5.824  0.0025
 pol F - inf M     88.8 21.95 4.70   4.046  0.0112
 pol F - pol M    100.7 22.12 4.00   4.551  0.0104
 inf M - pol M     11.9  8.46 4.28   1.405  0.2283

Degrees-of-freedom method: kenward-roger </code></pre>
<p>Here, I’ve computed all pairwise contrasts. We were only interested in one: <code>inf F - pol F</code> and that one is significant. So the frequency of female participants’ pitch differed between the informal and polite condition.</p>
<p>If we had used an ANOVA approach for this data set, we could have done it like so:</p>
<div class="sourceCode" id="cb1127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1127-1"><a href="linear-mixed-effects-models-4.html#cb1127-1" tabindex="-1"></a><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">&quot;subject&quot;</span>,</span>
<span id="cb1127-2"><a href="linear-mixed-effects-models-4.html#cb1127-2" tabindex="-1"></a>       <span class="at">dv =</span> <span class="st">&quot;frequency&quot;</span>,</span>
<span id="cb1127-3"><a href="linear-mixed-effects-models-4.html#cb1127-3" tabindex="-1"></a>       <span class="at">between =</span> <span class="st">&quot;gender&quot;</span>,</span>
<span id="cb1127-4"><a href="linear-mixed-effects-models-4.html#cb1127-4" tabindex="-1"></a>       <span class="at">within =</span> <span class="st">&quot;attitude&quot;</span>,</span>
<span id="cb1127-5"><a href="linear-mixed-effects-models-4.html#cb1127-5" tabindex="-1"></a>       <span class="at">data =</span> df.politeness)</span></code></pre></div>
<pre><code>Converting to factor: gender</code></pre>
<pre><code>Warning: More than one observation per design cell, aggregating data using `fun_aggregate = mean`.
To turn off this warning, pass `fun_aggregate = mean` explicitly.</code></pre>
<pre><code>Warning: Missing values for 1 ID(s), which were removed before analysis:
M4
Below the first few rows (in wide format) of the removed cases with missing data.
    subject gender pol   inf
# 5      M4      M  NA 146.3</code></pre>
<pre><code>Contrasts set to contr.sum for the following variables: gender</code></pre>
<pre><code>Anova Table (Type 3 tests)

Response: frequency
           Effect   df     MSE          F  ges p.value
1          gender 1, 3 1729.42    17.22 * .851    .025
2        attitude 1, 3    3.65 309.71 *** .179   &lt;.001
3 gender:attitude 1, 3    3.65    21.30 * .015    .019
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<p>This approach ignores the variation across scenarios (and just computed the mean instead). Arguably, the <code>lmer()</code> approach is better here as it takes all of the data into account.</p>
</div>
</div>
<div id="mixtures-of-participants" class="section level2 hasAnchor" number="20.5">
<h2><span class="header-section-number">20.5</span> Mixtures of participants<a href="linear-mixed-effects-models-4.html#mixtures-of-participants" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What if we have groups of participants who differ from each other? Let’s generate data for which this is the case.</p>
<div class="sourceCode" id="cb1133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1133-1"><a href="linear-mixed-effects-models-4.html#cb1133-1" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb1133-2"><a href="linear-mixed-effects-models-4.html#cb1133-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1133-3"><a href="linear-mixed-effects-models-4.html#cb1133-3" tabindex="-1"></a></span>
<span id="cb1133-4"><a href="linear-mixed-effects-models-4.html#cb1133-4" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb1133-5"><a href="linear-mixed-effects-models-4.html#cb1133-5" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1133-6"><a href="linear-mixed-effects-models-4.html#cb1133-6" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1133-7"><a href="linear-mixed-effects-models-4.html#cb1133-7" tabindex="-1"></a>sd_residual <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb1133-8"><a href="linear-mixed-effects-models-4.html#cb1133-8" tabindex="-1"></a>sd_participant <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb1133-9"><a href="linear-mixed-effects-models-4.html#cb1133-9" tabindex="-1"></a>mean_group1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1133-10"><a href="linear-mixed-effects-models-4.html#cb1133-10" tabindex="-1"></a>mean_group2 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb1133-11"><a href="linear-mixed-effects-models-4.html#cb1133-11" tabindex="-1"></a></span>
<span id="cb1133-12"><a href="linear-mixed-effects-models-4.html#cb1133-12" tabindex="-1"></a>df.mixed <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb1133-13"><a href="linear-mixed-effects-models-4.html#cb1133-13" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> sample_size), </span>
<span id="cb1133-14"><a href="linear-mixed-effects-models-4.html#cb1133-14" tabindex="-1"></a>  <span class="at">participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>sample_size, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1133-15"><a href="linear-mixed-effects-models-4.html#cb1133-15" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span> </span>
<span id="cb1133-16"><a href="linear-mixed-effects-models-4.html#cb1133-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb1133-17"><a href="linear-mixed-effects-models-4.html#cb1133-17" tabindex="-1"></a>         <span class="at">intercept =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb1133-18"><a href="linear-mixed-effects-models-4.html#cb1133-18" tabindex="-1"></a>                            <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> mean_group1, <span class="at">sd =</span> sd_participant),</span>
<span id="cb1133-19"><a href="linear-mixed-effects-models-4.html#cb1133-19" tabindex="-1"></a>                            <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> mean_group2, <span class="at">sd =</span> sd_participant))) <span class="sc">%&gt;%</span> </span>
<span id="cb1133-20"><a href="linear-mixed-effects-models-4.html#cb1133-20" tabindex="-1"></a>  <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb1133-21"><a href="linear-mixed-effects-models-4.html#cb1133-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> condition <span class="sc">+</span> intercept <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">sd =</span> sd_residual)) <span class="sc">%&gt;%</span> </span>
<span id="cb1133-22"><a href="linear-mixed-effects-models-4.html#cb1133-22" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb1133-23"><a href="linear-mixed-effects-models-4.html#cb1133-23" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">as.factor</span>(condition),</span>
<span id="cb1133-24"><a href="linear-mixed-effects-models-4.html#cb1133-24" tabindex="-1"></a>         <span class="at">participant =</span> <span class="fu">as.factor</span>(participant))</span></code></pre></div>
<div id="ignoring-mixture" class="section level4 hasAnchor" number="20.5.0.1">
<h4><span class="header-section-number">20.5.0.1</span> Ignoring mixture<a href="linear-mixed-effects-models-4.html#ignoring-mixture" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’ first fit a model that ignores the fact that there are two different groups of participants.</p>
<div class="sourceCode" id="cb1134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1134-1"><a href="linear-mixed-effects-models-4.html#cb1134-1" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb1134-2"><a href="linear-mixed-effects-models-4.html#cb1134-2" tabindex="-1"></a>fit.mixed <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb1134-3"><a href="linear-mixed-effects-models-4.html#cb1134-3" tabindex="-1"></a>                 <span class="at">data =</span> df.mixed)</span>
<span id="cb1134-4"><a href="linear-mixed-effects-models-4.html#cb1134-4" tabindex="-1"></a></span>
<span id="cb1134-5"><a href="linear-mixed-effects-models-4.html#cb1134-5" tabindex="-1"></a><span class="fu">summary</span>(fit.mixed)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: value ~ 1 + condition + (1 | participant)
   Data: df.mixed

REML criterion at convergence: 163.5

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.62997 -0.41663 -0.05607  0.54750  1.54023 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 19.2206  4.3841  
 Residual                 0.3521  0.5934  
Number of obs: 40, groups:  participant, 20

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)   5.8729     0.9893 19.3449   5.937 9.54e-06 ***
condition1    1.6652     0.1876 19.0000   8.875 3.47e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
           (Intr)
condition1 -0.095</code></pre>
<p>Let’s look at the model’s predictions:</p>
<div class="sourceCode" id="cb1136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1136-1"><a href="linear-mixed-effects-models-4.html#cb1136-1" tabindex="-1"></a>fit.mixed <span class="sc">%&gt;%</span></span>
<span id="cb1136-2"><a href="linear-mixed-effects-models-4.html#cb1136-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1136-3"><a href="linear-mixed-effects-models-4.html#cb1136-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1136-4"><a href="linear-mixed-effects-models-4.html#cb1136-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1136-5"><a href="linear-mixed-effects-models-4.html#cb1136-5" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb1136-6"><a href="linear-mixed-effects-models-4.html#cb1136-6" tabindex="-1"></a>                       <span class="at">y =</span> value,</span>
<span id="cb1136-7"><a href="linear-mixed-effects-models-4.html#cb1136-7" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1136-8"><a href="linear-mixed-effects-models-4.html#cb1136-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1136-9"><a href="linear-mixed-effects-models-4.html#cb1136-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1136-10"><a href="linear-mixed-effects-models-4.html#cb1136-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1136-11"><a href="linear-mixed-effects-models-4.html#cb1136-11" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1136-12"><a href="linear-mixed-effects-models-4.html#cb1136-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1136-13"><a href="linear-mixed-effects-models-4.html#cb1136-13" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>And let’s simulate some data from the fitted model:</p>
<div class="sourceCode" id="cb1137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1137-1"><a href="linear-mixed-effects-models-4.html#cb1137-1" tabindex="-1"></a><span class="co"># simulated data </span></span>
<span id="cb1137-2"><a href="linear-mixed-effects-models-4.html#cb1137-2" tabindex="-1"></a>fit.mixed <span class="sc">%&gt;%</span></span>
<span id="cb1137-3"><a href="linear-mixed-effects-models-4.html#cb1137-3" tabindex="-1"></a>  <span class="fu">simulate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1137-4"><a href="linear-mixed-effects-models-4.html#cb1137-4" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.mixed) <span class="sc">%&gt;%</span></span>
<span id="cb1137-5"><a href="linear-mixed-effects-models-4.html#cb1137-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1137-6"><a href="linear-mixed-effects-models-4.html#cb1137-6" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb1137-7"><a href="linear-mixed-effects-models-4.html#cb1137-7" tabindex="-1"></a>                       <span class="at">y =</span> sim_1,</span>
<span id="cb1137-8"><a href="linear-mixed-effects-models-4.html#cb1137-8" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1137-9"><a href="linear-mixed-effects-models-4.html#cb1137-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1137-10"><a href="linear-mixed-effects-models-4.html#cb1137-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>As we can see, the simulated data doesn’t look like the data that was used to fit the model.</p>
</div>
<div id="modeling-mixture" class="section level4 hasAnchor" number="20.5.0.2">
<h4><span class="header-section-number">20.5.0.2</span> Modeling mixture<a href="linear-mixed-effects-models-4.html#modeling-mixture" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now, let’s fit a model that takes the differences between groups into account by adding a fixed effect for <code>group</code>.</p>
<div class="sourceCode" id="cb1138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1138-1"><a href="linear-mixed-effects-models-4.html#cb1138-1" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb1138-2"><a href="linear-mixed-effects-models-4.html#cb1138-2" tabindex="-1"></a>fit.grouped <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> group <span class="sc">+</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb1138-3"><a href="linear-mixed-effects-models-4.html#cb1138-3" tabindex="-1"></a>                   <span class="at">data =</span> df.mixed)</span>
<span id="cb1138-4"><a href="linear-mixed-effects-models-4.html#cb1138-4" tabindex="-1"></a></span>
<span id="cb1138-5"><a href="linear-mixed-effects-models-4.html#cb1138-5" tabindex="-1"></a><span class="fu">summary</span>(fit.grouped)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: value ~ 1 + group + condition + (1 | participant)
   Data: df.mixed

REML criterion at convergence: 82.2

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.61879 -0.61378  0.02557  0.49842  2.19076 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 0.09265  0.3044  
 Residual                0.35208  0.5934  
Number of obs: 40, groups:  participant, 20

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)  -6.3136     0.3633 20.5655 -17.381 9.10e-14 ***
group         8.7046     0.2366 18.0000  36.791  &lt; 2e-16 ***
condition1    1.6652     0.1876 19.0000   8.875 3.47e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
           (Intr) group 
group      -0.912       
condition1 -0.258  0.000</code></pre>
<p>Note how the variance of the random intercepts is much smaller now that we’ve taken the group structure in the data into account.</p>
<p>Let’s visualize the model’s predictions:</p>
<div class="sourceCode" id="cb1140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1140-1"><a href="linear-mixed-effects-models-4.html#cb1140-1" tabindex="-1"></a>fit.grouped <span class="sc">%&gt;%</span></span>
<span id="cb1140-2"><a href="linear-mixed-effects-models-4.html#cb1140-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1140-3"><a href="linear-mixed-effects-models-4.html#cb1140-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1140-4"><a href="linear-mixed-effects-models-4.html#cb1140-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1140-5"><a href="linear-mixed-effects-models-4.html#cb1140-5" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb1140-6"><a href="linear-mixed-effects-models-4.html#cb1140-6" tabindex="-1"></a>                       <span class="at">y =</span> value,</span>
<span id="cb1140-7"><a href="linear-mixed-effects-models-4.html#cb1140-7" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1140-8"><a href="linear-mixed-effects-models-4.html#cb1140-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1140-9"><a href="linear-mixed-effects-models-4.html#cb1140-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1140-10"><a href="linear-mixed-effects-models-4.html#cb1140-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1140-11"><a href="linear-mixed-effects-models-4.html#cb1140-11" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1140-12"><a href="linear-mixed-effects-models-4.html#cb1140-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1140-13"><a href="linear-mixed-effects-models-4.html#cb1140-13" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>And simulate some data from the model:</p>
<div class="sourceCode" id="cb1141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1141-1"><a href="linear-mixed-effects-models-4.html#cb1141-1" tabindex="-1"></a><span class="co"># simulated data </span></span>
<span id="cb1141-2"><a href="linear-mixed-effects-models-4.html#cb1141-2" tabindex="-1"></a>fit.grouped <span class="sc">%&gt;%</span></span>
<span id="cb1141-3"><a href="linear-mixed-effects-models-4.html#cb1141-3" tabindex="-1"></a>  <span class="fu">simulate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1141-4"><a href="linear-mixed-effects-models-4.html#cb1141-4" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.mixed) <span class="sc">%&gt;%</span></span>
<span id="cb1141-5"><a href="linear-mixed-effects-models-4.html#cb1141-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1141-6"><a href="linear-mixed-effects-models-4.html#cb1141-6" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb1141-7"><a href="linear-mixed-effects-models-4.html#cb1141-7" tabindex="-1"></a>                       <span class="at">y =</span> sim_1,</span>
<span id="cb1141-8"><a href="linear-mixed-effects-models-4.html#cb1141-8" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1141-9"><a href="linear-mixed-effects-models-4.html#cb1141-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1141-10"><a href="linear-mixed-effects-models-4.html#cb1141-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>This time, the simulated data looks much more like the data that was used to fit the model. Yay!</p>
<div class="sourceCode" id="cb1142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1142-1"><a href="linear-mixed-effects-models-4.html#cb1142-1" tabindex="-1"></a><span class="fu">ggpredict</span>(<span class="at">model =</span> fit.grouped,</span>
<span id="cb1142-2"><a href="linear-mixed-effects-models-4.html#cb1142-2" tabindex="-1"></a>          <span class="at">terms =</span> <span class="st">&quot;condition&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1142-3"><a href="linear-mixed-effects-models-4.html#cb1142-3" tabindex="-1"></a>  <span class="fu">plot</span>()</span>
<span id="cb1142-4"><a href="linear-mixed-effects-models-4.html#cb1142-4" tabindex="-1"></a></span>
<span id="cb1142-5"><a href="linear-mixed-effects-models-4.html#cb1142-5" tabindex="-1"></a><span class="fu">ggpredict</span>(<span class="at">model =</span> fit.mixed,</span>
<span id="cb1142-6"><a href="linear-mixed-effects-models-4.html#cb1142-6" tabindex="-1"></a>          <span class="at">terms =</span> <span class="st">&quot;condition&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1142-7"><a href="linear-mixed-effects-models-4.html#cb1142-7" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-21-1.png" width="672" /><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-21-2.png" width="672" /></p>
</div>
<div id="heterogeneity-in-variance" class="section level4 hasAnchor" number="20.5.0.3">
<h4><span class="header-section-number">20.5.0.3</span> Heterogeneity in variance<a href="linear-mixed-effects-models-4.html#heterogeneity-in-variance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The example above has shown that we can take overall differences between groups into account by adding a fixed effect. Can we also deal with heterogeneity in variance between groups? For example, what if the responses of one group exhibit much more variance than the responses of another group?</p>
<p>Let’s first generate some data with heterogeneous variance:</p>
<div class="sourceCode" id="cb1143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1143-1"><a href="linear-mixed-effects-models-4.html#cb1143-1" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb1143-2"><a href="linear-mixed-effects-models-4.html#cb1143-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1143-3"><a href="linear-mixed-effects-models-4.html#cb1143-3" tabindex="-1"></a></span>
<span id="cb1143-4"><a href="linear-mixed-effects-models-4.html#cb1143-4" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb1143-5"><a href="linear-mixed-effects-models-4.html#cb1143-5" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1143-6"><a href="linear-mixed-effects-models-4.html#cb1143-6" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1143-7"><a href="linear-mixed-effects-models-4.html#cb1143-7" tabindex="-1"></a>sd_residual <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb1143-8"><a href="linear-mixed-effects-models-4.html#cb1143-8" tabindex="-1"></a>mean_group1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1143-9"><a href="linear-mixed-effects-models-4.html#cb1143-9" tabindex="-1"></a>sd_group1 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1143-10"><a href="linear-mixed-effects-models-4.html#cb1143-10" tabindex="-1"></a>mean_group2 <span class="ot">=</span> <span class="dv">30</span></span>
<span id="cb1143-11"><a href="linear-mixed-effects-models-4.html#cb1143-11" tabindex="-1"></a>sd_group2 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb1143-12"><a href="linear-mixed-effects-models-4.html#cb1143-12" tabindex="-1"></a></span>
<span id="cb1143-13"><a href="linear-mixed-effects-models-4.html#cb1143-13" tabindex="-1"></a>df.variance <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb1143-14"><a href="linear-mixed-effects-models-4.html#cb1143-14" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">each =</span> sample_size), </span>
<span id="cb1143-15"><a href="linear-mixed-effects-models-4.html#cb1143-15" tabindex="-1"></a>  <span class="at">participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>sample_size, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1143-16"><a href="linear-mixed-effects-models-4.html#cb1143-16" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span> </span>
<span id="cb1143-17"><a href="linear-mixed-effects-models-4.html#cb1143-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb1143-18"><a href="linear-mixed-effects-models-4.html#cb1143-18" tabindex="-1"></a>         <span class="at">intercept =</span> <span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb1143-19"><a href="linear-mixed-effects-models-4.html#cb1143-19" tabindex="-1"></a>                            <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> mean_group1, <span class="at">sd =</span> sd_group1),</span>
<span id="cb1143-20"><a href="linear-mixed-effects-models-4.html#cb1143-20" tabindex="-1"></a>                            <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> mean_group2, <span class="at">sd =</span> sd_group2))) <span class="sc">%&gt;%</span> </span>
<span id="cb1143-21"><a href="linear-mixed-effects-models-4.html#cb1143-21" tabindex="-1"></a>  <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb1143-22"><a href="linear-mixed-effects-models-4.html#cb1143-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> condition <span class="sc">+</span> intercept <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">sd =</span> sd_residual)) <span class="sc">%&gt;%</span> </span>
<span id="cb1143-23"><a href="linear-mixed-effects-models-4.html#cb1143-23" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb1143-24"><a href="linear-mixed-effects-models-4.html#cb1143-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">as.factor</span>(condition),</span>
<span id="cb1143-25"><a href="linear-mixed-effects-models-4.html#cb1143-25" tabindex="-1"></a>         <span class="at">participant =</span> <span class="fu">as.factor</span>(participant))</span></code></pre></div>
<p>Let’s fit the model:</p>
<div class="sourceCode" id="cb1144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1144-1"><a href="linear-mixed-effects-models-4.html#cb1144-1" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb1144-2"><a href="linear-mixed-effects-models-4.html#cb1144-2" tabindex="-1"></a>fit.variance <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> group <span class="sc">+</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb1144-3"><a href="linear-mixed-effects-models-4.html#cb1144-3" tabindex="-1"></a>                    <span class="at">data =</span> df.variance)</span>
<span id="cb1144-4"><a href="linear-mixed-effects-models-4.html#cb1144-4" tabindex="-1"></a></span>
<span id="cb1144-5"><a href="linear-mixed-effects-models-4.html#cb1144-5" tabindex="-1"></a><span class="fu">summary</span>(fit.variance)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: value ~ 1 + group + condition + (1 | participant)
   Data: df.variance

REML criterion at convergence: 232.7

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.96291 -0.19619  0.03751  0.28317  1.45552 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 17.12    4.137   
 Residual                13.74    3.706   
Number of obs: 40, groups:  participant, 20

Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept) -24.0018     3.3669  19.1245  -7.129 8.56e-07 ***
group        27.0696     2.2353  18.0000  12.110 4.36e-10 ***
condition1    0.5716     1.1720  19.0000   0.488    0.631    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
           (Intr) group 
group      -0.929       
condition1 -0.174  0.000</code></pre>
<p>Look at the data and model predictions:</p>
<div class="sourceCode" id="cb1146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1146-1"><a href="linear-mixed-effects-models-4.html#cb1146-1" tabindex="-1"></a>fit.variance <span class="sc">%&gt;%</span></span>
<span id="cb1146-2"><a href="linear-mixed-effects-models-4.html#cb1146-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1146-3"><a href="linear-mixed-effects-models-4.html#cb1146-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1146-4"><a href="linear-mixed-effects-models-4.html#cb1146-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1146-5"><a href="linear-mixed-effects-models-4.html#cb1146-5" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb1146-6"><a href="linear-mixed-effects-models-4.html#cb1146-6" tabindex="-1"></a>                       <span class="at">y =</span> value,</span>
<span id="cb1146-7"><a href="linear-mixed-effects-models-4.html#cb1146-7" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1146-8"><a href="linear-mixed-effects-models-4.html#cb1146-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1146-9"><a href="linear-mixed-effects-models-4.html#cb1146-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1146-10"><a href="linear-mixed-effects-models-4.html#cb1146-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1146-11"><a href="linear-mixed-effects-models-4.html#cb1146-11" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1146-12"><a href="linear-mixed-effects-models-4.html#cb1146-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1146-13"><a href="linear-mixed-effects-models-4.html#cb1146-13" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>And the simulated data:</p>
<div class="sourceCode" id="cb1147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1147-1"><a href="linear-mixed-effects-models-4.html#cb1147-1" tabindex="-1"></a><span class="co"># simulated data </span></span>
<span id="cb1147-2"><a href="linear-mixed-effects-models-4.html#cb1147-2" tabindex="-1"></a>fit.variance <span class="sc">%&gt;%</span></span>
<span id="cb1147-3"><a href="linear-mixed-effects-models-4.html#cb1147-3" tabindex="-1"></a>  <span class="fu">simulate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1147-4"><a href="linear-mixed-effects-models-4.html#cb1147-4" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.mixed) <span class="sc">%&gt;%</span></span>
<span id="cb1147-5"><a href="linear-mixed-effects-models-4.html#cb1147-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1147-6"><a href="linear-mixed-effects-models-4.html#cb1147-6" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb1147-7"><a href="linear-mixed-effects-models-4.html#cb1147-7" tabindex="-1"></a>                       <span class="at">y =</span> sim_1,</span>
<span id="cb1147-8"><a href="linear-mixed-effects-models-4.html#cb1147-8" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1147-9"><a href="linear-mixed-effects-models-4.html#cb1147-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1147-10"><a href="linear-mixed-effects-models-4.html#cb1147-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>The <code>lmer()</code> fails here. It uses one normal distribution to model the variance between participants. It cannot account for the fact that the answers of one group of participants vary more than the answers from another groups of participants. Again, the simulated data doesn’t look like the original data, even though we did take the grouping into account.</p>
<p>We will later see that it’s straightforward in Bayesian models to explicitly model heterogeneity in variance.</p>
</div>
</div>
<div id="simulating-different-random-effects-structures" class="section level2 hasAnchor" number="20.6">
<h2><span class="header-section-number">20.6</span> Simulating different random effects structures<a href="linear-mixed-effects-models-4.html#simulating-different-random-effects-structures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The examples below are taken from <a href="https://rpsychologist.com/r-guide-longitudinal-lme-lmer#power-analysis-and-simulating-these-models">this post</a>.</p>
<div id="two-level-model" class="section level3 hasAnchor" number="20.6.1">
<h3><span class="header-section-number">20.6.1</span> Two-level model<a href="linear-mixed-effects-models-4.html#two-level-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:two-level-model"></span>
<img src="figures/two_level.png" alt="Two-level model" width="95%" />
<p class="caption">
Figure 20.1: Two-level model
</p>
</div>
<div id="conditional-model" class="section level4 hasAnchor" number="20.6.1.1">
<h4><span class="header-section-number">20.6.1.1</span> Conditional model<a href="linear-mixed-effects-models-4.html#conditional-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="cimulate-the-data" class="section level5 hasAnchor" number="20.6.1.1.1">
<h5><span class="header-section-number">20.6.1.1.1</span> Cimulate the data<a href="linear-mixed-effects-models-4.html#cimulate-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1148-1"><a href="linear-mixed-effects-models-4.html#cb1148-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1148-2"><a href="linear-mixed-effects-models-4.html#cb1148-2" tabindex="-1"></a></span>
<span id="cb1148-3"><a href="linear-mixed-effects-models-4.html#cb1148-3" tabindex="-1"></a>n_participants <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb1148-4"><a href="linear-mixed-effects-models-4.html#cb1148-4" tabindex="-1"></a>n_timepoints <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb1148-5"><a href="linear-mixed-effects-models-4.html#cb1148-5" tabindex="-1"></a>n_conditions <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1148-6"><a href="linear-mixed-effects-models-4.html#cb1148-6" tabindex="-1"></a>p_condition <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb1148-7"><a href="linear-mixed-effects-models-4.html#cb1148-7" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb1148-8"><a href="linear-mixed-effects-models-4.html#cb1148-8" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb1148-9"><a href="linear-mixed-effects-models-4.html#cb1148-9" tabindex="-1"></a>sd_participant <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1148-10"><a href="linear-mixed-effects-models-4.html#cb1148-10" tabindex="-1"></a>sd_residual <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1148-11"><a href="linear-mixed-effects-models-4.html#cb1148-11" tabindex="-1"></a></span>
<span id="cb1148-12"><a href="linear-mixed-effects-models-4.html#cb1148-12" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_participants, <span class="at">each =</span> n_timepoints),</span>
<span id="cb1148-13"><a href="linear-mixed-effects-models-4.html#cb1148-13" tabindex="-1"></a>                 <span class="at">timepoint =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_timepoints, <span class="at">times =</span> n_participants),</span>
<span id="cb1148-14"><a href="linear-mixed-effects-models-4.html#cb1148-14" tabindex="-1"></a>                 <span class="at">intercept_participant =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(n_participants, <span class="at">sd =</span> sd_participant), </span>
<span id="cb1148-15"><a href="linear-mixed-effects-models-4.html#cb1148-15" tabindex="-1"></a>                                             <span class="at">each =</span> n_timepoints)) <span class="sc">%&gt;%</span> </span>
<span id="cb1148-16"><a href="linear-mixed-effects-models-4.html#cb1148-16" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span> </span>
<span id="cb1148-17"><a href="linear-mixed-effects-models-4.html#cb1148-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb1148-18"><a href="linear-mixed-effects-models-4.html#cb1148-18" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1148-19"><a href="linear-mixed-effects-models-4.html#cb1148-19" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> condition <span class="sc">+</span> intercept_participant <span class="sc">+</span> </span>
<span id="cb1148-20"><a href="linear-mixed-effects-models-4.html#cb1148-20" tabindex="-1"></a>           <span class="fu">rnorm</span>(n_participants <span class="sc">*</span> n_timepoints, <span class="at">sd =</span> sd_residual))</span></code></pre></div>
</div>
<div id="plot-the-data" class="section level5 hasAnchor" number="20.6.1.1.2">
<h5><span class="header-section-number">20.6.1.1.2</span> Plot the data<a href="linear-mixed-effects-models-4.html#plot-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1149-1"><a href="linear-mixed-effects-models-4.html#cb1149-1" tabindex="-1"></a>df.plot <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb1149-2"><a href="linear-mixed-effects-models-4.html#cb1149-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition,</span>
<span id="cb1149-3"><a href="linear-mixed-effects-models-4.html#cb1149-3" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1149-4"><a href="linear-mixed-effects-models-4.html#cb1149-4" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>)),</span>
<span id="cb1149-5"><a href="linear-mixed-effects-models-4.html#cb1149-5" tabindex="-1"></a>         <span class="at">timepoint =</span> <span class="fu">as.factor</span>(timepoint))</span>
<span id="cb1149-6"><a href="linear-mixed-effects-models-4.html#cb1149-6" tabindex="-1"></a></span>
<span id="cb1149-7"><a href="linear-mixed-effects-models-4.html#cb1149-7" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb1149-8"><a href="linear-mixed-effects-models-4.html#cb1149-8" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> timepoint,</span>
<span id="cb1149-9"><a href="linear-mixed-effects-models-4.html#cb1149-9" tabindex="-1"></a>                     <span class="at">y =</span> value,</span>
<span id="cb1149-10"><a href="linear-mixed-effects-models-4.html#cb1149-10" tabindex="-1"></a>                     <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1149-11"><a href="linear-mixed-effects-models-4.html#cb1149-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1149-12"><a href="linear-mixed-effects-models-4.html#cb1149-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1149-13"><a href="linear-mixed-effects-models-4.html#cb1149-13" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb1149-14"><a href="linear-mixed-effects-models-4.html#cb1149-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;timepoint&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="fit-the-model" class="section level5 hasAnchor" number="20.6.1.1.3">
<h5><span class="header-section-number">20.6.1.1.3</span> Fit the model<a href="linear-mixed-effects-models-4.html#fit-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1150-1"><a href="linear-mixed-effects-models-4.html#cb1150-1" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb1150-2"><a href="linear-mixed-effects-models-4.html#cb1150-2" tabindex="-1"></a>           <span class="at">data =</span> df.data)</span>
<span id="cb1150-3"><a href="linear-mixed-effects-models-4.html#cb1150-3" tabindex="-1"></a></span>
<span id="cb1150-4"><a href="linear-mixed-effects-models-4.html#cb1150-4" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb1150-5"><a href="linear-mixed-effects-models-4.html#cb1150-5" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: value ~ 1 + condition + (1 | participant)
   Data: df.data

REML criterion at convergence: 1102

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.30522 -0.57146  0.03152  0.56826  2.28135 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 3.106    1.762   
 Residual                1.087    1.043   
Number of obs: 300, groups:  participant, 100

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)  10.2199     0.2365 98.0000   43.21   &lt;2e-16 ***
condition    10.0461     0.3837 98.0000   26.18   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
          (Intr)
condition -0.616</code></pre>
</div>
<div id="simulate-and-plot-new-data" class="section level5 hasAnchor" number="20.6.1.1.4">
<h5><span class="header-section-number">20.6.1.1.4</span> Simulate and plot new data<a href="linear-mixed-effects-models-4.html#simulate-and-plot-new-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1152-1"><a href="linear-mixed-effects-models-4.html#cb1152-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1152-2"><a href="linear-mixed-effects-models-4.html#cb1152-2" tabindex="-1"></a></span>
<span id="cb1152-3"><a href="linear-mixed-effects-models-4.html#cb1152-3" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb1152-4"><a href="linear-mixed-effects-models-4.html#cb1152-4" tabindex="-1"></a>  <span class="fu">simulate</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1152-5"><a href="linear-mixed-effects-models-4.html#cb1152-5" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.data) <span class="sc">%&gt;%</span> </span>
<span id="cb1152-6"><a href="linear-mixed-effects-models-4.html#cb1152-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition,</span>
<span id="cb1152-7"><a href="linear-mixed-effects-models-4.html#cb1152-7" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1152-8"><a href="linear-mixed-effects-models-4.html#cb1152-8" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>)),</span>
<span id="cb1152-9"><a href="linear-mixed-effects-models-4.html#cb1152-9" tabindex="-1"></a>         <span class="at">timepoint =</span> <span class="fu">as.factor</span>(timepoint)) <span class="sc">%&gt;%</span> </span>
<span id="cb1152-10"><a href="linear-mixed-effects-models-4.html#cb1152-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1152-11"><a href="linear-mixed-effects-models-4.html#cb1152-11" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> timepoint,</span>
<span id="cb1152-12"><a href="linear-mixed-effects-models-4.html#cb1152-12" tabindex="-1"></a>                       <span class="at">y =</span> sim_1,</span>
<span id="cb1152-13"><a href="linear-mixed-effects-models-4.html#cb1152-13" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1152-14"><a href="linear-mixed-effects-models-4.html#cb1152-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb1152-15"><a href="linear-mixed-effects-models-4.html#cb1152-15" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1152-16"><a href="linear-mixed-effects-models-4.html#cb1152-16" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb1152-17"><a href="linear-mixed-effects-models-4.html#cb1152-17" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1152-18"><a href="linear-mixed-effects-models-4.html#cb1152-18" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb1152-19"><a href="linear-mixed-effects-models-4.html#cb1152-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;timepoint&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
</div>
</div>
<div id="conditional-growth-model" class="section level4 hasAnchor" number="20.6.1.2">
<h4><span class="header-section-number">20.6.1.2</span> Conditional growth model<a href="linear-mixed-effects-models-4.html#conditional-growth-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="simulate-the-data" class="section level5 hasAnchor" number="20.6.1.2.1">
<h5><span class="header-section-number">20.6.1.2.1</span> Simulate the data<a href="linear-mixed-effects-models-4.html#simulate-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1153-1"><a href="linear-mixed-effects-models-4.html#cb1153-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1153-2"><a href="linear-mixed-effects-models-4.html#cb1153-2" tabindex="-1"></a></span>
<span id="cb1153-3"><a href="linear-mixed-effects-models-4.html#cb1153-3" tabindex="-1"></a>n_participants <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb1153-4"><a href="linear-mixed-effects-models-4.html#cb1153-4" tabindex="-1"></a>n_timepoints <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb1153-5"><a href="linear-mixed-effects-models-4.html#cb1153-5" tabindex="-1"></a>n_conditions <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1153-6"><a href="linear-mixed-effects-models-4.html#cb1153-6" tabindex="-1"></a>p_condition <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb1153-7"><a href="linear-mixed-effects-models-4.html#cb1153-7" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">10</span> <span class="co"># intercept </span></span>
<span id="cb1153-8"><a href="linear-mixed-effects-models-4.html#cb1153-8" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">10</span> <span class="co"># condition</span></span>
<span id="cb1153-9"><a href="linear-mixed-effects-models-4.html#cb1153-9" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="dv">2</span> <span class="co"># time </span></span>
<span id="cb1153-10"><a href="linear-mixed-effects-models-4.html#cb1153-10" tabindex="-1"></a>b3 <span class="ot">=</span> <span class="dv">3</span> <span class="co"># interaction</span></span>
<span id="cb1153-11"><a href="linear-mixed-effects-models-4.html#cb1153-11" tabindex="-1"></a>sd_participant <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1153-12"><a href="linear-mixed-effects-models-4.html#cb1153-12" tabindex="-1"></a>sd_time <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1153-13"><a href="linear-mixed-effects-models-4.html#cb1153-13" tabindex="-1"></a>sd_residual <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1153-14"><a href="linear-mixed-effects-models-4.html#cb1153-14" tabindex="-1"></a></span>
<span id="cb1153-15"><a href="linear-mixed-effects-models-4.html#cb1153-15" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_participants, <span class="at">each =</span> n_timepoints),</span>
<span id="cb1153-16"><a href="linear-mixed-effects-models-4.html#cb1153-16" tabindex="-1"></a>                 <span class="at">timepoint =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_timepoints, <span class="at">times =</span> n_participants),</span>
<span id="cb1153-17"><a href="linear-mixed-effects-models-4.html#cb1153-17" tabindex="-1"></a>                 <span class="at">intercept_participant =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(n_participants, <span class="at">sd =</span> sd_participant), </span>
<span id="cb1153-18"><a href="linear-mixed-effects-models-4.html#cb1153-18" tabindex="-1"></a>                                             <span class="at">each =</span> n_timepoints),</span>
<span id="cb1153-19"><a href="linear-mixed-effects-models-4.html#cb1153-19" tabindex="-1"></a>                 <span class="at">time_participant =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(n_participants, <span class="at">sd =</span> sd_time), </span>
<span id="cb1153-20"><a href="linear-mixed-effects-models-4.html#cb1153-20" tabindex="-1"></a>                                             <span class="at">each =</span> n_timepoints)) <span class="sc">%&gt;%</span> </span>
<span id="cb1153-21"><a href="linear-mixed-effects-models-4.html#cb1153-21" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span> </span>
<span id="cb1153-22"><a href="linear-mixed-effects-models-4.html#cb1153-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p_condition)) <span class="sc">%&gt;%</span> </span>
<span id="cb1153-23"><a href="linear-mixed-effects-models-4.html#cb1153-23" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1153-24"><a href="linear-mixed-effects-models-4.html#cb1153-24" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> b0 <span class="sc">+</span> intercept_participant <span class="sc">+</span> </span>
<span id="cb1153-25"><a href="linear-mixed-effects-models-4.html#cb1153-25" tabindex="-1"></a>           b1 <span class="sc">*</span> condition <span class="sc">+</span> </span>
<span id="cb1153-26"><a href="linear-mixed-effects-models-4.html#cb1153-26" tabindex="-1"></a>           (b2  <span class="sc">+</span> time_participant) <span class="sc">*</span> timepoint <span class="sc">+</span>  </span>
<span id="cb1153-27"><a href="linear-mixed-effects-models-4.html#cb1153-27" tabindex="-1"></a>           b3 <span class="sc">*</span> condition <span class="sc">*</span> timepoint <span class="sc">+</span></span>
<span id="cb1153-28"><a href="linear-mixed-effects-models-4.html#cb1153-28" tabindex="-1"></a>           <span class="fu">rnorm</span>(n_participants <span class="sc">*</span> n_timepoints, <span class="at">sd =</span> sd_residual))</span></code></pre></div>
</div>
<div id="plot-the-data-1" class="section level5 hasAnchor" number="20.6.1.2.2">
<h5><span class="header-section-number">20.6.1.2.2</span> Plot the data<a href="linear-mixed-effects-models-4.html#plot-the-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1154-1"><a href="linear-mixed-effects-models-4.html#cb1154-1" tabindex="-1"></a>df.plot <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb1154-2"><a href="linear-mixed-effects-models-4.html#cb1154-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition,</span>
<span id="cb1154-3"><a href="linear-mixed-effects-models-4.html#cb1154-3" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1154-4"><a href="linear-mixed-effects-models-4.html#cb1154-4" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>)),</span>
<span id="cb1154-5"><a href="linear-mixed-effects-models-4.html#cb1154-5" tabindex="-1"></a>         <span class="at">timepoint =</span> <span class="fu">as.factor</span>(timepoint))</span>
<span id="cb1154-6"><a href="linear-mixed-effects-models-4.html#cb1154-6" tabindex="-1"></a></span>
<span id="cb1154-7"><a href="linear-mixed-effects-models-4.html#cb1154-7" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb1154-8"><a href="linear-mixed-effects-models-4.html#cb1154-8" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> timepoint,</span>
<span id="cb1154-9"><a href="linear-mixed-effects-models-4.html#cb1154-9" tabindex="-1"></a>                     <span class="at">y =</span> value,</span>
<span id="cb1154-10"><a href="linear-mixed-effects-models-4.html#cb1154-10" tabindex="-1"></a>                     <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1154-11"><a href="linear-mixed-effects-models-4.html#cb1154-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1154-12"><a href="linear-mixed-effects-models-4.html#cb1154-12" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1154-13"><a href="linear-mixed-effects-models-4.html#cb1154-13" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb1154-14"><a href="linear-mixed-effects-models-4.html#cb1154-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;timepoint&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
<div id="fit-the-model-1" class="section level5 hasAnchor" number="20.6.1.2.3">
<h5><span class="header-section-number">20.6.1.2.3</span> Fit the model<a href="linear-mixed-effects-models-4.html#fit-the-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1155-1"><a href="linear-mixed-effects-models-4.html#cb1155-1" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">*</span> timepoint <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> timepoint <span class="sc">|</span> participant),</span>
<span id="cb1155-2"><a href="linear-mixed-effects-models-4.html#cb1155-2" tabindex="-1"></a>           <span class="at">data =</span> df.data)</span>
<span id="cb1155-3"><a href="linear-mixed-effects-models-4.html#cb1155-3" tabindex="-1"></a></span>
<span id="cb1155-4"><a href="linear-mixed-effects-models-4.html#cb1155-4" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb1155-5"><a href="linear-mixed-effects-models-4.html#cb1155-5" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: value ~ 1 + condition * timepoint + (1 + timepoint | participant)
   Data: df.data

REML criterion at convergence: 1360.3

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.14633 -0.46360  0.03902  0.42302  2.82945 

Random effects:
 Groups      Name        Variance Std.Dev. Corr 
 participant (Intercept) 3.190    1.786         
             timepoint   3.831    1.957    -0.06
 Residual                1.149    1.072         
Number of obs: 300, groups:  participant, 100

Fixed effects:
                    Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)          10.0101     0.3328 98.0000  30.079  &lt; 2e-16 ***
condition            10.0684     0.4854 98.0000  20.741  &lt; 2e-16 ***
timepoint             2.0595     0.2883 97.9999   7.143 1.62e-10 ***
condition:timepoint   2.9090     0.4205 97.9999   6.917 4.76e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) condtn timpnt
condition   -0.686              
timepoint   -0.266  0.182       
cndtn:tmpnt  0.182 -0.266 -0.686</code></pre>
</div>
<div id="data-with-individual-model-predictions" class="section level5 hasAnchor" number="20.6.1.2.4">
<h5><span class="header-section-number">20.6.1.2.4</span> Data with individual model predictions<a href="linear-mixed-effects-models-4.html#data-with-individual-model-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1157-1"><a href="linear-mixed-effects-models-4.html#cb1157-1" tabindex="-1"></a>df.plot <span class="ot">=</span> fit <span class="sc">%&gt;%</span> </span>
<span id="cb1157-2"><a href="linear-mixed-effects-models-4.html#cb1157-2" tabindex="-1"></a>  <span class="fu">augment</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1157-3"><a href="linear-mixed-effects-models-4.html#cb1157-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition,</span>
<span id="cb1157-4"><a href="linear-mixed-effects-models-4.html#cb1157-4" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1157-5"><a href="linear-mixed-effects-models-4.html#cb1157-5" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>)),</span>
<span id="cb1157-6"><a href="linear-mixed-effects-models-4.html#cb1157-6" tabindex="-1"></a>         <span class="at">timepoint =</span> <span class="fu">as.factor</span>(timepoint))</span>
<span id="cb1157-7"><a href="linear-mixed-effects-models-4.html#cb1157-7" tabindex="-1"></a>         </span>
<span id="cb1157-8"><a href="linear-mixed-effects-models-4.html#cb1157-8" tabindex="-1"></a></span>
<span id="cb1157-9"><a href="linear-mixed-effects-models-4.html#cb1157-9" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb1157-10"><a href="linear-mixed-effects-models-4.html#cb1157-10" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> timepoint,</span>
<span id="cb1157-11"><a href="linear-mixed-effects-models-4.html#cb1157-11" tabindex="-1"></a>                     <span class="at">y =</span> value,</span>
<span id="cb1157-12"><a href="linear-mixed-effects-models-4.html#cb1157-12" tabindex="-1"></a>                     <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1157-13"><a href="linear-mixed-effects-models-4.html#cb1157-13" tabindex="-1"></a>  <span class="co"># geom_point(alpha = 0.5) +</span></span>
<span id="cb1157-14"><a href="linear-mixed-effects-models-4.html#cb1157-14" tabindex="-1"></a>  <span class="co"># geom_line(alpha = 0.5) +</span></span>
<span id="cb1157-15"><a href="linear-mixed-effects-models-4.html#cb1157-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> .fitted),</span>
<span id="cb1157-16"><a href="linear-mixed-effects-models-4.html#cb1157-16" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb1157-17"><a href="linear-mixed-effects-models-4.html#cb1157-17" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1157-18"><a href="linear-mixed-effects-models-4.html#cb1157-18" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> .fitted),</span>
<span id="cb1157-19"><a href="linear-mixed-effects-models-4.html#cb1157-19" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb1157-20"><a href="linear-mixed-effects-models-4.html#cb1157-20" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb1157-21"><a href="linear-mixed-effects-models-4.html#cb1157-21" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb1157-22"><a href="linear-mixed-effects-models-4.html#cb1157-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;timepoint&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
</div>
<div id="data-with-overall-model-predictions" class="section level5 hasAnchor" number="20.6.1.2.5">
<h5><span class="header-section-number">20.6.1.2.5</span> Data with overall model predictions<a href="linear-mixed-effects-models-4.html#data-with-overall-model-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1158-1"><a href="linear-mixed-effects-models-4.html#cb1158-1" tabindex="-1"></a>df.model <span class="ot">=</span> <span class="fu">ggpredict</span>(<span class="at">model =</span> fit, </span>
<span id="cb1158-2"><a href="linear-mixed-effects-models-4.html#cb1158-2" tabindex="-1"></a>                     <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;timepoint&quot;</span>, <span class="st">&quot;condition&quot;</span>),</span>
<span id="cb1158-3"><a href="linear-mixed-effects-models-4.html#cb1158-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&quot;fixed&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1158-4"><a href="linear-mixed-effects-models-4.html#cb1158-4" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">timepoint =</span> x,</span>
<span id="cb1158-5"><a href="linear-mixed-effects-models-4.html#cb1158-5" tabindex="-1"></a>         <span class="at">condition =</span> group) <span class="sc">%&gt;%</span> </span>
<span id="cb1158-6"><a href="linear-mixed-effects-models-4.html#cb1158-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition,</span>
<span id="cb1158-7"><a href="linear-mixed-effects-models-4.html#cb1158-7" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1158-8"><a href="linear-mixed-effects-models-4.html#cb1158-8" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>)),</span>
<span id="cb1158-9"><a href="linear-mixed-effects-models-4.html#cb1158-9" tabindex="-1"></a>         <span class="at">timepoint =</span> <span class="fu">as.factor</span>(timepoint))</span>
<span id="cb1158-10"><a href="linear-mixed-effects-models-4.html#cb1158-10" tabindex="-1"></a></span>
<span id="cb1158-11"><a href="linear-mixed-effects-models-4.html#cb1158-11" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb1158-12"><a href="linear-mixed-effects-models-4.html#cb1158-12" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> timepoint,</span>
<span id="cb1158-13"><a href="linear-mixed-effects-models-4.html#cb1158-13" tabindex="-1"></a>                     <span class="at">y =</span> value,</span>
<span id="cb1158-14"><a href="linear-mixed-effects-models-4.html#cb1158-14" tabindex="-1"></a>                     <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1158-15"><a href="linear-mixed-effects-models-4.html#cb1158-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb1158-16"><a href="linear-mixed-effects-models-4.html#cb1158-16" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb1158-17"><a href="linear-mixed-effects-models-4.html#cb1158-17" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> df.model,</span>
<span id="cb1158-18"><a href="linear-mixed-effects-models-4.html#cb1158-18" tabindex="-1"></a>              <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">ymin =</span> conf.low,</span>
<span id="cb1158-19"><a href="linear-mixed-effects-models-4.html#cb1158-19" tabindex="-1"></a>                            <span class="at">ymax =</span> conf.high,</span>
<span id="cb1158-20"><a href="linear-mixed-effects-models-4.html#cb1158-20" tabindex="-1"></a>                            <span class="at">y =</span> predicted,</span>
<span id="cb1158-21"><a href="linear-mixed-effects-models-4.html#cb1158-21" tabindex="-1"></a>                            <span class="at">group =</span> <span class="cn">NA</span>),</span>
<span id="cb1158-22"><a href="linear-mixed-effects-models-4.html#cb1158-22" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb1158-23"><a href="linear-mixed-effects-models-4.html#cb1158-23" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb1158-24"><a href="linear-mixed-effects-models-4.html#cb1158-24" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.model,</span>
<span id="cb1158-25"><a href="linear-mixed-effects-models-4.html#cb1158-25" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> predicted,</span>
<span id="cb1158-26"><a href="linear-mixed-effects-models-4.html#cb1158-26" tabindex="-1"></a>                           <span class="at">group =</span> <span class="cn">NA</span>),</span>
<span id="cb1158-27"><a href="linear-mixed-effects-models-4.html#cb1158-27" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb1158-28"><a href="linear-mixed-effects-models-4.html#cb1158-28" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1158-29"><a href="linear-mixed-effects-models-4.html#cb1158-29" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.model,</span>
<span id="cb1158-30"><a href="linear-mixed-effects-models-4.html#cb1158-30" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> predicted,</span>
<span id="cb1158-31"><a href="linear-mixed-effects-models-4.html#cb1158-31" tabindex="-1"></a>                          <span class="at">group =</span> <span class="cn">NA</span>),</span>
<span id="cb1158-32"><a href="linear-mixed-effects-models-4.html#cb1158-32" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb1158-33"><a href="linear-mixed-effects-models-4.html#cb1158-33" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1158-34"><a href="linear-mixed-effects-models-4.html#cb1158-34" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb1158-35"><a href="linear-mixed-effects-models-4.html#cb1158-35" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;timepoint&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="simulate-and-plot-new-data-1" class="section level5 hasAnchor" number="20.6.1.2.6">
<h5><span class="header-section-number">20.6.1.2.6</span> Simulate and plot new data<a href="linear-mixed-effects-models-4.html#simulate-and-plot-new-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1159-1"><a href="linear-mixed-effects-models-4.html#cb1159-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1159-2"><a href="linear-mixed-effects-models-4.html#cb1159-2" tabindex="-1"></a></span>
<span id="cb1159-3"><a href="linear-mixed-effects-models-4.html#cb1159-3" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb1159-4"><a href="linear-mixed-effects-models-4.html#cb1159-4" tabindex="-1"></a>  <span class="fu">simulate</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1159-5"><a href="linear-mixed-effects-models-4.html#cb1159-5" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.data) <span class="sc">%&gt;%</span> </span>
<span id="cb1159-6"><a href="linear-mixed-effects-models-4.html#cb1159-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition,</span>
<span id="cb1159-7"><a href="linear-mixed-effects-models-4.html#cb1159-7" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1159-8"><a href="linear-mixed-effects-models-4.html#cb1159-8" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>)),</span>
<span id="cb1159-9"><a href="linear-mixed-effects-models-4.html#cb1159-9" tabindex="-1"></a>         <span class="at">timepoint =</span> <span class="fu">as.factor</span>(timepoint)) <span class="sc">%&gt;%</span> </span>
<span id="cb1159-10"><a href="linear-mixed-effects-models-4.html#cb1159-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1159-11"><a href="linear-mixed-effects-models-4.html#cb1159-11" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> timepoint,</span>
<span id="cb1159-12"><a href="linear-mixed-effects-models-4.html#cb1159-12" tabindex="-1"></a>                       <span class="at">y =</span> sim_1,</span>
<span id="cb1159-13"><a href="linear-mixed-effects-models-4.html#cb1159-13" tabindex="-1"></a>                       <span class="at">group =</span> participant)) <span class="sc">+</span></span>
<span id="cb1159-14"><a href="linear-mixed-effects-models-4.html#cb1159-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb1159-15"><a href="linear-mixed-effects-models-4.html#cb1159-15" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1159-16"><a href="linear-mixed-effects-models-4.html#cb1159-16" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb1159-17"><a href="linear-mixed-effects-models-4.html#cb1159-17" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1159-18"><a href="linear-mixed-effects-models-4.html#cb1159-18" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb1159-19"><a href="linear-mixed-effects-models-4.html#cb1159-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;timepoint&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="three-level-model" class="section level3 hasAnchor" number="20.6.2">
<h3><span class="header-section-number">20.6.2</span> Three-level model<a href="linear-mixed-effects-models-4.html#three-level-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure"><span style="display:block;" id="fig:three-level-model"></span>
<img src="figures/three_level.png" alt="Three-level model" width="95%" />
<p class="caption">
Figure 20.2: Three-level model
</p>
</div>
<div id="simulate-the-data-1" class="section level5 hasAnchor" number="20.6.2.0.1">
<h5><span class="header-section-number">20.6.2.0.1</span> Simulate the data<a href="linear-mixed-effects-models-4.html#simulate-the-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1160-1"><a href="linear-mixed-effects-models-4.html#cb1160-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1160-2"><a href="linear-mixed-effects-models-4.html#cb1160-2" tabindex="-1"></a></span>
<span id="cb1160-3"><a href="linear-mixed-effects-models-4.html#cb1160-3" tabindex="-1"></a>n_participants <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb1160-4"><a href="linear-mixed-effects-models-4.html#cb1160-4" tabindex="-1"></a>n_therapists <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb1160-5"><a href="linear-mixed-effects-models-4.html#cb1160-5" tabindex="-1"></a>n_timepoints <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb1160-6"><a href="linear-mixed-effects-models-4.html#cb1160-6" tabindex="-1"></a>n_conditions <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1160-7"><a href="linear-mixed-effects-models-4.html#cb1160-7" tabindex="-1"></a>p_condition <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb1160-8"><a href="linear-mixed-effects-models-4.html#cb1160-8" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">10</span> <span class="co"># intercept </span></span>
<span id="cb1160-9"><a href="linear-mixed-effects-models-4.html#cb1160-9" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">10</span> <span class="co"># condition</span></span>
<span id="cb1160-10"><a href="linear-mixed-effects-models-4.html#cb1160-10" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="dv">2</span> <span class="co"># time </span></span>
<span id="cb1160-11"><a href="linear-mixed-effects-models-4.html#cb1160-11" tabindex="-1"></a>b3 <span class="ot">=</span> <span class="dv">3</span> <span class="co"># interaction</span></span>
<span id="cb1160-12"><a href="linear-mixed-effects-models-4.html#cb1160-12" tabindex="-1"></a>sd_intercept_therapist <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb1160-13"><a href="linear-mixed-effects-models-4.html#cb1160-13" tabindex="-1"></a>sd_intercept_participant <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1160-14"><a href="linear-mixed-effects-models-4.html#cb1160-14" tabindex="-1"></a>sd_time_therapist <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb1160-15"><a href="linear-mixed-effects-models-4.html#cb1160-15" tabindex="-1"></a>sd_time_participant <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1160-16"><a href="linear-mixed-effects-models-4.html#cb1160-16" tabindex="-1"></a>sd_residual <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb1160-17"><a href="linear-mixed-effects-models-4.html#cb1160-17" tabindex="-1"></a></span>
<span id="cb1160-18"><a href="linear-mixed-effects-models-4.html#cb1160-18" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_participants, <span class="at">each =</span> n_timepoints),</span>
<span id="cb1160-19"><a href="linear-mixed-effects-models-4.html#cb1160-19" tabindex="-1"></a>                 <span class="at">timepoint =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_timepoints, <span class="at">times =</span> n_participants),</span>
<span id="cb1160-20"><a href="linear-mixed-effects-models-4.html#cb1160-20" tabindex="-1"></a>                 <span class="at">intercept_participant =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(n_participants,</span>
<span id="cb1160-21"><a href="linear-mixed-effects-models-4.html#cb1160-21" tabindex="-1"></a>                                                   <span class="at">sd =</span> sd_intercept_participant), </span>
<span id="cb1160-22"><a href="linear-mixed-effects-models-4.html#cb1160-22" tabindex="-1"></a>                                             <span class="at">each =</span> n_timepoints),</span>
<span id="cb1160-23"><a href="linear-mixed-effects-models-4.html#cb1160-23" tabindex="-1"></a>                 <span class="at">time_participant =</span> <span class="fu">rep</span>(<span class="fu">rnorm</span>(n_participants, <span class="at">sd =</span> sd_time_participant), </span>
<span id="cb1160-24"><a href="linear-mixed-effects-models-4.html#cb1160-24" tabindex="-1"></a>                                             <span class="at">each =</span> n_timepoints)) <span class="sc">%&gt;%</span> </span>
<span id="cb1160-25"><a href="linear-mixed-effects-models-4.html#cb1160-25" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span> </span>
<span id="cb1160-26"><a href="linear-mixed-effects-models-4.html#cb1160-26" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p_condition),</span>
<span id="cb1160-27"><a href="linear-mixed-effects-models-4.html#cb1160-27" tabindex="-1"></a>         <span class="at">therapist =</span> <span class="fu">ifelse</span>(condition <span class="sc">==</span> <span class="dv">0</span>, <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>(n_therapists<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb1160-28"><a href="linear-mixed-effects-models-4.html#cb1160-28" tabindex="-1"></a>                                                   <span class="at">size =</span> <span class="dv">1</span>),</span>
<span id="cb1160-29"><a href="linear-mixed-effects-models-4.html#cb1160-29" tabindex="-1"></a>                        <span class="fu">sample</span>(<span class="at">x =</span> ((n_therapists<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_therapists,</span>
<span id="cb1160-30"><a href="linear-mixed-effects-models-4.html#cb1160-30" tabindex="-1"></a>                               <span class="at">size =</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1160-31"><a href="linear-mixed-effects-models-4.html#cb1160-31" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1160-32"><a href="linear-mixed-effects-models-4.html#cb1160-32" tabindex="-1"></a>  <span class="fu">group_by</span>(therapist) <span class="sc">%&gt;%</span></span>
<span id="cb1160-33"><a href="linear-mixed-effects-models-4.html#cb1160-33" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">intercept_therapist =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">sd =</span> sd_intercept_therapist),</span>
<span id="cb1160-34"><a href="linear-mixed-effects-models-4.html#cb1160-34" tabindex="-1"></a>         <span class="at">time_therapist =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">sd =</span> sd_time_therapist)) <span class="sc">%&gt;%</span></span>
<span id="cb1160-35"><a href="linear-mixed-effects-models-4.html#cb1160-35" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1160-36"><a href="linear-mixed-effects-models-4.html#cb1160-36" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> b0 <span class="sc">+</span> intercept_therapist <span class="sc">+</span> intercept_participant <span class="sc">+</span> </span>
<span id="cb1160-37"><a href="linear-mixed-effects-models-4.html#cb1160-37" tabindex="-1"></a>           b1 <span class="sc">*</span> condition <span class="sc">+</span> </span>
<span id="cb1160-38"><a href="linear-mixed-effects-models-4.html#cb1160-38" tabindex="-1"></a>           (b2 <span class="sc">+</span> time_therapist <span class="sc">+</span> time_participant) <span class="sc">*</span> timepoint <span class="sc">+</span>  </span>
<span id="cb1160-39"><a href="linear-mixed-effects-models-4.html#cb1160-39" tabindex="-1"></a>           b3 <span class="sc">*</span> condition <span class="sc">*</span> timepoint <span class="sc">+</span></span>
<span id="cb1160-40"><a href="linear-mixed-effects-models-4.html#cb1160-40" tabindex="-1"></a>           <span class="fu">rnorm</span>(n_participants <span class="sc">*</span> n_timepoints, <span class="at">sd =</span> sd_residual))</span></code></pre></div>
</div>
<div id="plot-the-data-2" class="section level5 hasAnchor" number="20.6.2.0.2">
<h5><span class="header-section-number">20.6.2.0.2</span> Plot the data<a href="linear-mixed-effects-models-4.html#plot-the-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1161-1"><a href="linear-mixed-effects-models-4.html#cb1161-1" tabindex="-1"></a>df.plot <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb1161-2"><a href="linear-mixed-effects-models-4.html#cb1161-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">factor</span>(condition,</span>
<span id="cb1161-3"><a href="linear-mixed-effects-models-4.html#cb1161-3" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb1161-4"><a href="linear-mixed-effects-models-4.html#cb1161-4" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>)),</span>
<span id="cb1161-5"><a href="linear-mixed-effects-models-4.html#cb1161-5" tabindex="-1"></a>         <span class="at">timepoint =</span> <span class="fu">as.factor</span>(timepoint),</span>
<span id="cb1161-6"><a href="linear-mixed-effects-models-4.html#cb1161-6" tabindex="-1"></a>         <span class="at">therapist =</span> <span class="fu">as.factor</span>(therapist))</span>
<span id="cb1161-7"><a href="linear-mixed-effects-models-4.html#cb1161-7" tabindex="-1"></a></span>
<span id="cb1161-8"><a href="linear-mixed-effects-models-4.html#cb1161-8" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb1161-9"><a href="linear-mixed-effects-models-4.html#cb1161-9" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> timepoint,</span>
<span id="cb1161-10"><a href="linear-mixed-effects-models-4.html#cb1161-10" tabindex="-1"></a>                     <span class="at">y =</span> value,</span>
<span id="cb1161-11"><a href="linear-mixed-effects-models-4.html#cb1161-11" tabindex="-1"></a>                     <span class="at">group =</span> participant,</span>
<span id="cb1161-12"><a href="linear-mixed-effects-models-4.html#cb1161-12" tabindex="-1"></a>                     <span class="at">color =</span> therapist)) <span class="sc">+</span></span>
<span id="cb1161-13"><a href="linear-mixed-effects-models-4.html#cb1161-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1161-14"><a href="linear-mixed-effects-models-4.html#cb1161-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1161-15"><a href="linear-mixed-effects-models-4.html#cb1161-15" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> condition) <span class="sc">+</span></span>
<span id="cb1161-16"><a href="linear-mixed-effects-models-4.html#cb1161-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;timepoint&quot;</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="fit-the-model-2" class="section level5 hasAnchor" number="20.6.2.0.3">
<h5><span class="header-section-number">20.6.2.0.3</span> Fit the model<a href="linear-mixed-effects-models-4.html#fit-the-model-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1162-1"><a href="linear-mixed-effects-models-4.html#cb1162-1" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> value <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">*</span> timepoint <span class="sc">+</span> </span>
<span id="cb1162-2"><a href="linear-mixed-effects-models-4.html#cb1162-2" tabindex="-1"></a>             (<span class="dv">1</span> <span class="sc">+</span> timepoint <span class="sc">|</span> therapist) <span class="sc">+</span> </span>
<span id="cb1162-3"><a href="linear-mixed-effects-models-4.html#cb1162-3" tabindex="-1"></a>             (<span class="dv">1</span> <span class="sc">+</span> timepoint <span class="sc">|</span> therapist<span class="sc">:</span>participant),</span>
<span id="cb1162-4"><a href="linear-mixed-effects-models-4.html#cb1162-4" tabindex="-1"></a>           <span class="at">data =</span> df.data)</span>
<span id="cb1162-5"><a href="linear-mixed-effects-models-4.html#cb1162-5" tabindex="-1"></a></span>
<span id="cb1162-6"><a href="linear-mixed-effects-models-4.html#cb1162-6" tabindex="-1"></a>fit <span class="sc">%&gt;%</span> </span>
<span id="cb1162-7"><a href="linear-mixed-effects-models-4.html#cb1162-7" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: value ~ 1 + condition * timepoint + (1 + timepoint | therapist) +  
    (1 + timepoint | therapist:participant)
   Data: df.data

REML criterion at convergence: 1237.9

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.02926 -0.51103  0.01576  0.48074  2.12179 

Random effects:
 Groups                Name        Variance Std.Dev. Corr 
 therapist:participant (Intercept) 2.1361   1.4616        
                       timepoint   0.8205   0.9058   0.33 
 therapist             (Intercept) 5.6350   2.3738        
                       timepoint   2.4175   1.5548   -0.21
 Residual                          1.0515   1.0254        
Number of obs: 300, groups:  therapist:participant, 100; therapist, 6

Fixed effects:
                    Estimate Std. Error      df t value Pr(&gt;|t|)   
(Intercept)          10.5078     1.4037  3.9706   7.486  0.00175 **
condition             7.7672     1.9866  3.9825   3.910  0.01754 * 
timepoint             1.5160     0.9126  3.9765   1.661  0.17244   
condition:timepoint   5.0489     1.2913  3.9845   3.910  0.01752 * 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
            (Intr) condtn timpnt
condition   -0.707              
timepoint   -0.208  0.147       
cndtn:tmpnt  0.147 -0.208 -0.707</code></pre>
</div>
</div>
</div>
<div id="bootstrapping" class="section level2 hasAnchor" number="20.7">
<h2><span class="header-section-number">20.7</span> Bootstrapping<a href="linear-mixed-effects-models-4.html#bootstrapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bootstrapping is a good way to estimate our uncertainty on the parameter estimates in the model.</p>
<div id="linear-model" class="section level3 hasAnchor" number="20.7.1">
<h3><span class="header-section-number">20.7.1</span> Linear model<a href="linear-mixed-effects-models-4.html#linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s briefly review how to do bootstrapping in a simple linear model.</p>
<div class="sourceCode" id="cb1164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1164-1"><a href="linear-mixed-effects-models-4.html#cb1164-1" tabindex="-1"></a><span class="co"># fit model </span></span>
<span id="cb1164-2"><a href="linear-mixed-effects-models-4.html#cb1164-2" tabindex="-1"></a>fit.lm <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days,</span>
<span id="cb1164-3"><a href="linear-mixed-effects-models-4.html#cb1164-3" tabindex="-1"></a>            <span class="at">data =</span> df.sleep)</span>
<span id="cb1164-4"><a href="linear-mixed-effects-models-4.html#cb1164-4" tabindex="-1"></a></span>
<span id="cb1164-5"><a href="linear-mixed-effects-models-4.html#cb1164-5" tabindex="-1"></a><span class="co"># coefficients</span></span>
<span id="cb1164-6"><a href="linear-mixed-effects-models-4.html#cb1164-6" tabindex="-1"></a><span class="fu">coef</span>(fit.lm)</span></code></pre></div>
<pre><code>(Intercept)        days 
  252.32070    10.32766 </code></pre>
<div class="sourceCode" id="cb1166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1166-1"><a href="linear-mixed-effects-models-4.html#cb1166-1" tabindex="-1"></a><span class="co"># bootstrapping </span></span>
<span id="cb1166-2"><a href="linear-mixed-effects-models-4.html#cb1166-2" tabindex="-1"></a>df.boot <span class="ot">=</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1166-3"><a href="linear-mixed-effects-models-4.html#cb1166-3" tabindex="-1"></a>  <span class="fu">bootstrap</span>(<span class="at">n =</span> <span class="dv">100</span>,</span>
<span id="cb1166-4"><a href="linear-mixed-effects-models-4.html#cb1166-4" tabindex="-1"></a>            <span class="at">id =</span> <span class="st">&quot;id&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1166-5"><a href="linear-mixed-effects-models-4.html#cb1166-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(<span class="at">.x =</span> strap,</span>
<span id="cb1166-6"><a href="linear-mixed-effects-models-4.html#cb1166-6" tabindex="-1"></a>                   <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">lm</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days,</span>
<span id="cb1166-7"><a href="linear-mixed-effects-models-4.html#cb1166-7" tabindex="-1"></a>                             <span class="at">data =</span> .x)),</span>
<span id="cb1166-8"><a href="linear-mixed-effects-models-4.html#cb1166-8" tabindex="-1"></a>         <span class="at">tidy =</span> <span class="fu">map</span>(<span class="at">.x =</span> fit, </span>
<span id="cb1166-9"><a href="linear-mixed-effects-models-4.html#cb1166-9" tabindex="-1"></a>                    <span class="at">.f =</span> tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb1166-10"><a href="linear-mixed-effects-models-4.html#cb1166-10" tabindex="-1"></a>  <span class="fu">unnest</span>(tidy) <span class="sc">%&gt;%</span> </span>
<span id="cb1166-11"><a href="linear-mixed-effects-models-4.html#cb1166-11" tabindex="-1"></a>  <span class="fu">select</span>(id, term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1166-12"><a href="linear-mixed-effects-models-4.html#cb1166-12" tabindex="-1"></a>  <span class="fu">spread</span>(term, estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1166-13"><a href="linear-mixed-effects-models-4.html#cb1166-13" tabindex="-1"></a>  <span class="fu">clean_names</span>() </span></code></pre></div>
<p>Let’s illustrate the linear model with a confidence interval (making parametric assumptions using the t-distribution).</p>
<div class="sourceCode" id="cb1167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1167-1"><a href="linear-mixed-effects-models-4.html#cb1167-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep,</span>
<span id="cb1167-2"><a href="linear-mixed-effects-models-4.html#cb1167-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1167-3"><a href="linear-mixed-effects-models-4.html#cb1167-3" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1167-4"><a href="linear-mixed-effects-models-4.html#cb1167-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1167-5"><a href="linear-mixed-effects-models-4.html#cb1167-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>And let’s compare this with the different regression lines that we get out of our bootstrapped samples:</p>
<div class="sourceCode" id="cb1168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1168-1"><a href="linear-mixed-effects-models-4.html#cb1168-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep,</span>
<span id="cb1168-2"><a href="linear-mixed-effects-models-4.html#cb1168-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1168-3"><a href="linear-mixed-effects-models-4.html#cb1168-3" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1168-4"><a href="linear-mixed-effects-models-4.html#cb1168-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> df.boot,</span>
<span id="cb1168-5"><a href="linear-mixed-effects-models-4.html#cb1168-5" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept,</span>
<span id="cb1168-6"><a href="linear-mixed-effects-models-4.html#cb1168-6" tabindex="-1"></a>                  <span class="at">slope =</span> days,</span>
<span id="cb1168-7"><a href="linear-mixed-effects-models-4.html#cb1168-7" tabindex="-1"></a>                  <span class="at">group =</span> id),</span>
<span id="cb1168-8"><a href="linear-mixed-effects-models-4.html#cb1168-8" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb1168-9"><a href="linear-mixed-effects-models-4.html#cb1168-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</div>
<div id="linear-mixed-effects-model" class="section level3 hasAnchor" number="20.7.2">
<h3><span class="header-section-number">20.7.2</span> Linear mixed effects model<a href="linear-mixed-effects-models-4.html#linear-mixed-effects-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the linear mixed effects model, we can use the <code>bootmer()</code> function to do bootstrapping.</p>
<div class="sourceCode" id="cb1169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1169-1"><a href="linear-mixed-effects-models-4.html#cb1169-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1169-2"><a href="linear-mixed-effects-models-4.html#cb1169-2" tabindex="-1"></a></span>
<span id="cb1169-3"><a href="linear-mixed-effects-models-4.html#cb1169-3" tabindex="-1"></a><span class="co"># fit the model </span></span>
<span id="cb1169-4"><a href="linear-mixed-effects-models-4.html#cb1169-4" tabindex="-1"></a>fit.lmer <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb1169-5"><a href="linear-mixed-effects-models-4.html#cb1169-5" tabindex="-1"></a>                <span class="at">data =</span> df.sleep)</span>
<span id="cb1169-6"><a href="linear-mixed-effects-models-4.html#cb1169-6" tabindex="-1"></a></span>
<span id="cb1169-7"><a href="linear-mixed-effects-models-4.html#cb1169-7" tabindex="-1"></a><span class="co"># bootstrap parameter estimates </span></span>
<span id="cb1169-8"><a href="linear-mixed-effects-models-4.html#cb1169-8" tabindex="-1"></a>boot.lmer <span class="ot">=</span> <span class="fu">bootMer</span>(fit.lmer,</span>
<span id="cb1169-9"><a href="linear-mixed-effects-models-4.html#cb1169-9" tabindex="-1"></a>                    <span class="at">FUN =</span> fixef,</span>
<span id="cb1169-10"><a href="linear-mixed-effects-models-4.html#cb1169-10" tabindex="-1"></a>                    <span class="at">nsim =</span> <span class="dv">100</span>)</span>
<span id="cb1169-11"><a href="linear-mixed-effects-models-4.html#cb1169-11" tabindex="-1"></a></span>
<span id="cb1169-12"><a href="linear-mixed-effects-models-4.html#cb1169-12" tabindex="-1"></a><span class="co"># compute confidence interval </span></span>
<span id="cb1169-13"><a href="linear-mixed-effects-models-4.html#cb1169-13" tabindex="-1"></a><span class="fu">boot.ci</span>(boot.lmer,</span>
<span id="cb1169-14"><a href="linear-mixed-effects-models-4.html#cb1169-14" tabindex="-1"></a>        <span class="at">index =</span> <span class="dv">2</span>,</span>
<span id="cb1169-15"><a href="linear-mixed-effects-models-4.html#cb1169-15" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span></code></pre></div>
<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 100 bootstrap replicates

CALL : 
boot.ci(boot.out = boot.lmer, type = &quot;perc&quot;, index = 2)

Intervals : 
Level     Percentile     
95%   ( 7.26, 13.79 )  
Calculations and Intervals on Original Scale
Some percentile intervals may be unstable</code></pre>
<p>Let’s plot the distribution of estimates.</p>
<div class="sourceCode" id="cb1171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1171-1"><a href="linear-mixed-effects-models-4.html#cb1171-1" tabindex="-1"></a><span class="co"># plot distribution of estimates </span></span>
<span id="cb1171-2"><a href="linear-mixed-effects-models-4.html#cb1171-2" tabindex="-1"></a>boot.lmer<span class="sc">$</span>t <span class="sc">%&gt;%</span> </span>
<span id="cb1171-3"><a href="linear-mixed-effects-models-4.html#cb1171-3" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1171-4"><a href="linear-mixed-effects-models-4.html#cb1171-4" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1171-5"><a href="linear-mixed-effects-models-4.html#cb1171-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1171-6"><a href="linear-mixed-effects-models-4.html#cb1171-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>id,</span>
<span id="cb1171-7"><a href="linear-mixed-effects-models-4.html#cb1171-7" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;index&quot;</span>,</span>
<span id="cb1171-8"><a href="linear-mixed-effects-models-4.html#cb1171-8" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1171-9"><a href="linear-mixed-effects-models-4.html#cb1171-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1171-10"><a href="linear-mixed-effects-models-4.html#cb1171-10" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span> </span>
<span id="cb1171-11"><a href="linear-mixed-effects-models-4.html#cb1171-11" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> </span>
<span id="cb1171-12"><a href="linear-mixed-effects-models-4.html#cb1171-12" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(index),</span>
<span id="cb1171-13"><a href="linear-mixed-effects-models-4.html#cb1171-13" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb1171-14"><a href="linear-mixed-effects-models-4.html#cb1171-14" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> F)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>And let’s look at the predictions together with the data.</p>
<div class="sourceCode" id="cb1172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1172-1"><a href="linear-mixed-effects-models-4.html#cb1172-1" tabindex="-1"></a>df.boot_lmer <span class="ot">=</span> boot.lmer<span class="sc">$</span>t <span class="sc">%&gt;%</span> </span>
<span id="cb1172-2"><a href="linear-mixed-effects-models-4.html#cb1172-2" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1172-3"><a href="linear-mixed-effects-models-4.html#cb1172-3" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1172-4"><a href="linear-mixed-effects-models-4.html#cb1172-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb1172-5"><a href="linear-mixed-effects-models-4.html#cb1172-5" tabindex="-1"></a></span>
<span id="cb1172-6"><a href="linear-mixed-effects-models-4.html#cb1172-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep,</span>
<span id="cb1172-7"><a href="linear-mixed-effects-models-4.html#cb1172-7" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1172-8"><a href="linear-mixed-effects-models-4.html#cb1172-8" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1172-9"><a href="linear-mixed-effects-models-4.html#cb1172-9" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> df.boot_lmer,</span>
<span id="cb1172-10"><a href="linear-mixed-effects-models-4.html#cb1172-10" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">intercept =</span> intercept,</span>
<span id="cb1172-11"><a href="linear-mixed-effects-models-4.html#cb1172-11" tabindex="-1"></a>                  <span class="at">slope =</span> days,</span>
<span id="cb1172-12"><a href="linear-mixed-effects-models-4.html#cb1172-12" tabindex="-1"></a>                  <span class="at">group =</span> id),</span>
<span id="cb1172-13"><a href="linear-mixed-effects-models-4.html#cb1172-13" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb1172-14"><a href="linear-mixed-effects-models-4.html#cb1172-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="20-linear_mixed_effects_models4_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>As you’ll notice, once we take the dependence in the data into account, the bootstrapped confidence interval is wider than when we ignore the dependence.</p>
</div>
</div>
<div id="session-info-19" class="section level2 hasAnchor" number="20.8">
<h2><span class="header-section-number">20.8</span> Session info<a href="linear-mixed-effects-models-4.html#session-info-19" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb1173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1173-1"><a href="linear-mixed-effects-models-4.html#cb1173-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.4.1 (2024-06-14)
Platform: aarch64-apple-darwin20
Running under: macOS Sonoma 14.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Los_Angeles
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] lubridate_1.9.3     forcats_1.0.0       stringr_1.5.1      
 [4] dplyr_1.1.4         purrr_1.0.2         readr_2.1.5        
 [7] tidyr_1.3.1         tibble_3.2.1        ggplot2_3.5.1      
[10] tidyverse_2.0.0     emmeans_1.10.3      ggeffects_1.7.0    
[13] boot_1.3-30         modelr_0.1.11       datarium_0.1.0     
[16] car_3.1-2           carData_3.0-5       afex_1.3-1         
[19] lme4_1.1-35.5       Matrix_1.7-0        broom.mixed_0.2.9.5
[22] janitor_2.2.0       kableExtra_1.4.0    knitr_1.48         

loaded via a namespace (and not attached):
 [1] gridExtra_2.3       rlang_1.1.4         magrittr_2.0.3     
 [4] snakecase_0.11.1    furrr_0.3.1         compiler_4.4.1     
 [7] mgcv_1.9-1          systemfonts_1.1.0   vctrs_0.6.5        
[10] reshape2_1.4.4      pkgconfig_2.0.3     crayon_1.5.3       
[13] fastmap_1.2.0       backports_1.5.0     labeling_0.4.3     
[16] utf8_1.2.4          rmarkdown_2.27      tzdb_0.4.0         
[19] haven_2.5.4         nloptr_2.1.1        bit_4.0.5          
[22] xfun_0.45           cachem_1.1.0        jsonlite_1.8.8     
[25] highr_0.11          broom_1.0.6         parallel_4.4.1     
[28] cluster_2.1.6       R6_2.5.1            RColorBrewer_1.1-3 
[31] bslib_0.7.0         stringi_1.8.4       parallelly_1.37.1  
[34] rpart_4.1.23        jquerylib_0.1.4     numDeriv_2016.8-1.1
[37] estimability_1.5.1  Rcpp_1.0.13         bookdown_0.40      
[40] base64enc_0.1-3     splines_4.4.1       nnet_7.3-19        
[43] timechange_0.3.0    tidyselect_1.2.1    rstudioapi_0.16.0  
[46] abind_1.4-5         yaml_2.3.9          sjlabelled_1.2.0   
[49] codetools_0.2-20    listenv_0.9.1       lattice_0.22-6     
[52] lmerTest_3.1-3      plyr_1.8.9          withr_3.0.0        
[55] coda_0.19-4.1       evaluate_0.24.0     foreign_0.8-86     
[58] future_1.33.2       xml2_1.3.6          pillar_1.9.0       
[61] checkmate_2.3.1     insight_0.20.3      generics_0.1.3     
[64] vroom_1.6.5         hms_1.1.3           munsell_0.5.1      
[67] scales_1.3.0        minqa_1.2.7         globals_0.16.3     
[70] xtable_1.8-4        glue_1.7.0          Hmisc_5.1-3        
[73] tools_4.4.1         data.table_1.15.4   mvtnorm_1.2-5      
[76] grid_4.4.1          datawizard_0.12.2   colorspace_2.1-0   
[79] nlme_3.1-164        htmlTable_2.4.2     Formula_1.2-5      
[82] cli_3.6.3           fansi_1.0.6         viridisLite_0.4.2  
[85] svglite_2.1.3       gtable_0.3.5        sass_0.4.9         
[88] digest_0.6.36       pbkrtest_0.5.3      farver_2.1.2       
[91] htmlwidgets_1.6.4   htmltools_0.5.8.1   lifecycle_1.0.4    
[94] bit64_4.0.5         MASS_7.3-61        </code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-mixed-effects-models-3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-linear-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/20-linear_mixed_effects_models4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
