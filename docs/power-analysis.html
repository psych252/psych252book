<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 Power analysis | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 Power analysis | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 Power analysis | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2021-03-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-model-4.html"/>
<link rel="next" href="mediation-moderation.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>1.3</b> Installing packages</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#some-basics"><i class="fa fa-check"></i><b>2.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.4.2</b> Getting help</a></li>
<li class="chapter" data-level="2.4.3" data-path="visualization-1.html"><a href="visualization-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>2.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="2.4.4" data-path="visualization-1.html"><a href="visualization-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization"><i class="fa fa-check"></i><b>2.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization-1.html"><a href="visualization-1.html#bar-plot"><i class="fa fa-check"></i><b>2.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.5.4" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5.5" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.5.5</b> Line plot</a></li>
<li class="chapter" data-level="2.5.6" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="2.5.7" data-path="visualization-1.html"><a href="visualization-1.html#order-matters"><i class="fa fa-check"></i><b>2.5.7</b> Order matters</a></li>
<li class="chapter" data-level="2.5.8" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="2.5.9" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.5.9</b> Making facets</a></li>
<li class="chapter" data-level="2.5.10" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.3.1</b> Modes</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.3.2</b> Data types</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.3.3</b> Operators</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.3.4</b> Control flow</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.3.5</b> Functions</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>4.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.6.1</b> csv</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>6.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.2</b> Counting</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.3</b> The random secretary</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.5.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.6</b> Probability operations</a></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.7</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-networks"><i class="fa fa-check"></i><b>6.8</b> Bayesian networks</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#sprinkler-example"><i class="fa fa-check"></i><b>6.8.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.9.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.9.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.9.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.9.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-2"><i class="fa fa-check"></i><b>6.9.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.10</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>7.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>7.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="7.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>7.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="7.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>7.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="7.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>7.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="7.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>7.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#cheatsheets-5"><i class="fa fa-check"></i><b>7.5.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="7.5.2" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>8.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>8.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>8.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-1"><i class="fa fa-check"></i><b>8.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.2.2" data-path="modeling-data.html"><a href="modeling-data.html#error-definitions-and-best-estimators"><i class="fa fa-check"></i><b>9.2.2</b> Error definitions and best estimators</a></li>
<li class="chapter" data-level="9.2.3" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.2.3</b> Sampling distributions for median and mean</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.5.1</b> Reading</a></li>
<li class="chapter" data-level="9.5.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-2"><i class="fa fa-check"></i><b>9.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#session-info-8"><i class="fa fa-check"></i><b>9.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.2</b> Correlation</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.3.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.3.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.4</b> Credit example</a></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-3"><i class="fa fa-check"></i><b>10.5.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-3"><i class="fa fa-check"></i><b>10.5.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-9"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-3"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-4"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-4"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-10"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
<li class="chapter" data-level="11.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>11.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-4"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>12.7</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>12.8</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="12.9" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.9</b> Additional resources</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-5"><i class="fa fa-check"></i><b>12.9.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.9.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-5"><i class="fa fa-check"></i><b>12.9.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.10" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-11"><i class="fa fa-check"></i><b>12.10</b> Session info</a></li>
<li class="chapter" data-level="12.11" data-path="linear-model-3.html"><a href="linear-model-3.html#references-1"><i class="fa fa-check"></i><b>12.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.2</b> Load data sets</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#linear-contrasts"><i class="fa fa-check"></i><b>13.3</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.3.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.3.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.3.2</b> Visualization</a></li>
<li class="chapter" data-level="13.3.3" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.3.3</b> Post-hoc tests</a></li>
<li class="chapter" data-level="13.3.4" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>13.3.4</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="13.3.5" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-effect-coding"><i class="fa fa-check"></i><b>13.3.5</b> Understanding effect coding</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-12"><i class="fa fa-check"></i><b>13.4</b> Session info</a></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#references-2"><i class="fa fa-check"></i><b>13.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-5"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-via-simulation"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis via simulation</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-6"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-6"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-6"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-13"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
<li class="chapter" data-level="14.9" data-path="power-analysis.html"><a href="power-analysis.html#references-3"><i class="fa fa-check"></i><b>14.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="mediation-moderation.html"><a href="mediation-moderation.html"><i class="fa fa-check"></i><b>15</b> Mediation &amp; Moderation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#learning-goals-6"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#recommended-reading"><i class="fa fa-check"></i><b>15.2</b> Recommended reading</a></li>
<li class="chapter" data-level="15.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#controlling-for-variables"><i class="fa fa-check"></i><b>15.4</b> Controlling for variables</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>15.4.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="15.4.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#good-controls"><i class="fa fa-check"></i><b>15.4.2</b> Good controls</a></li>
<li class="chapter" data-level="15.4.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#bad-controls"><i class="fa fa-check"></i><b>15.4.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="mediation-moderation.html"><a href="mediation-moderation.html#mediation"><i class="fa fa-check"></i><b>15.5</b> Mediation</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data"><i class="fa fa-check"></i><b>15.5.1</b> Generate data</a></li>
<li class="chapter" data-level="15.5.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>15.5.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="15.5.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>15.5.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="15.5.4" data-path="mediation-moderation.html"><a href="mediation-moderation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>15.5.4</b> Method 3: Bootstrapping</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation"><i class="fa fa-check"></i><b>15.6</b> Moderation</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#generate-data-1"><i class="fa fa-check"></i><b>15.6.1</b> Generate data</a></li>
<li class="chapter" data-level="15.6.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#moderation-analysis"><i class="fa fa-check"></i><b>15.6.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="mediation-moderation.html"><a href="mediation-moderation.html#additional-resources-12"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="mediation-moderation.html"><a href="mediation-moderation.html#books"><i class="fa fa-check"></i><b>15.7.1</b> Books</a></li>
<li class="chapter" data-level="15.7.2" data-path="mediation-moderation.html"><a href="mediation-moderation.html#tutorials-1"><i class="fa fa-check"></i><b>15.7.2</b> Tutorials</a></li>
<li class="chapter" data-level="15.7.3" data-path="mediation-moderation.html"><a href="mediation-moderation.html#misc-7"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="mediation-moderation.html"><a href="mediation-moderation.html#session-info-14"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
<li class="chapter" data-level="15.9" data-path="mediation-moderation.html"><a href="mediation-moderation.html#references-4"><i class="fa fa-check"></i><b>15.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>16</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-7"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>16.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>16.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="16.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>16.3.2</b> F-test</a></li>
<li class="chapter" data-level="16.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>16.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="16.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>16.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="16.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>16.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>16.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>16.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="16.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>16.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-15"><i class="fa fa-check"></i><b>16.5</b> Session info</a></li>
<li class="chapter" data-level="16.6" data-path="model-comparison.html"><a href="model-comparison.html#references-5"><i class="fa fa-check"></i><b>16.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-8"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-16"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
<li class="chapter" data-level="17.6" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#references-6"><i class="fa fa-check"></i><b>17.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-9"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>18.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>18.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="18.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>18.3.2</b> No pooling</a></li>
<li class="chapter" data-level="18.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>18.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="18.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>18.3.4</b> Compare results</a></li>
<li class="chapter" data-level="18.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>18.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="18.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>18.3.6</b> Reporting results</a></li>
<li class="chapter" data-level="18.3.7" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.3.7</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.3.8" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.3.8</b> Different slopes</a></li>
<li class="chapter" data-level="18.3.9" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.3.9</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-17"><i class="fa fa-check"></i><b>18.5</b> Session info</a></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#references-7"><i class="fa fa-check"></i><b>18.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-10"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-4"><i class="fa fa-check"></i><b>19.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>19.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="19.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>19.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="19.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>19.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="19.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>19.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>19.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>19.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>19.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>19.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>19.6</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-study"><i class="fa fa-check"></i><b>19.6.1</b> Sleep study</a></li>
<li class="chapter" data-level="19.6.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-study"><i class="fa fa-check"></i><b>19.6.2</b> Weight loss study</a></li>
<li class="chapter" data-level="19.6.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politeness-study"><i class="fa fa-check"></i><b>19.6.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixtures-of-participants"><i class="fa fa-check"></i><b>19.7</b> Mixtures of participants</a></li>
<li class="chapter" data-level="19.8" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#bootstrapping"><i class="fa fa-check"></i><b>19.8</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#linear-model"><i class="fa fa-check"></i><b>19.8.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="19.9" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-18"><i class="fa fa-check"></i><b>19.9</b> Session info</a></li>
<li class="chapter" data-level="19.10" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#references-8"><i class="fa fa-check"></i><b>19.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>20</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-11"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>20.3</b> Load data set</a></li>
<li class="chapter" data-level="20.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>20.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>20.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="20.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>20.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="20.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>20.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="20.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>20.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="20.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>20.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>20.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="20.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>20.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="20.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>20.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="20.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>20.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="20.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-7"><i class="fa fa-check"></i><b>20.8.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="20.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-19"><i class="fa fa-check"></i><b>20.9</b> Session info</a></li>
<li class="chapter" data-level="20.10" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#references-9"><i class="fa fa-check"></i><b>20.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html"><i class="fa fa-check"></i><b>21</b> Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="21.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#learning-goals-12"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>21.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>21.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="21.3.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#coin-flip-example"><i class="fa fa-check"></i><b>21.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="21.3.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>21.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>21.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#attitude-data-set"><i class="fa fa-check"></i><b>21.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="21.4.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#frequentist-analysis"><i class="fa fa-check"></i><b>21.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="21.4.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-regression"><i class="fa fa-check"></i><b>21.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#session-info-20"><i class="fa fa-check"></i><b>21.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-13"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-5"><i class="fa fa-check"></i><b>22.3</b> Load data sets</a></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>22.4</b> Poker</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>22.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>22.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>22.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>22.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="22.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>22.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>22.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>22.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>22.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>22.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>22.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="22.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>22.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="22.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>22.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>22.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-that-data"><i class="fa fa-check"></i><b>22.6.1</b> 1. Visualize that data</a></li>
<li class="chapter" data-level="22.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>22.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="22.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>22.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="22.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>22.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="22.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>22.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="22.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>22.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>22.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>22.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="22.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>22.7.2</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="22.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-16"><i class="fa fa-check"></i><b>22.8</b> Additional resources</a></li>
<li class="chapter" data-level="22.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-21"><i class="fa fa-check"></i><b>22.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-14"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>23.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>23.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="23.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>23.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>23.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-3"><i class="fa fa-check"></i><b>23.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>23.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>23.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>23.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>23.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>23.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>23.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>23.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="23.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>23.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="23.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>23.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-17"><i class="fa fa-check"></i><b>23.7</b> Additional resources</a></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-22"><i class="fa fa-check"></i><b>23.8</b> Session info</a></li>
<li class="chapter" data-level="" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#references-10"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>24</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="24.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-15"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>24.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>24.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="24.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>24.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="24.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>24.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="24.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>24.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="24.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>24.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-18"><i class="fa fa-check"></i><b>24.4</b> Additional resources</a></li>
<li class="chapter" data-level="24.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-23"><i class="fa fa-check"></i><b>24.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>25</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="25.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>25.1</b> General advice</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>25.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="25.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>25.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="25.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>25.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="25.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>25.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="25.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>25.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>25.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>25.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-24"><i class="fa fa-check"></i><b>25.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html"><i class="fa fa-check"></i><b>26</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="26.1" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#statistics"><i class="fa fa-check"></i><b>26.1</b> Statistics</a></li>
<li class="chapter" data-level="26.2" data-path="cheatsheets-7.html"><a href="cheatsheets-7.html#r"><i class="fa fa-check"></i><b>26.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-11.html"><a href="references-11.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power-analysis" class="section level1" number="14">
<h1><span class="header-section-number">Chapter 14</span> Power analysis</h1>
<div id="learning-goals-5" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Learning goals</h2>
<ul>
<li>Making decisions based on statistical inference.</li>
<li>The concept of statistical power.</li>
<li>Calculating power.</li>
<li>Common effect size measures.</li>
<li>Determining sample size via simulation.
<ul>
<li>Understanding <code>map()</code> and its children.</li>
<li>Understanding <code>nest()</code> and <code>unnest()</code>.</li>
</ul></li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-7" class="section level2" number="14.2">
<h2><span class="header-section-number">14.2</span> Load packages and set plotting theme</h2>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="power-analysis.html#cb709-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)      <span class="co"># for knitting RMarkdown </span></span>
<span id="cb709-2"><a href="power-analysis.html#cb709-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>) <span class="co"># for making nice tables</span></span>
<span id="cb709-3"><a href="power-analysis.html#cb709-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom&quot;</span>)      <span class="co"># for tidying up model fits</span></span>
<span id="cb709-4"><a href="power-analysis.html#cb709-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;magrittr&quot;</span>)   <span class="co"># for going all in with the pipe</span></span>
<span id="cb709-5"><a href="power-analysis.html#cb709-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;effectsize&quot;</span>) <span class="co"># for computing effect size measures</span></span>
<span id="cb709-6"><a href="power-analysis.html#cb709-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;car&quot;</span>)        <span class="co"># for Anova()</span></span>
<span id="cb709-7"><a href="power-analysis.html#cb709-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pwr&quot;</span>)        <span class="co"># for power calculations</span></span>
<span id="cb709-8"><a href="power-analysis.html#cb709-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)  <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="power-analysis.html#cb710-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb710-2"><a href="power-analysis.html#cb710-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb710-3"><a href="power-analysis.html#cb710-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-4"><a href="power-analysis.html#cb710-4" aria-hidden="true" tabindex="-1"></a><span class="co"># markdown settings for rendered code chunks </span></span>
<span id="cb710-5"><a href="power-analysis.html#cb710-5" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb710-6"><a href="power-analysis.html#cb710-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span>
<span id="cb710-7"><a href="power-analysis.html#cb710-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-8"><a href="power-analysis.html#cb710-8" aria-hidden="true" tabindex="-1"></a><span class="co"># include references for used packages</span></span>
<span id="cb710-9"><a href="power-analysis.html#cb710-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write_bib</span>(<span class="fu">.packages</span>(), <span class="st">&quot;packages.bib&quot;</span>) </span></code></pre></div>
<pre><code>## Warning in utils::citation(..., lib.loc = lib.loc): no date field in DESCRIPTION
## file of package &#39;effectsize&#39;</code></pre>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="power-analysis.html#cb712-1" aria-hidden="true" tabindex="-1"></a><span class="co"># suppress summary warnings </span></span>
<span id="cb712-2"><a href="power-analysis.html#cb712-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> F)</span></code></pre></div>
</div>
<div id="load-data-sets-3" class="section level2" number="14.3">
<h2><span class="header-section-number">14.3</span> Load data sets</h2>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="power-analysis.html#cb713-1" aria-hidden="true" tabindex="-1"></a>df.poker <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/poker.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="decision-making" class="section level2" number="14.4">
<h2><span class="header-section-number">14.4</span> Decision-making</h2>
<p>Figures to illustrate power:</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="power-analysis.html#cb714-1" aria-hidden="true" tabindex="-1"></a>mu0 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb714-2"><a href="power-analysis.html#cb714-2" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">=</span> <span class="dv">18</span></span>
<span id="cb714-3"><a href="power-analysis.html#cb714-3" aria-hidden="true" tabindex="-1"></a><span class="co"># mu0 = 8</span></span>
<span id="cb714-4"><a href="power-analysis.html#cb714-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mu1 = 20</span></span>
<span id="cb714-5"><a href="power-analysis.html#cb714-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sd0 = 3</span></span>
<span id="cb714-6"><a href="power-analysis.html#cb714-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sd1 = 3</span></span>
<span id="cb714-7"><a href="power-analysis.html#cb714-7" aria-hidden="true" tabindex="-1"></a>sd0 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb714-8"><a href="power-analysis.html#cb714-8" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb714-9"><a href="power-analysis.html#cb714-9" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb714-10"><a href="power-analysis.html#cb714-10" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha = 0.01</span></span>
<span id="cb714-11"><a href="power-analysis.html#cb714-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb714-12"><a href="power-analysis.html#cb714-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">30</span>)),</span>
<span id="cb714-13"><a href="power-analysis.html#cb714-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb714-14"><a href="power-analysis.html#cb714-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb714-15"><a href="power-analysis.html#cb714-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb714-16"><a href="power-analysis.html#cb714-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb714-17"><a href="power-analysis.html#cb714-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu0,</span>
<span id="cb714-18"><a href="power-analysis.html#cb714-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> sd0)) <span class="sc">+</span></span>
<span id="cb714-19"><a href="power-analysis.html#cb714-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb714-20"><a href="power-analysis.html#cb714-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb714-21"><a href="power-analysis.html#cb714-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb714-22"><a href="power-analysis.html#cb714-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu1,</span>
<span id="cb714-23"><a href="power-analysis.html#cb714-23" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> sd1)) <span class="sc">+</span></span>
<span id="cb714-24"><a href="power-analysis.html#cb714-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb714-25"><a href="power-analysis.html#cb714-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb714-26"><a href="power-analysis.html#cb714-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb714-27"><a href="power-analysis.html#cb714-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb714-28"><a href="power-analysis.html#cb714-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb714-29"><a href="power-analysis.html#cb714-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu0,</span>
<span id="cb714-30"><a href="power-analysis.html#cb714-30" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> sd0),</span>
<span id="cb714-31"><a href="power-analysis.html#cb714-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sd0), <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb714-32"><a href="power-analysis.html#cb714-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="st">&quot;dnorm&quot;</span>,</span>
<span id="cb714-33"><a href="power-analysis.html#cb714-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">&quot;area&quot;</span>,</span>
<span id="cb714-34"><a href="power-analysis.html#cb714-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb714-35"><a href="power-analysis.html#cb714-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb714-36"><a href="power-analysis.html#cb714-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb714-37"><a href="power-analysis.html#cb714-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mu1,</span>
<span id="cb714-38"><a href="power-analysis.html#cb714-38" aria-hidden="true" tabindex="-1"></a>                            <span class="at">sd =</span> sd1),</span>
<span id="cb714-39"><a href="power-analysis.html#cb714-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">c</span>(<span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sd0)))) <span class="sc">+</span></span>
<span id="cb714-40"><a href="power-analysis.html#cb714-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>alpha, <span class="at">mean =</span> mu0, <span class="at">sd =</span> sd0),</span>
<span id="cb714-41"><a href="power-analysis.html#cb714-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb714-42"><a href="power-analysis.html#cb714-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> F)</span></code></pre></div>
<p><img src="14-power_analysis_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="effect-sizes" class="section level2" number="14.5">
<h2><span class="header-section-number">14.5</span> Effect sizes</h2>
<div id="cohens-d" class="section level3" number="14.5.1">
<h3><span class="header-section-number">14.5.1</span> Cohen’s d</h3>
<p>Cohen’s <span class="math inline">\(d\)</span> is defined as:</p>
<p><span class="math display">\[
d = \frac{\overline y_1 - \overline y_2}{s_p}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
s_p = \sqrt\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}
\]</span></p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb715-1"><a href="power-analysis.html#cb715-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using the effectsize package </span></span>
<span id="cb715-2"><a href="power-analysis.html#cb715-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_d</span>(<span class="at">x =</span> balance <span class="sc">~</span> skill,</span>
<span id="cb715-3"><a href="power-analysis.html#cb715-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df.poker)</span></code></pre></div>
<pre><code>Cohen&#39;s d |        95% CI
-------------------------
0.14      | [-0.08, 0.37]

- Estimated using pooled SD.</code></pre>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="power-analysis.html#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute by hand</span></span>
<span id="cb717-2"><a href="power-analysis.html#cb717-2" aria-hidden="true" tabindex="-1"></a>df.cohen <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb717-3"><a href="power-analysis.html#cb717-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(skill) <span class="sc">%&gt;%</span> </span>
<span id="cb717-4"><a href="power-analysis.html#cb717-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(balance),</span>
<span id="cb717-5"><a href="power-analysis.html#cb717-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">var =</span> <span class="fu">var</span>(balance),</span>
<span id="cb717-6"><a href="power-analysis.html#cb717-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb717-7"><a href="power-analysis.html#cb717-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb717-8"><a href="power-analysis.html#cb717-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> skill,</span>
<span id="cb717-9"><a href="power-analysis.html#cb717-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(mean, var, n),</span>
<span id="cb717-10"><a href="power-analysis.html#cb717-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_sep =</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb717-11"><a href="power-analysis.html#cb717-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sp =</span> <span class="fu">sqrt</span>(((n1 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> var1 <span class="sc">+</span> (n2 <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> var2) <span class="sc">/</span> (n1 <span class="sc">+</span> n2 <span class="sc">-</span> <span class="dv">2</span>)),</span>
<span id="cb717-12"><a href="power-analysis.html#cb717-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">d =</span> <span class="fu">abs</span>(mean1 <span class="sc">-</span> mean2) <span class="sc">/</span> sp)</span>
<span id="cb717-13"><a href="power-analysis.html#cb717-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb717-14"><a href="power-analysis.html#cb717-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df.cohen)</span></code></pre></div>
<pre><code># A tibble: 1 x 8
  mean1 mean2  var1  var2    n1    n2    sp     d
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1  10.1  9.41  20.3  30.3   150   150  5.03 0.144</code></pre>
</div>
</div>
<div id="determining-sample-size" class="section level2" number="14.6">
<h2><span class="header-section-number">14.6</span> Determining sample size</h2>
<p>One way to determine sample size is by using the <code>pwr</code> package. While this packages is very convenient, we cannot compute power for all the hypotheses that we might be interested in testing.</p>
<div id="pwr-package" class="section level3" number="14.6.1">
<h3><span class="header-section-number">14.6.1</span> <code>pwr</code> package</h3>
<p>The <code>pwr</code> package has a number of functions that we can use do determine the desired sample size for different experimental designs. Check out this vignette <a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html">here</a> for more information.</p>
<div id="binomial-test" class="section level4" number="14.6.1.1">
<h4><span class="header-section-number">14.6.1.1</span> Binomial test</h4>
<p>We can determine what sample size we need for a Binomial test that compares two different proportions like so:</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="power-analysis.html#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.p.test</span>(<span class="at">h =</span> <span class="fu">ES.h</span>(<span class="at">p1 =</span> <span class="fl">0.75</span>, <span class="at">p2 =</span> <span class="fl">0.50</span>), </span>
<span id="cb719-2"><a href="power-analysis.html#cb719-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb719-3"><a href="power-analysis.html#cb719-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb719-4"><a href="power-analysis.html#cb719-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>
     proportion power calculation for binomial distribution (arcsine transformation) 

              h = 0.5235988
              n = 22.55126
      sig.level = 0.05
          power = 0.8
    alternative = greater</code></pre>
<p>The <code>pwr.p.test()</code> function wants the effect size h as an argument which we can compute via the <code>ES.h()</code> function that takes two proportions as arguments. I then further defined the desired significance level, power, and whether the test is one-sided or two-sided.</p>
<p>To have an 80% chance of detecting a difference between a proportion of <code>p1 = 0.75</code> and <code>p2 = 0.50</code>, we would need to run a study with 23 participants.</p>
<p>We can use the <code>plot()</code> function to illustrate what power we would get for different sample sizes.</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="power-analysis.html#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.p.test</span>(<span class="at">h =</span> <span class="fu">ES.h</span>(<span class="at">p1 =</span> <span class="fl">0.75</span>, <span class="at">p2 =</span> <span class="fl">0.50</span>), </span>
<span id="cb721-2"><a href="power-analysis.html#cb721-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb721-3"><a href="power-analysis.html#cb721-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb721-4"><a href="power-analysis.html#cb721-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb721-5"><a href="power-analysis.html#cb721-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="14-power_analysis_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Notice that this is a ggplot object, so we could tweak it further if we’d like to, like so:</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="power-analysis.html#cb722-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.p.test</span>(<span class="at">h =</span> <span class="fu">ES.h</span>(<span class="at">p1 =</span> <span class="fl">0.75</span>, <span class="at">p2 =</span> <span class="fl">0.50</span>), </span>
<span id="cb722-2"><a href="power-analysis.html#cb722-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">sig.level =</span> <span class="fl">0.05</span>, </span>
<span id="cb722-3"><a href="power-analysis.html#cb722-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.80</span>, </span>
<span id="cb722-4"><a href="power-analysis.html#cb722-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb722-5"><a href="power-analysis.html#cb722-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>() <span class="sc">+</span> </span>
<span id="cb722-6"><a href="power-analysis.html#cb722-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>,</span>
<span id="cb722-7"><a href="power-analysis.html#cb722-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb722-8"><a href="power-analysis.html#cb722-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb722-9"><a href="power-analysis.html#cb722-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span></code></pre></div>
<p><img src="14-power_analysis_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="t-test-two-independent-samples" class="section level4" number="14.6.1.2">
<h4><span class="header-section-number">14.6.1.2</span> t-test (two independent samples)</h4>
<p>Here is how we could calculate the desired sample size for a t-test with two independent samples.</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="power-analysis.html#cb723-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> <span class="fl">0.3</span>,</span>
<span id="cb723-2"><a href="power-analysis.html#cb723-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.8</span>,</span>
<span id="cb723-3"><a href="power-analysis.html#cb723-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb723-4"><a href="power-analysis.html#cb723-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
     Two-sample t test power calculation 

              n = 175.3847
              d = 0.3
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
<p>So, to achieve a power of 0.8 for an effect size of d = 0.3, we would need to have 176 participants in each condition!</p>
</div>
</div>
<div id="power-analysis-via-simulation" class="section level3" number="14.6.2">
<h3><span class="header-section-number">14.6.2</span> Power analysis via simulation</h3>
<p>While the <code>pwr</code> package works great for relatively simple designs, it quickly reaches its limits. For example, you may be interested in the sample size required to achieve adequate power for detecting an interaction, or for a specific linear contrast.</p>
<p>Luckily, there is a very flexible approach to determining sample size: via simulation!</p>
<div id="the-general-recipe" class="section level4" number="14.6.2.1">
<h4><span class="header-section-number">14.6.2.1</span> The general recipe</h4>
<ul>
<li>assume: significance level, n, effect size</li>
<li>simulate a large number of data sets of size n with the specified effect size</li>
<li>for each data set, run a statistical test to calculate the p-value</li>
<li>determine the probability of rejecting the H0 (given that H1 is true)</li>
</ul>
</div>
<div id="understanding-map" class="section level4" number="14.6.2.2">
<h4><span class="header-section-number">14.6.2.2</span> Understanding <code>map()</code></h4>
<p><code>map()</code> is a powerful family of functions that’s part of the <code>purrr</code> package (which is included in the <code>tidyverse</code>, so we don’t have to load it separately). Using <code>map()</code> allows us to avoid nasty for-loops!</p>
<p>Let’s take a look at the help function.</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="power-analysis.html#cb725-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(map)</span></code></pre></div>
<p>As the help function says, <code>map()</code> allows us to apply a function to each element of a vector. Here is a simple example:</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="power-analysis.html#cb726-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">.f =</span> <span class="sc">~</span> .x<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9</code></pre>
<p>I’ve passed the vector of numbers <code>.x = 1:3</code> to <code>map()</code>, and then applied the anonymous function <code>.f = ~ .x^2</code> to each of the elements in that vector.</p>
<blockquote>
<p>Always make sure to use the <code>~</code> for defining anonymous functions!</p>
</blockquote>
<p>As with many R functions, you can achieve the same outcome in many different ways. Here are a number of ways to do the same thing:</p>
<pre><code>[1] &quot;Is tmp1 identical to tmp2? TRUE&quot;</code></pre>
<pre><code>[1] &quot;Is tmp2 identical to tmp3? TRUE&quot;</code></pre>
<div id="understanding-maps-children" class="section level5" number="14.6.2.2.1">
<h5><span class="header-section-number">14.6.2.2.1</span> Understanding <code>map()</code>’s children</h5>
<p>Notice that the output of <code>map()</code> is a list.</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="power-analysis.html#cb730-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">.f =</span> <span class="sc">~</span> .x<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[[1]]
[1] 1

[[2]]
[1] 4

[[3]]
[1] 9</code></pre>
<p>The <code>map()</code> function has many children that differ in what they output. For example, <code>map_dbl()</code> outputs a numeric vector instead of a list.</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="power-analysis.html#cb732-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dbl</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">.f =</span> <span class="sc">~</span> .x<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>[1] 1 4 9</code></pre>
<p>And <code>map_lgl()</code> returns logical values.</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="power-analysis.html#cb734-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_lgl</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">.f =</span> <span class="sc">~</span> .x <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>[1]  TRUE FALSE FALSE</code></pre>
<p>We can also return data frames by using either <code>map_dfr()</code> which binds data frames by row, or <code>map_dfc()</code> which binds data frames by column. Here is an example:</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="power-analysis.html#cb736-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb736-2"><a href="power-analysis.html#cb736-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb736-3"><a href="power-analysis.html#cb736-3" aria-hidden="true" tabindex="-1"></a><span class="co"># function to create a data frame </span></span>
<span id="cb736-4"><a href="power-analysis.html#cb736-4" aria-hidden="true" tabindex="-1"></a>fun_make_df <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb736-5"><a href="power-analysis.html#cb736-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">number =</span> x,</span>
<span id="cb736-6"><a href="power-analysis.html#cb736-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb736-7"><a href="power-analysis.html#cb736-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb736-8"><a href="power-analysis.html#cb736-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">replace =</span> T),</span>
<span id="cb736-9"><a href="power-analysis.html#cb736-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">value =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">3</span>))</span>
<span id="cb736-10"><a href="power-analysis.html#cb736-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb736-11"><a href="power-analysis.html#cb736-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb736-12"><a href="power-analysis.html#cb736-12" aria-hidden="true" tabindex="-1"></a><span class="co"># bind data frames by row </span></span>
<span id="cb736-13"><a href="power-analysis.html#cb736-13" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="sc">~</span> <span class="fu">fun_make_df</span>(.))</span></code></pre></div>
<pre><code># A tibble: 9 x 3
  number group  value
   &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;
1      1 A      1.33 
2      1 B      1.27 
3      1 A      0.415
4      2 B      0.487
5      2 A      0.738
6      2 A      0.576
7      3 B     -0.799
8      3 A     -1.15 
9      3 A     -0.289</code></pre>
<p>A nice use-case of the <code>map_dfr()</code> function can be to read in a number of csv files from individual participants into one larger data frame. Let’s simulate some data first, and save the data of each participant as a separate csv file (using <code>map()</code> of course).</p>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="power-analysis.html#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb738-2"><a href="power-analysis.html#cb738-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-3"><a href="power-analysis.html#cb738-3" aria-hidden="true" tabindex="-1"></a>fun_simulate_csv <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb738-4"><a href="power-analysis.html#cb738-4" aria-hidden="true" tabindex="-1"></a>  n_observations <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb738-5"><a href="power-analysis.html#cb738-5" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">age =</span> <span class="fu">sample</span>(<span class="dv">18</span><span class="sc">:</span><span class="dv">99</span>, <span class="at">size =</span> n_observations),</span>
<span id="cb738-6"><a href="power-analysis.html#cb738-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">responses =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n_observations, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">10</span>))</span>
<span id="cb738-7"><a href="power-analysis.html#cb738-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(df, <span class="at">file =</span> <span class="fu">str_c</span>(<span class="st">&quot;data/participant&quot;</span>, x, <span class="st">&quot;.csv&quot;</span>))</span>
<span id="cb738-8"><a href="power-analysis.html#cb738-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb738-9"><a href="power-analysis.html#cb738-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb738-10"><a href="power-analysis.html#cb738-10" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, fun_simulate_csv)</span></code></pre></div>
<pre><code>[[1]]
# A tibble: 3 x 2
    age responses
  &lt;int&gt;     &lt;dbl&gt;
1    85      91.6
2    56     116. 
3    18     103. 

[[2]]
# A tibble: 5 x 2
    age responses
  &lt;int&gt;     &lt;dbl&gt;
1    68     115. 
2    38     104. 
3    71      93.8
4    91      77.9
5    24     111. 

[[3]]
# A tibble: 4 x 2
    age responses
  &lt;int&gt;     &lt;dbl&gt;
1    61      106.
2    96      109.
3    50      108.
4    52      101.</code></pre>
<p>Now, let’s read in the data from the three participants and combine it into a single data frame.</p>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="power-analysis.html#cb740-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map_dfr</span>(<span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb740-2"><a href="power-analysis.html#cb740-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">read_csv</span>(<span class="fu">str_c</span>(<span class="st">&quot;data/participant&quot;</span>, .x, <span class="st">&quot;.csv&quot;</span>)),</span>
<span id="cb740-3"><a href="power-analysis.html#cb740-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">.id =</span> <span class="st">&quot;participant&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 12 x 3
   participant   age responses
   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;
 1 1              85      91.6
 2 1              56     116. 
 3 1              18     103. 
 4 2              68     115. 
 5 2              38     104. 
 6 2              71      93.8
 7 2              91      77.9
 8 2              24     111. 
 9 3              61     106. 
10 3              96     109. 
11 3              50     108. 
12 3              52     101. </code></pre>
<p>Notice how I used the <code>.id =</code> argument of the function to add a <code>participant</code> column to my data frame in this case.</p>
</div>
<div id="use-map2-for-functions-with-more-than-one-input" class="section level5" number="14.6.2.2.2">
<h5><span class="header-section-number">14.6.2.2.2</span> Use <code>map2()</code> for functions with more than one input</h5>
<p>If you have a function with more than one input, <code>map2()</code> is your friend. Here is a silly example:</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="power-analysis.html#cb742-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2_dbl</span>(<span class="at">.x =</span> <span class="fu">c</span>(<span class="fl">1.23</span>, <span class="fl">2.13</span>, <span class="fl">5.32</span>),</span>
<span id="cb742-2"><a href="power-analysis.html#cb742-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">.y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb742-3"><a href="power-analysis.html#cb742-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="at">digits =</span> .y))</span></code></pre></div>
<pre><code>[1] 1.00 2.10 5.32</code></pre>
<p>Here, I took the vector of numbers <code>.x</code> and rounded it to a different number of digits according to what I’ve specified it <code>.y</code>.
The same works with data frames, too, like so:</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="power-analysis.html#cb744-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.23</span>, <span class="fl">2.13</span>, <span class="fl">5.32</span>),</span>
<span id="cb744-2"><a href="power-analysis.html#cb744-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb744-3"><a href="power-analysis.html#cb744-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rounded =</span> <span class="fu">map2_dbl</span>(<span class="at">.x =</span> x,</span>
<span id="cb744-4"><a href="power-analysis.html#cb744-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.y =</span> n,</span>
<span id="cb744-5"><a href="power-analysis.html#cb744-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="at">digits =</span> .y)))</span></code></pre></div>
<pre><code># A tibble: 3 x 3
      x     n rounded
  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1  1.23     0    1   
2  2.13     1    2.1 
3  5.32     2    5.32</code></pre>
</div>
<div id="use-pmap-to-go-all-out-i.e.-for-functions-with-more-than-two-arguments" class="section level5" number="14.6.2.2.3">
<h5><span class="header-section-number">14.6.2.2.3</span> Use pmap() to go all out (i.e. for functions with more than two arguments)</h5>
<p><code>pmap()</code> is your friend for functions that have more than two arguments. Here is an example:</p>
<div class="sourceCode" id="cb746"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb746-1"><a href="power-analysis.html#cb746-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb746-2"><a href="power-analysis.html#cb746-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">12</span>, <span class="dv">1</span>),</span>
<span id="cb746-3"><a href="power-analysis.html#cb746-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">4</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb746-4"><a href="power-analysis.html#cb746-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">result =</span> <span class="fu">pmap_dbl</span>(<span class="at">.l =</span> ., <span class="sc">~</span> ..<span class="dv">1</span> <span class="sc">*</span> ..<span class="dv">2</span> <span class="sc">+</span> ..<span class="dv">3</span>))</span></code></pre></div>
<pre><code># A tibble: 3 x 4
      x     y     z result
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1     1    23     4     27
2     2    12     5     29
3     3     1     4      7</code></pre>
<p>Notice than when using more than two arguments, we refer to each function argument with ..1, ..2, ..3, etc.</p>
</div>
<div id="practice-1-having-fun-with-map" class="section level5" number="14.6.2.2.4">
<h5><span class="header-section-number">14.6.2.2.4</span> Practice 1 – Having fun with <code>map()</code></h5>
<p>Use the <code>map2_dbl()</code> function to create a new variable in this data frame that’s the maximum of each row across columns <code>a</code> and <code>b</code>.</p>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="power-analysis.html#cb748-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">52</span>, <span class="dv">23</span>, <span class="dv">23</span>),</span>
<span id="cb748-2"><a href="power-analysis.html#cb748-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">b =</span> <span class="fu">c</span>(<span class="dv">29</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">48</span>, <span class="dv">37</span>))</span>
<span id="cb748-3"><a href="power-analysis.html#cb748-3" aria-hidden="true" tabindex="-1"></a><span class="co"># write your code here </span></span></code></pre></div>
<p>For the fast ones: For each row in the data frame, write a function that calculates the mean of columns <code>a</code> and <code>b</code>, and the rounds to the number of digits specified in column <code>d</code>.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="power-analysis.html#cb749-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="fl">12.123</span>, <span class="fl">53.234</span>, <span class="fl">23.324</span>, <span class="fl">54.232</span>, <span class="fl">12.454</span>),</span>
<span id="cb749-2"><a href="power-analysis.html#cb749-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">b =</span> <span class="fu">c</span>(<span class="fl">12.456</span>, <span class="fl">23.234</span>, <span class="fl">6.736</span>, <span class="fl">3.346</span>, <span class="fl">7.232</span>),</span>
<span id="cb749-3"><a href="power-analysis.html#cb749-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">d =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb749-4"><a href="power-analysis.html#cb749-4" aria-hidden="true" tabindex="-1"></a><span class="co"># write your code here</span></span></code></pre></div>
</div>
</div>
<div id="list-columns" class="section level4" number="14.6.2.3">
<h4><span class="header-section-number">14.6.2.3</span> List columns</h4>
<p><code>map()</code> becomes particularly powerful when combined with list columns. List columns allow you to put data frames into a column of your data frame. For example, you can do something like this:</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="power-analysis.html#cb750-1" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="dv">1</span>, </span>
<span id="cb750-2"><a href="power-analysis.html#cb750-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">age =</span> <span class="dv">23</span>,</span>
<span id="cb750-3"><a href="power-analysis.html#cb750-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">trial =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb750-4"><a href="power-analysis.html#cb750-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">response =</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">95</span>, <span class="dv">37</span>))))</span>
<span id="cb750-5"><a href="power-analysis.html#cb750-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb750-6"><a href="power-analysis.html#cb750-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df.data)</span></code></pre></div>
<pre><code># A tibble: 1 x 3
  participant   age data            
        &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;          
1           1    23 &lt;tibble [3 × 2]&gt;</code></pre>
<p>We could access what’s in this data column like so</p>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="power-analysis.html#cb752-1" aria-hidden="true" tabindex="-1"></a>df.data <span class="sc">%&gt;%</span> </span>
<span id="cb752-2"><a href="power-analysis.html#cb752-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;data&quot;</span>, <span class="dv">1</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  trial response
  &lt;dbl&gt;    &lt;dbl&gt;
1     1       23
2     2       95
3     3       37</code></pre>
<div id="unnest" class="section level5" number="14.6.2.3.1">
<h5><span class="header-section-number">14.6.2.3.1</span> <code>unnest()</code></h5>
<p>For getting data frames out of list columns, we can use the <code>unnest()</code> function.</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="power-analysis.html#cb754-1" aria-hidden="true" tabindex="-1"></a>df.data <span class="sc">%&gt;%</span> </span>
<span id="cb754-2"><a href="power-analysis.html#cb754-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> data)</span></code></pre></div>
<pre><code># A tibble: 3 x 4
  participant   age trial response
        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
1           1    23     1       23
2           1    23     2       95
3           1    23     3       37</code></pre>
</div>
<div id="nest" class="section level5" number="14.6.2.3.2">
<h5><span class="header-section-number">14.6.2.3.2</span> <code>nest()</code></h5>
<p>We can use the <code>nest()</code> function to create list columns. <code>nest()</code> works particularly well in combination with <code>group_by()</code>. For example, here I’m created three separate data sets where the size of each data set is determined by the <code>x</code> column.</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="power-analysis.html#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="co"># original data frame </span></span>
<span id="cb756-2"><a href="power-analysis.html#cb756-2" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb756-3"><a href="power-analysis.html#cb756-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">response1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb756-4"><a href="power-analysis.html#cb756-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">response2 =</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb756-5"><a href="power-analysis.html#cb756-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df.data)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  participant response1 response2
        &lt;dbl&gt;     &lt;int&gt;     &lt;int&gt;
1           1         1         6
2           1         2         5
3           1         3         4
4           2         4         3
5           2         5         2
6           3         6         1</code></pre>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="power-analysis.html#cb758-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nested data frame </span></span>
<span id="cb758-2"><a href="power-analysis.html#cb758-2" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb758-3"><a href="power-analysis.html#cb758-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(participant) <span class="sc">%&gt;%</span> </span>
<span id="cb758-4"><a href="power-analysis.html#cb758-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb758-5"><a href="power-analysis.html#cb758-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb758-6"><a href="power-analysis.html#cb758-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb758-7"><a href="power-analysis.html#cb758-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df.data)</span></code></pre></div>
<pre><code># A tibble: 3 x 2
  participant data            
        &lt;dbl&gt; &lt;list&gt;          
1           1 &lt;tibble [3 × 2]&gt;
2           2 &lt;tibble [2 × 2]&gt;
3           3 &lt;tibble [1 × 2]&gt;</code></pre>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="power-analysis.html#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="co"># and back to the original data frame  </span></span>
<span id="cb760-2"><a href="power-analysis.html#cb760-2" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb760-3"><a href="power-analysis.html#cb760-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> data)</span>
<span id="cb760-4"><a href="power-analysis.html#cb760-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df.data)</span></code></pre></div>
<pre><code># A tibble: 6 x 3
  participant response1 response2
        &lt;dbl&gt;     &lt;int&gt;     &lt;int&gt;
1           1         1         6
2           1         2         5
3           1         3         4
4           2         4         3
5           2         5         2
6           3         6         1</code></pre>
<p>And, of course, I can use unnest() to get back to my original data frame.</p>
</div>
</div>
<div id="combining-nest-and-map" class="section level4" number="14.6.2.4">
<h4><span class="header-section-number">14.6.2.4</span> Combining <code>nest()</code> and <code>map()</code></h4>
<p><code>nest()</code> and <code>map()</code> unfold their power together when it comes to fitting models. For example, consider that you want to fit a separate linear to subests of your data. Here is how you can do that using <code>nest()</code> and <code>map()</code>.</p>
<p>I’ll demonstrate via the infamous <code>mtcars</code> data set that comes with R.</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="power-analysis.html#cb762-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb762-2"><a href="power-analysis.html#cb762-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>                   mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360        14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D         24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230          22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280          19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4</code></pre>
<p>What I want to do is to fit separate regression models predicting <code>mpg</code> (miles per gallon) as a function of <code>wt</code> (the car’s weight) for cars with different numbers of cylinders. Here is how that works.</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="power-analysis.html#cb764-1" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> mtcars <span class="sc">%&gt;%</span></span>
<span id="cb764-2"><a href="power-analysis.html#cb764-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span> </span>
<span id="cb764-3"><a href="power-analysis.html#cb764-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb764-4"><a href="power-analysis.html#cb764-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wt, <span class="at">data =</span> .)))</span></code></pre></div>
<p>I first grouped by the <code>cyl</code> (the number of cylinders), used <code>nest()</code> to put the rest of the data into a list column, and then used <code>mutate()</code> to run a separate linear model on each data set and saved the modle result into the <code>fit</code> column.</p>
<p>With some more wrangling, I could, for example, extract the coefficients of each model like so:</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="power-analysis.html#cb765-1" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span></span>
<span id="cb765-2"><a href="power-analysis.html#cb765-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span> </span>
<span id="cb765-3"><a href="power-analysis.html#cb765-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb765-4"><a href="power-analysis.html#cb765-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, <span class="sc">~</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> wt, <span class="at">data =</span> .)),</span>
<span id="cb765-5"><a href="power-analysis.html#cb765-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">coef =</span> <span class="fu">map</span>(fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb765-6"><a href="power-analysis.html#cb765-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> coef) <span class="sc">%&gt;%</span> </span>
<span id="cb765-7"><a href="power-analysis.html#cb765-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(data, fit))</span></code></pre></div>
<pre><code># A tibble: 6 x 6
# Groups:   cyl [3]
    cyl term        estimate std.error statistic    p.value
  &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
1     6 (Intercept)    28.4      4.18       6.79 0.00105   
2     6 wt             -2.78     1.33      -2.08 0.0918    
3     4 (Intercept)    39.6      4.35       9.10 0.00000777
4     4 wt             -5.65     1.85      -3.05 0.0137    
5     8 (Intercept)    23.9      3.01       7.94 0.00000405
6     8 wt             -2.19     0.739     -2.97 0.0118    </code></pre>
<p>Voila! A data frame that contains the coefficients for each of the three models.</p>
<p>Base R has a number of functions like <code>apply()</code>, <code>sapply()</code>, <code>lapply()</code>, etc. that do similar things to <code>map()</code>. However, the <code>map()</code> family of functions works very well with the rest of the <code>tidyverse</code>, that’s why we’ll use it.</p>
<div id="practice-2-mapping-out-the-nest" class="section level5" number="14.6.2.4.1">
<h5><span class="header-section-number">14.6.2.4.1</span> Practice 2 – <code>map()</code>ping out the <code>nest()</code></h5>
<p>In the <code>mtcars</code> data set, run separate linear models with <code>cyl</code> (number of cylinders) and <code>am</code> (whether the car has automatic or manual transmission) as predictors (including their interaction), and <code>mpg</code> (miles per galon), and <code>hp</code> (horse power) as dependent variables. Create a data frame that contains one column with the names of the dependent variables, one column with the names of the predictors, and one column with the p-value for each predictor.</p>
<p>Here is the general strategy for how to go about this:</p>
<ul>
<li>Make a data frame that only contains the dependent variables.</li>
<li>Pass that data frame as a first argument to the <code>map()</code> function.</li>
<li>The second argument in the <code>map()</code> function (the formula <code>f. =</code>) should be a linear model (<code>lm()</code>) for which you should use <code>.x</code> (the first argument from the <code>map()</code> function) as the dependent variable</li>
<li>Use the <code>Anova()</code> function to get the main effects for each of the predictors as well as the interaction effect.</li>
<li>Use the <code>tidy()</code> function in combination with <code>map_dfr()</code> to extract the p-values</li>
</ul>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="power-analysis.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write your code here </span></span></code></pre></div>
</div>
</div>
<div id="power-analysis-via-simulation-1" class="section level4" number="14.6.2.5">
<h4><span class="header-section-number">14.6.2.5</span> Power analysis via simulation</h4>
<p>So, after this long detour via <code>map()</code>, list columns, <code>nest()</code>, and <code>unnest()</code>, we can finally start doing some power analysis via simulation, yay!</p>
<div id="simulating-the-binomial-test" class="section level5" number="14.6.2.5.1">
<h5><span class="header-section-number">14.6.2.5.1</span> Simulating the Binomial test</h5>
<p>Let’s start with the Binomial test that we played around with above. We want to use simulation to determine the sample size we need to have an 80% of detecting a difference between two proportions p = 0.75 and p = 0.5.</p>
<p>Here is how we would go about this. First, I’ll set up a simulation grid.</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="power-analysis.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of simulations</span></span>
<span id="cb768-2"><a href="power-analysis.html#cb768-2" aria-hidden="true" tabindex="-1"></a>n_simulations <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb768-3"><a href="power-analysis.html#cb768-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb768-4"><a href="power-analysis.html#cb768-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set up simulation grid </span></span>
<span id="cb768-5"><a href="power-analysis.html#cb768-5" aria-hidden="true" tabindex="-1"></a>df.power <span class="ot">=</span> <span class="fu">crossing</span>(<span class="at">n =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">2</span>),</span>
<span id="cb768-6"><a href="power-analysis.html#cb768-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations,</span>
<span id="cb768-7"><a href="power-analysis.html#cb768-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">p =</span> <span class="fl">0.75</span>) <span class="sc">%&gt;%</span></span>
<span id="cb768-8"><a href="power-analysis.html#cb768-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="co"># add an index column</span></span>
<span id="cb768-9"><a href="power-analysis.html#cb768-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb768-10"><a href="power-analysis.html#cb768-10" aria-hidden="true" tabindex="-1"></a>df.power</span></code></pre></div>
<pre><code># A tibble: 160 x 4
       n simulation     p index
   &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
 1    10          1  0.75     1
 2    10          2  0.75     2
 3    10          3  0.75     3
 4    10          4  0.75     4
 5    10          5  0.75     5
 6    10          6  0.75     6
 7    10          7  0.75     7
 8    10          8  0.75     8
 9    10          9  0.75     9
10    10         10  0.75    10
# … with 150 more rows</code></pre>
<p>The <code>crossing()</code> function creates a data frame that contains all the combinations of the variables.</p>
<p>Now, let’s generate data according to our hypothesis.</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="power-analysis.html#cb770-1" aria-hidden="true" tabindex="-1"></a>df.power <span class="ot">=</span> df.power <span class="sc">%&gt;%</span> </span>
<span id="cb770-2"><a href="power-analysis.html#cb770-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(index, n, simulation) <span class="sc">%&gt;%</span> </span>
<span id="cb770-3"><a href="power-analysis.html#cb770-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">response =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">size =</span> n, <span class="at">prob =</span> p))</span>
<span id="cb770-4"><a href="power-analysis.html#cb770-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb770-5"><a href="power-analysis.html#cb770-5" aria-hidden="true" tabindex="-1"></a>df.power</span></code></pre></div>
<pre><code># A tibble: 160 x 5
# Groups:   index, n, simulation [160]
       n simulation     p index response
   &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt; &lt;int&gt;    &lt;int&gt;
 1    10          1  0.75     1        7
 2    10          2  0.75     2        9
 3    10          3  0.75     3        6
 4    10          4  0.75     4        8
 5    10          5  0.75     5        6
 6    10          6  0.75     6        8
 7    10          7  0.75     7        8
 8    10          8  0.75     8        8
 9    10          9  0.75     9        6
10    10         10  0.75    10        6
# … with 150 more rows</code></pre>
<p>The <code>response</code> variable now contains samples from the sample size <code>n</code> according to the probability specified in <code>p</code>. Now it’s time for <code>group_by()</code> and <code>nest()</code> because we want to calculate the p-value for observing this response if in fact the null hypothesis was true (i.e. p = 0.5).</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="power-analysis.html#cb772-1" aria-hidden="true" tabindex="-1"></a>df.power <span class="ot">=</span> df.power <span class="sc">%&gt;%</span> <span class="co"># generate random data</span></span>
<span id="cb772-2"><a href="power-analysis.html#cb772-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(index, simulation, p) <span class="sc">%&gt;%</span> </span>
<span id="cb772-3"><a href="power-analysis.html#cb772-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> <span class="co"># put data in list column</span></span>
<span id="cb772-4"><a href="power-analysis.html#cb772-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, </span>
<span id="cb772-5"><a href="power-analysis.html#cb772-5" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">~</span> <span class="fu">binom.test</span>(<span class="at">x =</span> .<span class="sc">$</span>response, <span class="co"># define formula</span></span>
<span id="cb772-6"><a href="power-analysis.html#cb772-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">n =</span> .<span class="sc">$</span>n,</span>
<span id="cb772-7"><a href="power-analysis.html#cb772-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">p =</span> <span class="fl">0.5</span>,</span>
<span id="cb772-8"><a href="power-analysis.html#cb772-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)))</span>
<span id="cb772-9"><a href="power-analysis.html#cb772-9" aria-hidden="true" tabindex="-1"></a>df.power</span></code></pre></div>
<pre><code># A tibble: 160 x 5
# Groups:   simulation, p, index [160]
   simulation     p index data             fit    
        &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;list&gt;           &lt;list&gt; 
 1          1  0.75     1 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
 2          2  0.75     2 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
 3          3  0.75     3 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
 4          4  0.75     4 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
 5          5  0.75     5 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
 6          6  0.75     6 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
 7          7  0.75     7 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
 8          8  0.75     8 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
 9          9  0.75     9 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
10         10  0.75    10 &lt;tibble [1 × 2]&gt; &lt;htest&gt;
# … with 150 more rows</code></pre>
<p>Now that we’ve fitted a bunch of binomial models, we only need to get at the p-values. Again, we can use the <code>tidy()</code> function from the <code>broom</code> package for help, like so:</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="power-analysis.html#cb774-1" aria-hidden="true" tabindex="-1"></a>df.power <span class="ot">=</span> df.power <span class="sc">%&gt;%</span> </span>
<span id="cb774-2"><a href="power-analysis.html#cb774-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coef =</span> <span class="fu">map</span>(fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb774-3"><a href="power-analysis.html#cb774-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(simulation, p, index, coef) <span class="sc">%&gt;%</span> </span>
<span id="cb774-4"><a href="power-analysis.html#cb774-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> coef) <span class="sc">%&gt;%</span> </span>
<span id="cb774-5"><a href="power-analysis.html#cb774-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">n =</span> parameter)</span>
<span id="cb774-6"><a href="power-analysis.html#cb774-6" aria-hidden="true" tabindex="-1"></a>df.power</span></code></pre></div>
<pre><code># A tibble: 160 x 11
# Groups:   simulation, p, index [160]
   simulation     p index estimate statistic p.value     n conf.low conf.high
        &lt;int&gt; &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
 1          1  0.75     1      0.7         7  0.344     10    0.348     0.933
 2          2  0.75     2      0.9         9  0.0215    10    0.555     0.997
 3          3  0.75     3      0.6         6  0.754     10    0.262     0.878
 4          4  0.75     4      0.8         8  0.109     10    0.444     0.975
 5          5  0.75     5      0.6         6  0.754     10    0.262     0.878
 6          6  0.75     6      0.8         8  0.109     10    0.444     0.975
 7          7  0.75     7      0.8         8  0.109     10    0.444     0.975
 8          8  0.75     8      0.8         8  0.109     10    0.444     0.975
 9          9  0.75     9      0.6         6  0.754     10    0.262     0.878
10         10  0.75    10      0.6         6  0.754     10    0.262     0.878
# … with 150 more rows, and 2 more variables: method &lt;chr&gt;, alternative &lt;chr&gt;</code></pre>
<p>Finally, all that’s left is to calculate power by looking at the proportion of times in which we rejected the null hypothesis.</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="power-analysis.html#cb776-1" aria-hidden="true" tabindex="-1"></a>df.power <span class="sc">%&gt;%</span> </span>
<span id="cb776-2"><a href="power-analysis.html#cb776-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span> </span>
<span id="cb776-3"><a href="power-analysis.html#cb776-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code># A tibble: 16 x 2
       n power
 * &lt;dbl&gt; &lt;dbl&gt;
 1    10   0.1
 2    12   0.3
 3    14   0.5
 4    16   0.4
 5    18   0.5
 6    20   0.7
 7    22   0.4
 8    24   0.7
 9    26   0.8
10    28   0.7
11    30   0.7
12    32   0.5
13    34   0.8
14    36   0.9
15    38   0.8
16    40   0.7</code></pre>
<p>Notice here that the power values fluctuate quite a bit. This is because we only ran 10 simulations for each sample size. To have more robust results, we need to increase the number of simulations.</p>
<p>But first, let’s make a plot that visualizes what we found:</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="power-analysis.html#cb778-1" aria-hidden="true" tabindex="-1"></a>df.plot <span class="ot">=</span> df.power <span class="sc">%&gt;%</span> </span>
<span id="cb778-2"><a href="power-analysis.html#cb778-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span> </span>
<span id="cb778-3"><a href="power-analysis.html#cb778-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="fu">n</span>())</span>
<span id="cb778-4"><a href="power-analysis.html#cb778-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb778-5"><a href="power-analysis.html#cb778-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot, </span>
<span id="cb778-6"><a href="power-analysis.html#cb778-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> n, <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb778-7"><a href="power-analysis.html#cb778-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb778-8"><a href="power-analysis.html#cb778-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb778-9"><a href="power-analysis.html#cb778-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb778-10"><a href="power-analysis.html#cb778-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb778-11"><a href="power-analysis.html#cb778-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="sc">+</span></span>
<span id="cb778-12"><a href="power-analysis.html#cb778-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="14-power_analysis_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>As expected, the power increases with the sample size n. </p>
<p>Now let’s run the same simulation again, with a larger sample size, and also for two different alternative hypotheses: p1 = 0.75, and p2 = 0.9.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="power-analysis.html#cb779-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make reproducible </span></span>
<span id="cb779-2"><a href="power-analysis.html#cb779-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb779-3"><a href="power-analysis.html#cb779-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb779-4"><a href="power-analysis.html#cb779-4" aria-hidden="true" tabindex="-1"></a><span class="co"># number of simulations</span></span>
<span id="cb779-5"><a href="power-analysis.html#cb779-5" aria-hidden="true" tabindex="-1"></a>n_simulations <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb779-6"><a href="power-analysis.html#cb779-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb779-7"><a href="power-analysis.html#cb779-7" aria-hidden="true" tabindex="-1"></a><span class="co"># run simulation </span></span>
<span id="cb779-8"><a href="power-analysis.html#cb779-8" aria-hidden="true" tabindex="-1"></a>df.power <span class="ot">=</span> <span class="fu">crossing</span>(<span class="at">n =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">2</span>),</span>
<span id="cb779-9"><a href="power-analysis.html#cb779-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations,</span>
<span id="cb779-10"><a href="power-analysis.html#cb779-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.9</span>)) <span class="sc">%&gt;%</span> <span class="co"># added another hypothesis here </span></span>
<span id="cb779-11"><a href="power-analysis.html#cb779-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb779-12"><a href="power-analysis.html#cb779-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(index, n, simulation) <span class="sc">%&gt;%</span> </span>
<span id="cb779-13"><a href="power-analysis.html#cb779-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">response =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">size =</span> n, <span class="at">prob =</span> p)) <span class="sc">%&gt;%</span> </span>
<span id="cb779-14"><a href="power-analysis.html#cb779-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(index, simulation, p) <span class="sc">%&gt;%</span> </span>
<span id="cb779-15"><a href="power-analysis.html#cb779-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb779-16"><a href="power-analysis.html#cb779-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(data, </span>
<span id="cb779-17"><a href="power-analysis.html#cb779-17" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">~</span> <span class="fu">binom.test</span>(<span class="at">x =</span> .<span class="sc">$</span>response,</span>
<span id="cb779-18"><a href="power-analysis.html#cb779-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">n =</span> .<span class="sc">$</span>n,</span>
<span id="cb779-19"><a href="power-analysis.html#cb779-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">p =</span> <span class="fl">0.5</span>,</span>
<span id="cb779-20"><a href="power-analysis.html#cb779-20" aria-hidden="true" tabindex="-1"></a>                          <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb779-21"><a href="power-analysis.html#cb779-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coef =</span> <span class="fu">map</span>(fit, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb779-22"><a href="power-analysis.html#cb779-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(simulation, p, index, coef) <span class="sc">%&gt;%</span> </span>
<span id="cb779-23"><a href="power-analysis.html#cb779-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> coef) <span class="sc">%&gt;%</span> </span>
<span id="cb779-24"><a href="power-analysis.html#cb779-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">n =</span> parameter) <span class="sc">%&gt;%</span> </span>
<span id="cb779-25"><a href="power-analysis.html#cb779-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n, p) <span class="sc">%&gt;%</span> </span>
<span id="cb779-26"><a href="power-analysis.html#cb779-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb779-27"><a href="power-analysis.html#cb779-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb779-28"><a href="power-analysis.html#cb779-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb779-29"><a href="power-analysis.html#cb779-29" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize results</span></span>
<span id="cb779-30"><a href="power-analysis.html#cb779-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.power, </span>
<span id="cb779-31"><a href="power-analysis.html#cb779-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> n,</span>
<span id="cb779-32"><a href="power-analysis.html#cb779-32" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> power,</span>
<span id="cb779-33"><a href="power-analysis.html#cb779-33" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="fu">as.factor</span>(p),</span>
<span id="cb779-34"><a href="power-analysis.html#cb779-34" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> p)) <span class="sc">+</span></span>
<span id="cb779-35"><a href="power-analysis.html#cb779-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb779-36"><a href="power-analysis.html#cb779-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb779-37"><a href="power-analysis.html#cb779-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb779-38"><a href="power-analysis.html#cb779-38" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb779-39"><a href="power-analysis.html#cb779-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb779-40"><a href="power-analysis.html#cb779-40" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb779-41"><a href="power-analysis.html#cb779-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb779-42"><a href="power-analysis.html#cb779-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;alternative&quot;</span>) <span class="sc">+</span></span>
<span id="cb779-43"><a href="power-analysis.html#cb779-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> T))</span></code></pre></div>
<p><img src="14-power_analysis_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="simulating-an-independent-samples-t-test" class="section level5" number="14.6.2.5.2">
<h5><span class="header-section-number">14.6.2.5.2</span> Simulating an independent samples t-test</h5>
<p>Let’s simulate data for an independent samples t-test. To do so, we need to make some assumptions about what we expect the distribution of the data to look like. Here, I assume that we get normally distributed data with some mean and standard deviation.</p>
<p>The procedure will be very similar to the Binomial test above. The only thing that changes really is how we generate the data (and then some small wrangling differences).</p>
<p>Let’s say that we collected the following pilotdata set:</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="power-analysis.html#cb780-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb780-2"><a href="power-analysis.html#cb780-2" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb780-3"><a href="power-analysis.html#cb780-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span> </span>
<span id="cb780-4"><a href="power-analysis.html#cb780-4" aria-hidden="true" tabindex="-1"></a>mean1 <span class="ot">=</span> <span class="dv">10</span> </span>
<span id="cb780-5"><a href="power-analysis.html#cb780-5" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb780-6"><a href="power-analysis.html#cb780-6" aria-hidden="true" tabindex="-1"></a>mean2 <span class="ot">=</span> <span class="dv">11</span></span>
<span id="cb780-7"><a href="power-analysis.html#cb780-7" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb780-8"><a href="power-analysis.html#cb780-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb780-9"><a href="power-analysis.html#cb780-9" aria-hidden="true" tabindex="-1"></a>df.ttest <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">group1 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n,</span>
<span id="cb780-10"><a href="power-analysis.html#cb780-10" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">mean =</span> mean1,</span>
<span id="cb780-11"><a href="power-analysis.html#cb780-11" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sd =</span> sd1),</span>
<span id="cb780-12"><a href="power-analysis.html#cb780-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">group2 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n,</span>
<span id="cb780-13"><a href="power-analysis.html#cb780-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">mean =</span> mean2,</span>
<span id="cb780-14"><a href="power-analysis.html#cb780-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sd =</span> sd2)) <span class="sc">%&gt;%</span> </span>
<span id="cb780-15"><a href="power-analysis.html#cb780-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>())</span></code></pre></div>
<p>The two groups in our sample don’t differ significantly from each other.</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="power-analysis.html#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.ttest,</span>
<span id="cb781-2"><a href="power-analysis.html#cb781-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> name,</span>
<span id="cb781-3"><a href="power-analysis.html#cb781-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> value)) <span class="sc">+</span> </span>
<span id="cb781-4"><a href="power-analysis.html#cb781-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>)</span>
<span id="cb781-5"><a href="power-analysis.html#cb781-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb781-6"><a href="power-analysis.html#cb781-6" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">formula =</span> value <span class="sc">~</span> name, </span>
<span id="cb781-7"><a href="power-analysis.html#cb781-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df.ttest)</span></code></pre></div>
<pre><code>
    Welch Two Sample t-test

data:  value by name
t = -1.3135, df = 13.035, p-value = 0.2117
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -3.9191375  0.9548788
sample estimates:
mean in group group1 mean in group group2 
            10.26441             11.74653 </code></pre>
<p><img src="14-power_analysis_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>Let’s calculate what the effect size was in our sample. Remember that Cohen’s d is defined as</p>
<p><span class="math display">\[d = \frac{\lvert\overline y_1 - \overline y_2\rvert}{s_p}\]</span></p>
<p>where</p>
<p><span class="math display">\[s_p = \sqrt\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}\]</span></p>
<p>In our sample, the effect size Cohen’s d was:</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="power-analysis.html#cb783-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> df.ttest <span class="sc">%&gt;%</span> </span>
<span id="cb783-2"><a href="power-analysis.html#cb783-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb783-3"><a href="power-analysis.html#cb783-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb783-4"><a href="power-analysis.html#cb783-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(value),</span>
<span id="cb783-5"><a href="power-analysis.html#cb783-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb783-6"><a href="power-analysis.html#cb783-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb783-7"><a href="power-analysis.html#cb783-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb783-8"><a href="power-analysis.html#cb783-8" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">=</span> <span class="fu">sqrt</span>(((df<span class="sc">$</span>n[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> df<span class="sc">$</span>sd[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (df<span class="sc">$</span>n[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> df<span class="sc">$</span>sd[<span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (df<span class="sc">$</span>n[<span class="dv">1</span>] <span class="sc">+</span> df<span class="sc">$</span>n[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb783-9"><a href="power-analysis.html#cb783-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb783-10"><a href="power-analysis.html#cb783-10" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">abs</span>(df<span class="sc">$</span>mean[<span class="dv">1</span>] <span class="sc">-</span> df<span class="sc">$</span>mean[<span class="dv">2</span>]) <span class="sc">/</span> sp</span>
<span id="cb783-11"><a href="power-analysis.html#cb783-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb783-12"><a href="power-analysis.html#cb783-12" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>[1] 0.5874251</code></pre>
<p>Let’s double check that we got it right:</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="power-analysis.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_d</span>(<span class="at">x =</span> value <span class="sc">~</span> name, </span>
<span id="cb785-2"><a href="power-analysis.html#cb785-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> df.ttest)</span></code></pre></div>
<pre><code>Cohen&#39;s d |        95% CI
-------------------------
-0.59     | [-1.48, 0.32]

- Estimated using pooled SD.</code></pre>
<p>We did!</p>
<p>So let’s now calculate the means and standard deviations based on our pilot data and run a power analysis to determine how many participants we would need, to have an 80% chance of rejecting the null hypothesis for the estimated effect size.</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="power-analysis.html#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make reproducible </span></span>
<span id="cb787-2"><a href="power-analysis.html#cb787-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb787-3"><a href="power-analysis.html#cb787-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb787-4"><a href="power-analysis.html#cb787-4" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters </span></span>
<span id="cb787-5"><a href="power-analysis.html#cb787-5" aria-hidden="true" tabindex="-1"></a>mean1 <span class="ot">=</span> df<span class="sc">$</span>mean[<span class="dv">1</span>]</span>
<span id="cb787-6"><a href="power-analysis.html#cb787-6" aria-hidden="true" tabindex="-1"></a>mean2 <span class="ot">=</span> df<span class="sc">$</span>mean[<span class="dv">2</span>]</span>
<span id="cb787-7"><a href="power-analysis.html#cb787-7" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">=</span> df<span class="sc">$</span>sd[<span class="dv">1</span>]</span>
<span id="cb787-8"><a href="power-analysis.html#cb787-8" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">=</span> df<span class="sc">$</span>sd[<span class="dv">2</span>]</span>
<span id="cb787-9"><a href="power-analysis.html#cb787-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb787-10"><a href="power-analysis.html#cb787-10" aria-hidden="true" tabindex="-1"></a><span class="co"># number of simulations</span></span>
<span id="cb787-11"><a href="power-analysis.html#cb787-11" aria-hidden="true" tabindex="-1"></a>n_simulations <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb787-12"><a href="power-analysis.html#cb787-12" aria-hidden="true" tabindex="-1"></a><span class="co"># n_simulations = 50</span></span>
<span id="cb787-13"><a href="power-analysis.html#cb787-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb787-14"><a href="power-analysis.html#cb787-14" aria-hidden="true" tabindex="-1"></a><span class="co"># run simulation </span></span>
<span id="cb787-15"><a href="power-analysis.html#cb787-15" aria-hidden="true" tabindex="-1"></a>df.power2 <span class="ot">=</span> <span class="fu">crossing</span>(<span class="at">n =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">10</span>, <span class="at">to =</span> <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">2</span>),</span>
<span id="cb787-16"><a href="power-analysis.html#cb787-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations) <span class="sc">%&gt;%</span></span>
<span id="cb787-17"><a href="power-analysis.html#cb787-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb787-18"><a href="power-analysis.html#cb787-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(index, n, simulation) <span class="sc">%&gt;%</span> </span>
<span id="cb787-19"><a href="power-analysis.html#cb787-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">group1 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n,</span>
<span id="cb787-20"><a href="power-analysis.html#cb787-20" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">mean =</span> mean1,</span>
<span id="cb787-21"><a href="power-analysis.html#cb787-21" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sd =</span> sd1),</span>
<span id="cb787-22"><a href="power-analysis.html#cb787-22" aria-hidden="true" tabindex="-1"></a>                            <span class="at">group2 =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n,</span>
<span id="cb787-23"><a href="power-analysis.html#cb787-23" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">mean =</span> mean2,</span>
<span id="cb787-24"><a href="power-analysis.html#cb787-24" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sd =</span> sd2)) <span class="sc">%&gt;%</span> </span>
<span id="cb787-25"><a href="power-analysis.html#cb787-25" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>()))) <span class="sc">%&gt;%</span> </span>
<span id="cb787-26"><a href="power-analysis.html#cb787-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(index, n, simulation) <span class="sc">%&gt;%</span> </span>
<span id="cb787-27"><a href="power-analysis.html#cb787-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p.value =</span> <span class="fu">map</span>(data,</span>
<span id="cb787-28"><a href="power-analysis.html#cb787-28" aria-hidden="true" tabindex="-1"></a>                   <span class="sc">~</span> <span class="fu">t.test</span>(<span class="at">formula =</span> value <span class="sc">~</span> name,</span>
<span id="cb787-29"><a href="power-analysis.html#cb787-29" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> .x)<span class="sc">$</span>p.value)) <span class="sc">%&gt;%</span></span>
<span id="cb787-30"><a href="power-analysis.html#cb787-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(coef = map(fit, tidy)) %&gt;%</span></span>
<span id="cb787-31"><a href="power-analysis.html#cb787-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select(simulation, n, index, coef) %&gt;%</span></span>
<span id="cb787-32"><a href="power-analysis.html#cb787-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># unnest(cols = coef) %&gt;%</span></span>
<span id="cb787-33"><a href="power-analysis.html#cb787-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span> </span>
<span id="cb787-34"><a href="power-analysis.html#cb787-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">power =</span> <span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">/</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb787-35"><a href="power-analysis.html#cb787-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb787-36"><a href="power-analysis.html#cb787-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb787-37"><a href="power-analysis.html#cb787-37" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize results</span></span>
<span id="cb787-38"><a href="power-analysis.html#cb787-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.power2, </span>
<span id="cb787-39"><a href="power-analysis.html#cb787-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> n,</span>
<span id="cb787-40"><a href="power-analysis.html#cb787-40" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> power)) <span class="sc">+</span></span>
<span id="cb787-41"><a href="power-analysis.html#cb787-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb787-42"><a href="power-analysis.html#cb787-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>,</span>
<span id="cb787-43"><a href="power-analysis.html#cb787-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb787-44"><a href="power-analysis.html#cb787-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb787-45"><a href="power-analysis.html#cb787-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>,</span>
<span id="cb787-46"><a href="power-analysis.html#cb787-46" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb787-47"><a href="power-analysis.html#cb787-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span> </span>
<span id="cb787-48"><a href="power-analysis.html#cb787-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>()</span></code></pre></div>
<p><img src="14-power_analysis_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>Let’s compare to what we’d get from the <code>pwr</code> package.</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="power-analysis.html#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> <span class="fl">0.5874251</span>,</span>
<span id="cb788-2"><a href="power-analysis.html#cb788-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">power =</span> <span class="fl">0.8</span>,</span>
<span id="cb788-3"><a href="power-analysis.html#cb788-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">&quot;two.sample&quot;</span>,</span>
<span id="cb788-4"><a href="power-analysis.html#cb788-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>
     Two-sample t test power calculation 

              n = 46.4718
              d = 0.5874251
      sig.level = 0.05
          power = 0.8
    alternative = two.sided

NOTE: n is number in *each* group</code></pre>
<p>Looks pretty similar!</p>
</div>
<div id="practice-3-simulation-of-an-interaction-effect" class="section level5" number="14.6.2.5.3">
<h5><span class="header-section-number">14.6.2.5.3</span> Practice 3 – Simulation of an interaction effect</h5>
<p>Try to run a simulation to determine how many participants you would need to have an 80% chance of rejecting the null hypothesis that there is no interaction based on the following pilot data set:</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="power-analysis.html#cb790-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb790-2"><a href="power-analysis.html#cb790-2" aria-hidden="true" tabindex="-1"></a><span class="co"># population parameters </span></span>
<span id="cb790-3"><a href="power-analysis.html#cb790-3" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb790-4"><a href="power-analysis.html#cb790-4" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb790-5"><a href="power-analysis.html#cb790-5" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb790-6"><a href="power-analysis.html#cb790-6" aria-hidden="true" tabindex="-1"></a>b1_2 <span class="ot">=</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb790-7"><a href="power-analysis.html#cb790-7" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb790-8"><a href="power-analysis.html#cb790-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span> </span>
<span id="cb790-9"><a href="power-analysis.html#cb790-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb790-10"><a href="power-analysis.html#cb790-10" aria-hidden="true" tabindex="-1"></a>df.linear <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">runif</span>(<span class="at">n =</span> n),</span>
<span id="cb790-11"><a href="power-analysis.html#cb790-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb790-12"><a href="power-analysis.html#cb790-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">z =</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x <span class="sc">+</span> b2 <span class="sc">*</span> y <span class="sc">+</span> b1_2 <span class="sc">*</span> x <span class="sc">*</span> y <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">sd =</span> sd))</span></code></pre></div>
<p>Let’s visualize the pilot data first:</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="power-analysis.html#cb791-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.linear,</span>
<span id="cb791-2"><a href="power-analysis.html#cb791-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb791-3"><a href="power-analysis.html#cb791-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> z,</span>
<span id="cb791-4"><a href="power-analysis.html#cb791-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">group =</span> y,</span>
<span id="cb791-5"><a href="power-analysis.html#cb791-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="fu">as.factor</span>(y),</span>
<span id="cb791-6"><a href="power-analysis.html#cb791-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="fu">as.factor</span>(y))) <span class="sc">+</span> </span>
<span id="cb791-7"><a href="power-analysis.html#cb791-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb791-8"><a href="power-analysis.html#cb791-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> F,</span>
<span id="cb791-9"><a href="power-analysis.html#cb791-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb791-10"><a href="power-analysis.html#cb791-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb791-11"><a href="power-analysis.html#cb791-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb791-12"><a href="power-analysis.html#cb791-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> F)</span></code></pre></div>
<p><img src="14-power_analysis_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Let’s estimate the parameters based on our sample:</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="power-analysis.html#cb792-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parameter estimates for the coefficients based on the sample </span></span>
<span id="cb792-2"><a href="power-analysis.html#cb792-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> z <span class="sc">~</span> x <span class="sc">*</span> y,</span>
<span id="cb792-3"><a href="power-analysis.html#cb792-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df.linear) <span class="sc">%&gt;%</span> </span>
<span id="cb792-4"><a href="power-analysis.html#cb792-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb792-5"><a href="power-analysis.html#cb792-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, p.value)</span>
<span id="cb792-6"><a href="power-analysis.html#cb792-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb792-7"><a href="power-analysis.html#cb792-7" aria-hidden="true" tabindex="-1"></a><span class="co"># parameter estimate of the residual standard deviation </span></span>
<span id="cb792-8"><a href="power-analysis.html#cb792-8" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> z <span class="sc">~</span> x <span class="sc">*</span> y,</span>
<span id="cb792-9"><a href="power-analysis.html#cb792-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">data =</span> df.linear) <span class="sc">%&gt;%</span> </span>
<span id="cb792-10"><a href="power-analysis.html#cb792-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glance</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb792-11"><a href="power-analysis.html#cb792-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(sigma)</span></code></pre></div>
<p>Run a power analysis to see how many participants you would need to have an 80% of rejecting the null hypothesis that there is no interaction. Use the parameter estimates (the beta coefficients and the standard deviation of the residuals <code>sigma</code>) based on your pilot data to simulate new data.</p>
<p>Here is the strategy:</p>
<ul>
<li>Try to closely emulate what we’ve been doing for the independent samples t-test above.</li>
<li>However, this time, we have a different way of generating the data (namely by using the regression equation: <span class="math inline">\(z \sim b_0 + b_1 \cdot x + b_2 \cdot y + b_{1\_2} \cdot x \cdot y + e)\)</span>, where <span class="math inline">\(e \sim N(0, \sigma)\)</span>.</li>
<li>Fit the model first to extract the estimates for the beta coefficients, and the standard deviation of the residuals <code>sigma</code>.</li>
<li>Then use these parameters to generate new data assuming that <code>x</code> is a continuous predictor between 0 and 1 (<code>x = runif(n = n)</code>) and <code>y</code> is a binary, dummy-coded variable (<code>y = rep(c(0, 1), each = n/2)</code>).</li>
<li>Extract the coefficients of each model fit, and check whether the interaction is significant.</li>
<li>Make a plot that shows how power changes with the sample size n. </li>
</ul>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="power-analysis.html#cb793-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb793-2"><a href="power-analysis.html#cb793-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write your code here </span></span></code></pre></div>
<p>Run the same power analysis this time assuming the ground truth parameters from the population (rather than the parameters that we’ve estimated from the sample).</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="power-analysis.html#cb794-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb794-2"><a href="power-analysis.html#cb794-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write your code here </span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="additional-resources-11" class="section level2" number="14.7">
<h2><span class="header-section-number">14.7</span> Additional resources</h2>
<div id="datacamp-6" class="section level3" number="14.7.1">
<h3><span class="header-section-number">14.7.1</span> Datacamp</h3>
<ul>
<li><a href="https://www.datacamp.com/courses/foundations-of-functional-programming-with-purrr">Functional programming with purrr</a></li>
</ul>
</div>
<div id="cheatsheets-6" class="section level3" number="14.7.2">
<h3><span class="header-section-number">14.7.2</span> Cheatsheets</h3>
<ul>
<li><a href="figures/purrr.pdf">purrr</a></li>
</ul>
</div>
<div id="misc-6" class="section level3" number="14.7.3">
<h3><span class="header-section-number">14.7.3</span> Misc</h3>
<ul>
<li><a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html">Getting started with <code>pwr</code></a></li>
<li><a href="https://rpsychologist.com/d3/NHST/">Visualize power</a></li>
<li><a href="https://www.frontiersin.org/articles/10.3389/fpsyg.2013.00863/full">Calculating and reporting effect sizes to facilitate cumulative science: a practical primer for t-tests and ANOVAs</a></li>
<li><a href="https://emoriebeck.github.io/R-tutorials/purrr/">purrr tutorial</a></li>
<li><a href="https://cran.r-project.org/web/packages/simr/index.html">simr</a>: R Package for running power analysis for generalized linear mixed effects models.</li>
<li><a href="https://cran.r-project.org/web/packages/simglm/index.html">simglm</a>: Alternative R package for running power analysis via simulation.</li>
<li><a href="https://nccih.nih.gov/grants/whatnccihfunds/pilot_studies">cautionary tale about using pilot studies for power calculations</a></li>
</ul>
</div>
</div>
<div id="session-info-13" class="section level2" number="14.8">
<h2><span class="header-section-number">14.8</span> Session info</h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="power-analysis.html#cb795-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Catalina 10.15.7

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.5.1      stringr_1.4.0      dplyr_1.0.4        purrr_0.3.4       
 [5] readr_1.4.0        tidyr_1.1.2        tibble_3.0.6       ggplot2_3.3.3     
 [9] tidyverse_1.3.0    pwr_1.3-0          car_3.0-10         carData_3.0-4     
[13] effectsize_0.4.3-1 magrittr_2.0.1     broom_0.7.3        kableExtra_1.3.1  
[17] knitr_1.31        

loaded via a namespace (and not attached):
 [1] TH.data_1.0-10      colorspace_2.0-0    ellipsis_0.3.1     
 [4] rio_0.5.16          estimability_1.3    htmlTable_2.1.0    
 [7] parameters_0.12.0.1 base64enc_0.1-3     fs_1.5.0           
[10] rstudioapi_0.13     farver_2.1.0        fansi_0.4.2        
[13] mvtnorm_1.1-1       lubridate_1.7.9.2   xml2_1.3.2         
[16] codetools_0.2-18    splines_4.0.3       Formula_1.2-4      
[19] jsonlite_1.7.2      cluster_2.1.0       dbplyr_2.0.0       
[22] png_0.1-7           compiler_4.0.3      httr_1.4.2         
[25] emmeans_1.5.3       backports_1.2.1     assertthat_0.2.1   
[28] Matrix_1.3-2        cli_2.3.0           htmltools_0.5.1.1  
[31] tools_4.0.3         coda_0.19-4         gtable_0.3.0       
[34] glue_1.4.2          Rcpp_1.0.6          cellranger_1.1.0   
[37] vctrs_0.3.6         nlme_3.1-151        insight_0.13.1.1   
[40] xfun_0.21           ps_1.6.0            openxlsx_4.2.3     
[43] rvest_0.3.6         lifecycle_1.0.0     MASS_7.3-53        
[46] zoo_1.8-8           scales_1.1.1        hms_1.0.0          
[49] sandwich_3.0-0      RColorBrewer_1.1-2  yaml_2.2.1         
[52] curl_4.3            gridExtra_2.3       rpart_4.1-15       
[55] latticeExtra_0.6-29 stringi_1.5.3       highr_0.8          
[58] bayestestR_0.8.3.1  checkmate_2.0.0     zip_2.1.1          
[61] rlang_0.4.10        pkgconfig_2.0.3     evaluate_0.14      
[64] lattice_0.20-41     htmlwidgets_1.5.3   labeling_0.4.2     
[67] tidyselect_1.1.0    bookdown_0.21       R6_2.5.0           
[70] generics_0.1.0      Hmisc_4.4-2         multcomp_1.4-15    
[73] DBI_1.1.1           pillar_1.4.7        haven_2.3.1        
[76] foreign_0.8-81      withr_2.4.1         mgcv_1.8-33        
[79] survival_3.2-7      abind_1.4-5         nnet_7.3-15        
[82] modelr_0.1.8        crayon_1.4.1        utf8_1.1.4         
[85] rmarkdown_2.6       jpeg_0.1-8.1        grid_4.0.3         
[88] readxl_1.3.1        data.table_1.13.6   reprex_1.0.0       
[91] digest_0.6.27       webshot_0.5.2       xtable_1.8-4       
[94] munsell_0.5.0       viridisLite_0.3.0  </code></pre>
</div>
<div id="references-3" class="section level2" number="14.9">
<h2><span class="header-section-number">14.9</span> References</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-model-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mediation-moderation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/14-power_analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
