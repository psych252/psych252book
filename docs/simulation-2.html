<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Simulation 2 | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Simulation 2 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Simulation 2 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2025-01-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulation-1.html"/>
<link rel="next" href="modeling-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#install-all-packages-needed-for-this-book"><i class="fa fa-check"></i><b>1.3</b> Install all packages needed for this book</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#some-basics"><i class="fa fa-check"></i><b>2.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.4.2</b> Getting help</a></li>
<li class="chapter" data-level="2.4.3" data-path="visualization-1.html"><a href="visualization-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>2.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="2.4.4" data-path="visualization-1.html"><a href="visualization-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization"><i class="fa fa-check"></i><b>2.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization-1.html"><a href="visualization-1.html#bar-plot"><i class="fa fa-check"></i><b>2.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.5.4" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5.5" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.5.5</b> Line plot</a></li>
<li class="chapter" data-level="2.5.6" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="2.5.7" data-path="visualization-1.html"><a href="visualization-1.html#order-matters"><i class="fa fa-check"></i><b>2.5.7</b> Order matters</a></li>
<li class="chapter" data-level="2.5.8" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="2.5.9" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.5.9</b> Making facets</a></li>
<li class="chapter" data-level="2.5.10" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.3.1</b> Modes</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.3.2</b> Data types</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.3.3</b> Operators</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.3.4</b> Control flow</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.3.5</b> Functions</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>4.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.6.1</b> csv</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>6</b> Probability</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability.html"><a href="probability.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>6.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.2" data-path="probability.html"><a href="probability.html#counting"><i class="fa fa-check"></i><b>6.2</b> Counting</a></li>
<li class="chapter" data-level="6.3" data-path="probability.html"><a href="probability.html#the-random-secretary"><i class="fa fa-check"></i><b>6.3</b> The random secretary</a></li>
<li class="chapter" data-level="6.4" data-path="probability.html"><a href="probability.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability.html"><a href="probability.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="probability.html"><a href="probability.html#conditional-probability"><i class="fa fa-check"></i><b>6.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.5.2" data-path="probability.html"><a href="probability.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="probability.html"><a href="probability.html#probability-operations"><i class="fa fa-check"></i><b>6.6</b> Probability operations</a></li>
<li class="chapter" data-level="6.7" data-path="probability.html"><a href="probability.html#bayesian-reasoning-explained"><i class="fa fa-check"></i><b>6.7</b> Bayesian reasoning explained</a></li>
<li class="chapter" data-level="6.8" data-path="probability.html"><a href="probability.html#getting-bayes-right-matters"><i class="fa fa-check"></i><b>6.8</b> Getting Bayes right matters</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="probability.html"><a href="probability.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8.1</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.8.2" data-path="probability.html"><a href="probability.html#bayesian-reasoning-example-covid-rapid-test"><i class="fa fa-check"></i><b>6.8.2</b> Bayesian reasoning example (COVID rapid test)</a></li>
<li class="chapter" data-level="6.8.3" data-path="probability.html"><a href="probability.html#most-people-in-the-hospital-are-vaccinated"><i class="fa fa-check"></i><b>6.8.3</b> Most people in the hospital are vaccinated</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="probability.html"><a href="probability.html#building-a-bayesis"><i class="fa fa-check"></i><b>6.9</b> Building a Bayesis</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="probability.html"><a href="probability.html#dice-example"><i class="fa fa-check"></i><b>6.9.1</b> Dice example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability.html"><a href="probability.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="probability.html"><a href="probability.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability.html"><a href="probability.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability.html"><a href="probability.html#misc-2"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability.html"><a href="probability.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>7.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>7.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="7.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>7.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="7.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>7.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="7.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>7.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="7.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>7.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>8.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>8.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>8.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-2.html"><a href="simulation-2.html#misc-3"><i class="fa fa-check"></i><b>8.5.1</b> Misc</a></li>
<li class="chapter" data-level="8.5.2" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-1"><i class="fa fa-check"></i><b>8.5.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.2.2" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.2.2</b> Sampling distributions for median and mean</a></li>
<li class="chapter" data-level="9.2.3" data-path="modeling-data.html"><a href="modeling-data.html#residuals-need-to-be-normally-distributed-not-the-data-itself"><i class="fa fa-check"></i><b>9.2.3</b> Residuals need to be normally distributed, not the data itself</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#misc-4"><i class="fa fa-check"></i><b>9.5</b> Misc</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-2"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-8"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.2</b> Correlation</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.3.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.3.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.4</b> Credit example</a></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-3"><i class="fa fa-check"></i><b>10.5.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-5"><i class="fa fa-check"></i><b>10.5.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-9"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-3"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-4"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-6"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-10"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
<li class="chapter" data-level="11.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>11.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-4"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-5"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-7"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-11"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.2</b> Load data sets</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>13.3</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>13.4</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#linear-contrasts"><i class="fa fa-check"></i><b>13.5</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.5.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.5.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.5.2</b> Visualization</a></li>
<li class="chapter" data-level="13.5.3" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.5.3</b> Post-hoc tests</a></li>
<li class="chapter" data-level="13.5.4" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>13.5.4</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="13.5.5" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-sum-coding"><i class="fa fa-check"></i><b>13.5.5</b> Understanding sum coding</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="linear-model-4.html"><a href="linear-model-4.html#additional-resources-11"><i class="fa fa-check"></i><b>13.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="linear-model-4.html"><a href="linear-model-4.html#misc-8"><i class="fa fa-check"></i><b>13.6.1</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-12"><i class="fa fa-check"></i><b>13.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>14</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="14.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-5"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>14.3</b> Load data set</a></li>
<li class="chapter" data-level="14.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>14.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>14.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="14.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>14.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="14.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>14.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="14.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>14.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="14.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>14.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>14.5</b> Simulate a logistic regression</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#calculate-the-models-likelihood"><i class="fa fa-check"></i><b>14.5.1</b> Calculate the model’s likelihood</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>14.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="14.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>14.7</b> Additional information</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#misc-9"><i class="fa fa-check"></i><b>14.7.1</b> Misc</a></li>
<li class="chapter" data-level="14.7.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-6"><i class="fa fa-check"></i><b>14.7.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-13"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>15</b> Power analysis</a>
<ul>
<li class="chapter" data-level="15.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-6"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>15.3</b> Load data sets</a></li>
<li class="chapter" data-level="15.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>15.4</b> Decision-making</a></li>
<li class="chapter" data-level="15.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>15.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>15.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>15.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>15.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="15.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-1"><i class="fa fa-check"></i><b>15.6.2</b> Power analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-12"><i class="fa fa-check"></i><b>15.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-7"><i class="fa fa-check"></i><b>15.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="15.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-5"><i class="fa fa-check"></i><b>15.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="15.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-10"><i class="fa fa-check"></i><b>15.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-14"><i class="fa fa-check"></i><b>15.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>16</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-7"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>16.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>16.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="16.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>16.3.2</b> F-test</a></li>
<li class="chapter" data-level="16.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>16.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="16.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>16.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="16.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>16.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-13"><i class="fa fa-check"></i><b>16.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>16.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="16.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>16.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-15"><i class="fa fa-check"></i><b>16.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-8"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-16"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-9"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>18.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>18.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="18.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>18.3.2</b> No pooling</a></li>
<li class="chapter" data-level="18.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>18.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="18.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>18.3.4</b> Compare results</a></li>
<li class="chapter" data-level="18.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>18.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="18.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>18.3.6</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>18.4</b> Simulating a linear mixed effects model</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.4.1</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.4.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.4.2</b> Different slopes</a></li>
<li class="chapter" data-level="18.4.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.4.3</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-17"><i class="fa fa-check"></i><b>18.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-10"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-4"><i class="fa fa-check"></i><b>19.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>19.3.1</b> Reasoning data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>19.5</b> ANOVA vs. lmer</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>19.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>19.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>19.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#additional-resources-16"><i class="fa fa-check"></i><b>19.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#readings-2"><i class="fa fa-check"></i><b>19.6.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-18"><i class="fa fa-check"></i><b>19.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html"><i class="fa fa-check"></i><b>20</b> Linear mixed effects models 4</a>
<ul>
<li class="chapter" data-level="20.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#learning-goals-11"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-data-sets-5"><i class="fa fa-check"></i><b>20.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-data"><i class="fa fa-check"></i><b>20.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="20.3.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#reasoning-data-1"><i class="fa fa-check"></i><b>20.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="20.3.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-data"><i class="fa fa-check"></i><b>20.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="20.3.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politness-data"><i class="fa fa-check"></i><b>20.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>20.4</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-study"><i class="fa fa-check"></i><b>20.4.1</b> Sleep study</a></li>
<li class="chapter" data-level="20.4.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-study"><i class="fa fa-check"></i><b>20.4.2</b> Weight loss study</a></li>
<li class="chapter" data-level="20.4.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politeness-study"><i class="fa fa-check"></i><b>20.4.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#mixtures-of-participants"><i class="fa fa-check"></i><b>20.5</b> Mixtures of participants</a></li>
<li class="chapter" data-level="20.6" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#simulating-different-random-effects-structures"><i class="fa fa-check"></i><b>20.6</b> Simulating different random effects structures</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#two-level-model"><i class="fa fa-check"></i><b>20.6.1</b> Two-level model</a></li>
<li class="chapter" data-level="20.6.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#three-level-model"><i class="fa fa-check"></i><b>20.6.2</b> Three-level model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#bootstrapping"><i class="fa fa-check"></i><b>20.7</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-model"><i class="fa fa-check"></i><b>20.7.1</b> Linear model</a></li>
<li class="chapter" data-level="20.7.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-mixed-effects-model"><i class="fa fa-check"></i><b>20.7.2</b> Linear mixed effects model</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>20.8</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="20.9" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#session-info-19"><i class="fa fa-check"></i><b>20.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="causation.html"><a href="causation.html"><i class="fa fa-check"></i><b>21</b> Causation</a>
<ul>
<li class="chapter" data-level="21.1" data-path="causation.html"><a href="causation.html#learning-goals-12"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="causation.html"><a href="causation.html#recommended-reading"><i class="fa fa-check"></i><b>21.2</b> Recommended reading</a></li>
<li class="chapter" data-level="21.3" data-path="causation.html"><a href="causation.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.4" data-path="causation.html"><a href="causation.html#bayesian-networks"><i class="fa fa-check"></i><b>21.4</b> Bayesian networks</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="causation.html"><a href="causation.html#sprinkler-example"><i class="fa fa-check"></i><b>21.4.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="causation.html"><a href="causation.html#controlling-for-variables"><i class="fa fa-check"></i><b>21.5</b> Controlling for variables</a>
<ul>
<li class="chapter" data-level="21.5.1" data-path="causation.html"><a href="causation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>21.5.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="21.5.2" data-path="causation.html"><a href="causation.html#good-controls"><i class="fa fa-check"></i><b>21.5.2</b> Good controls</a></li>
<li class="chapter" data-level="21.5.3" data-path="causation.html"><a href="causation.html#bad-controls"><i class="fa fa-check"></i><b>21.5.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="21.6" data-path="causation.html"><a href="causation.html#mediation"><i class="fa fa-check"></i><b>21.6</b> Mediation</a>
<ul>
<li class="chapter" data-level="21.6.1" data-path="causation.html"><a href="causation.html#generate-data"><i class="fa fa-check"></i><b>21.6.1</b> Generate data</a></li>
<li class="chapter" data-level="21.6.2" data-path="causation.html"><a href="causation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>21.6.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="21.6.3" data-path="causation.html"><a href="causation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>21.6.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="21.6.4" data-path="causation.html"><a href="causation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>21.6.4</b> Method 3: Bootstrapping</a></li>
<li class="chapter" data-level="21.6.5" data-path="causation.html"><a href="causation.html#be-careful-about-mediation"><i class="fa fa-check"></i><b>21.6.5</b> Be careful about mediation!</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="causation.html"><a href="causation.html#moderation"><i class="fa fa-check"></i><b>21.7</b> Moderation</a>
<ul>
<li class="chapter" data-level="21.7.1" data-path="causation.html"><a href="causation.html#generate-data-1"><i class="fa fa-check"></i><b>21.7.1</b> Generate data</a></li>
<li class="chapter" data-level="21.7.2" data-path="causation.html"><a href="causation.html#moderation-analysis"><i class="fa fa-check"></i><b>21.7.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="21.8" data-path="causation.html"><a href="causation.html#additional-resources-17"><i class="fa fa-check"></i><b>21.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="causation.html"><a href="causation.html#books"><i class="fa fa-check"></i><b>21.8.1</b> Books</a></li>
<li class="chapter" data-level="21.8.2" data-path="causation.html"><a href="causation.html#tutorials-1"><i class="fa fa-check"></i><b>21.8.2</b> Tutorials</a></li>
<li class="chapter" data-level="21.8.3" data-path="causation.html"><a href="causation.html#misc-11"><i class="fa fa-check"></i><b>21.8.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="causation.html"><a href="causation.html#session-info-20"><i class="fa fa-check"></i><b>21.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis 1</a>
<ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#learning-goals-13"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>22.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#coin-flip-example"><i class="fa fa-check"></i><b>22.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="22.3.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>22.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>22.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#attitude-data-set"><i class="fa fa-check"></i><b>22.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#frequentist-analysis"><i class="fa fa-check"></i><b>22.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#bayesian-regression"><i class="fa fa-check"></i><b>22.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#additional-resources-18"><i class="fa fa-check"></i><b>22.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="22.5.1" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#books-and-chapters-5"><i class="fa fa-check"></i><b>22.5.1</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="bayesian-data-analysis-1.html"><a href="bayesian-data-analysis-1.html#session-info-21"><i class="fa fa-check"></i><b>22.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-14"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-6"><i class="fa fa-check"></i><b>23.3</b> Load data sets</a></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>23.4</b> Poker</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>23.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>23.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>23.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>23.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="23.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>23.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>23.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>23.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>23.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>23.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>23.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>23.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>23.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>23.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>23.6.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>23.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>23.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>23.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>23.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>23.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>23.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="23.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-3"><i class="fa fa-check"></i><b>23.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-3"><i class="fa fa-check"></i><b>23.7.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.7.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>23.7.3</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-19"><i class="fa fa-check"></i><b>23.8</b> Additional resources</a></li>
<li class="chapter" data-level="23.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-22"><i class="fa fa-check"></i><b>23.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>24</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="24.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-15"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>24.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>24.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="24.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>24.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>24.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-4"><i class="fa fa-check"></i><b>24.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="24.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>24.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="24.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>24.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>24.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="24.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>24.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>24.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-20"><i class="fa fa-check"></i><b>24.7</b> Additional resources</a></li>
<li class="chapter" data-level="24.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-23"><i class="fa fa-check"></i><b>24.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>25</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="25.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-16"><i class="fa fa-check"></i><b>25.1</b> Learning goals</a></li>
<li class="chapter" data-level="25.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-18"><i class="fa fa-check"></i><b>25.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="25.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>25.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>25.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="25.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>25.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="25.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>25.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="25.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>25.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="25.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>25.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-21"><i class="fa fa-check"></i><b>25.4</b> Additional resources</a></li>
<li class="chapter" data-level="25.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-24"><i class="fa fa-check"></i><b>25.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>26</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="26.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>26.1</b> General advice</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>26.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="26.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>26.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="26.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>26.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="26.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>26.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="26.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>26.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>26.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>26.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#additional-resources-22"><i class="fa fa-check"></i><b>26.3</b> Additional resources</a>
<ul>
<li class="chapter" data-level="26.3.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#misc-12"><i class="fa fa-check"></i><b>26.3.1</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-25"><i class="fa fa-check"></i><b>26.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html"><i class="fa fa-check"></i><b>27</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="27.1" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#statistics"><i class="fa fa-check"></i><b>27.1</b> Statistics</a></li>
<li class="chapter" data-level="27.2" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#r"><i class="fa fa-check"></i><b>27.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation-2" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Simulation 2<a href="simulation-2.html#simulation-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In which we figure out some key statistical concepts through simulation and plotting. On the menu we have:</p>
<ul>
<li>Sampling distributions</li>
<li>p-value</li>
<li>Confidence interval</li>
<li>Bootstrapping</li>
</ul>
<div id="load-packages-and-set-plotting-theme-1" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Load packages and set plotting theme<a href="simulation-2.html#load-packages-and-set-plotting-theme-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="simulation-2.html#cb458-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)      <span class="co"># for knitting RMarkdown </span></span>
<span id="cb458-2"><a href="simulation-2.html#cb458-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>) <span class="co"># for making nice tables</span></span>
<span id="cb458-3"><a href="simulation-2.html#cb458-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;janitor&quot;</span>)    <span class="co"># for cleaning column names</span></span>
<span id="cb458-4"><a href="simulation-2.html#cb458-4" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)  <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="simulation-2.html#cb459-1" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co">#set the theme </span></span>
<span id="cb459-2"><a href="simulation-2.html#cb459-2" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co">#set the default text size</span></span>
<span id="cb459-3"><a href="simulation-2.html#cb459-3" tabindex="-1"></a></span>
<span id="cb459-4"><a href="simulation-2.html#cb459-4" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb459-5"><a href="simulation-2.html#cb459-5" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span></code></pre></div>
</div>
<div id="making-statistical-inferences-frequentist-style" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Making statistical inferences (frequentist style)<a href="simulation-2.html#making-statistical-inferences-frequentist-style" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="population-distribution" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Population distribution<a href="simulation-2.html#population-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s first put the information we need for our population distribution in a data frame.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="simulation-2.html#cb460-1" tabindex="-1"></a><span class="co"># the distribution from which we want to sample (aka the heavy metal distribution)</span></span>
<span id="cb460-2"><a href="simulation-2.html#cb460-2" tabindex="-1"></a>df.population <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">numbers =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb460-3"><a href="simulation-2.html#cb460-3" tabindex="-1"></a>                       <span class="at">probability =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>))</span></code></pre></div>
<p>And then let’s plot it:</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="simulation-2.html#cb461-1" tabindex="-1"></a><span class="co"># plot the distribution </span></span>
<span id="cb461-2"><a href="simulation-2.html#cb461-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.population,</span>
<span id="cb461-3"><a href="simulation-2.html#cb461-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> numbers,</span>
<span id="cb461-4"><a href="simulation-2.html#cb461-4" tabindex="-1"></a>                     <span class="at">y =</span> probability)) <span class="sc">+</span></span>
<span id="cb461-5"><a href="simulation-2.html#cb461-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,</span>
<span id="cb461-6"><a href="simulation-2.html#cb461-6" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb461-7"><a href="simulation-2.html#cb461-7" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb461-8"><a href="simulation-2.html#cb461-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> df.population<span class="sc">$</span>numbers,</span>
<span id="cb461-9"><a href="simulation-2.html#cb461-9" tabindex="-1"></a>                     <span class="at">labels =</span> df.population<span class="sc">$</span>numbers,</span>
<span id="cb461-10"><a href="simulation-2.html#cb461-10" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">6.9</span>)) <span class="sc">+</span></span>
<span id="cb461-11"><a href="simulation-2.html#cb461-11" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> F)</span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Here are the true mean and standard deviation of our population distribution:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="simulation-2.html#cb462-1" tabindex="-1"></a><span class="co"># mean and standard deviation (see: https://nzmaths.co.nz/category/glossary/standard-deviation-discrete-random-variable)</span></span>
<span id="cb462-2"><a href="simulation-2.html#cb462-2" tabindex="-1"></a></span>
<span id="cb462-3"><a href="simulation-2.html#cb462-3" tabindex="-1"></a>df.population <span class="sc">%&gt;%</span> </span>
<span id="cb462-4"><a href="simulation-2.html#cb462-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">population_mean =</span> <span class="fu">sum</span>(numbers <span class="sc">*</span> probability),</span>
<span id="cb462-5"><a href="simulation-2.html#cb462-5" tabindex="-1"></a>            <span class="at">population_sd =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(numbers<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> probability) <span class="sc">-</span> population_mean<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb462-6"><a href="simulation-2.html#cb462-6" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb462-7"><a href="simulation-2.html#cb462-7" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb462-8"><a href="simulation-2.html#cb462-8" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
population_mean
</th>
<th style="text-align:right;">
population_sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
2.06
</td>
</tr>
</tbody>
</table>
</div>
<div id="distribution-of-a-single-sample" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Distribution of a single sample<a href="simulation-2.html#distribution-of-a-single-sample" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s draw a single sample of size <span class="math inline">\(n = 40\)</span> from the population distribution and plot it:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="simulation-2.html#cb463-1" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb463-2"><a href="simulation-2.html#cb463-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb463-3"><a href="simulation-2.html#cb463-3" tabindex="-1"></a></span>
<span id="cb463-4"><a href="simulation-2.html#cb463-4" tabindex="-1"></a><span class="co"># set the sample size</span></span>
<span id="cb463-5"><a href="simulation-2.html#cb463-5" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">40</span> </span>
<span id="cb463-6"><a href="simulation-2.html#cb463-6" tabindex="-1"></a></span>
<span id="cb463-7"><a href="simulation-2.html#cb463-7" tabindex="-1"></a><span class="co"># create data frame </span></span>
<span id="cb463-8"><a href="simulation-2.html#cb463-8" tabindex="-1"></a>df.sample <span class="ot">=</span> <span class="fu">sample</span>(df.population<span class="sc">$</span>numbers, </span>
<span id="cb463-9"><a href="simulation-2.html#cb463-9" tabindex="-1"></a>         <span class="at">size =</span> sample_size, </span>
<span id="cb463-10"><a href="simulation-2.html#cb463-10" tabindex="-1"></a>         <span class="at">replace =</span> T,</span>
<span id="cb463-11"><a href="simulation-2.html#cb463-11" tabindex="-1"></a>         <span class="at">prob =</span> df.population<span class="sc">$</span>probability) <span class="sc">%&gt;%</span> </span>
<span id="cb463-12"><a href="simulation-2.html#cb463-12" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="at">name =</span> <span class="st">&quot;draw&quot;</span>, <span class="at">value =</span> <span class="st">&quot;number&quot;</span>)</span>
<span id="cb463-13"><a href="simulation-2.html#cb463-13" tabindex="-1"></a></span>
<span id="cb463-14"><a href="simulation-2.html#cb463-14" tabindex="-1"></a><span class="co"># draw a plot of the sample</span></span>
<span id="cb463-15"><a href="simulation-2.html#cb463-15" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sample,</span>
<span id="cb463-16"><a href="simulation-2.html#cb463-16" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> number, <span class="at">y =</span> <span class="fu">stat</span>(density))) <span class="sc">+</span> </span>
<span id="cb463-17"><a href="simulation-2.html#cb463-17" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.5</span>, </span>
<span id="cb463-18"><a href="simulation-2.html#cb463-18" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb463-19"><a href="simulation-2.html#cb463-19" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb463-20"><a href="simulation-2.html#cb463-20" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">min</span>(df.sample<span class="sc">$</span>number)<span class="sc">:</span><span class="fu">max</span>(df.sample<span class="sc">$</span>number)) <span class="sc">+</span> </span>
<span id="cb463-21"><a href="simulation-2.html#cb463-21" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>)))</span></code></pre></div>
<pre><code>Warning: `stat(density)` was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Here are the sample mean and standard deviation:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="simulation-2.html#cb465-1" tabindex="-1"></a><span class="co"># print out sample mean and standard deviation </span></span>
<span id="cb465-2"><a href="simulation-2.html#cb465-2" tabindex="-1"></a>df.sample <span class="sc">%&gt;%</span> </span>
<span id="cb465-3"><a href="simulation-2.html#cb465-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sample_mean =</span> <span class="fu">mean</span>(number),</span>
<span id="cb465-4"><a href="simulation-2.html#cb465-4" tabindex="-1"></a>            <span class="at">sample_sd =</span> <span class="fu">sd</span>(number)) <span class="sc">%&gt;%</span> </span>
<span id="cb465-5"><a href="simulation-2.html#cb465-5" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb465-6"><a href="simulation-2.html#cb465-6" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb465-7"><a href="simulation-2.html#cb465-7" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
sample_mean
</th>
<th style="text-align:right;">
sample_sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.72
</td>
<td style="text-align:right;">
2.05
</td>
</tr>
</tbody>
</table>
</div>
<div id="the-sampling-distribution" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> The sampling distribution<a href="simulation-2.html#the-sampling-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>And let’s now create the sampling distribution (making the unrealistic assumption that we know the population distribution).</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="simulation-2.html#cb466-1" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb466-2"><a href="simulation-2.html#cb466-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb466-3"><a href="simulation-2.html#cb466-3" tabindex="-1"></a></span>
<span id="cb466-4"><a href="simulation-2.html#cb466-4" tabindex="-1"></a><span class="co"># parameters </span></span>
<span id="cb466-5"><a href="simulation-2.html#cb466-5" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">40</span> <span class="co"># size of each sample</span></span>
<span id="cb466-6"><a href="simulation-2.html#cb466-6" tabindex="-1"></a>sample_n <span class="ot">=</span> <span class="dv">10000</span> <span class="co"># number of samples</span></span>
<span id="cb466-7"><a href="simulation-2.html#cb466-7" tabindex="-1"></a></span>
<span id="cb466-8"><a href="simulation-2.html#cb466-8" tabindex="-1"></a><span class="co"># define a function that draws samples from a discrete distribution</span></span>
<span id="cb466-9"><a href="simulation-2.html#cb466-9" tabindex="-1"></a>fun.draw_sample <span class="ot">=</span> <span class="cf">function</span>(sample_size, distribution){</span>
<span id="cb466-10"><a href="simulation-2.html#cb466-10" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">sample</span>(distribution<span class="sc">$</span>numbers,</span>
<span id="cb466-11"><a href="simulation-2.html#cb466-11" tabindex="-1"></a>             <span class="at">size =</span> sample_size,</span>
<span id="cb466-12"><a href="simulation-2.html#cb466-12" tabindex="-1"></a>             <span class="at">replace =</span> T,</span>
<span id="cb466-13"><a href="simulation-2.html#cb466-13" tabindex="-1"></a>             <span class="at">prob =</span> distribution<span class="sc">$</span>probability)</span>
<span id="cb466-14"><a href="simulation-2.html#cb466-14" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb466-15"><a href="simulation-2.html#cb466-15" tabindex="-1"></a>}</span>
<span id="cb466-16"><a href="simulation-2.html#cb466-16" tabindex="-1"></a></span>
<span id="cb466-17"><a href="simulation-2.html#cb466-17" tabindex="-1"></a><span class="co"># generate many samples </span></span>
<span id="cb466-18"><a href="simulation-2.html#cb466-18" tabindex="-1"></a>samples <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> sample_n,</span>
<span id="cb466-19"><a href="simulation-2.html#cb466-19" tabindex="-1"></a>                    <span class="fu">fun.draw_sample</span>(sample_size, df.population))</span>
<span id="cb466-20"><a href="simulation-2.html#cb466-20" tabindex="-1"></a></span>
<span id="cb466-21"><a href="simulation-2.html#cb466-21" tabindex="-1"></a><span class="co"># set up a data frame with samples </span></span>
<span id="cb466-22"><a href="simulation-2.html#cb466-22" tabindex="-1"></a>df.sampling_distribution <span class="ot">=</span> <span class="fu">matrix</span>(samples, <span class="at">ncol =</span> sample_n) <span class="sc">%&gt;%</span></span>
<span id="cb466-23"><a href="simulation-2.html#cb466-23" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">.name_repair =</span> <span class="sc">~</span> <span class="fu">str_c</span>(<span class="dv">1</span><span class="sc">:</span>sample_n)) <span class="sc">%&gt;%</span></span>
<span id="cb466-24"><a href="simulation-2.html#cb466-24" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb466-25"><a href="simulation-2.html#cb466-25" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;sample&quot;</span>,</span>
<span id="cb466-26"><a href="simulation-2.html#cb466-26" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;number&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb466-27"><a href="simulation-2.html#cb466-27" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">as.numeric</span>(sample)) <span class="sc">%&gt;%</span> </span>
<span id="cb466-28"><a href="simulation-2.html#cb466-28" tabindex="-1"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb466-29"><a href="simulation-2.html#cb466-29" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draw =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb466-30"><a href="simulation-2.html#cb466-30" tabindex="-1"></a>  <span class="fu">select</span>(sample, draw, number) <span class="sc">%&gt;%</span> </span>
<span id="cb466-31"><a href="simulation-2.html#cb466-31" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb466-32"><a href="simulation-2.html#cb466-32" tabindex="-1"></a></span>
<span id="cb466-33"><a href="simulation-2.html#cb466-33" tabindex="-1"></a><span class="co"># turn the data frame into long format and calculate the means of each sample</span></span>
<span id="cb466-34"><a href="simulation-2.html#cb466-34" tabindex="-1"></a>df.sampling_distribution_means <span class="ot">=</span> df.sampling_distribution <span class="sc">%&gt;%</span> </span>
<span id="cb466-35"><a href="simulation-2.html#cb466-35" tabindex="-1"></a>  <span class="fu">group_by</span>(sample) <span class="sc">%&gt;%</span> </span>
<span id="cb466-36"><a href="simulation-2.html#cb466-36" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(number)) <span class="sc">%&gt;%</span> </span>
<span id="cb466-37"><a href="simulation-2.html#cb466-37" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>And plot it:</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="simulation-2.html#cb467-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb467-2"><a href="simulation-2.html#cb467-2" tabindex="-1"></a></span>
<span id="cb467-3"><a href="simulation-2.html#cb467-3" tabindex="-1"></a><span class="co"># plot a histogram of the means with density overlaid </span></span>
<span id="cb467-4"><a href="simulation-2.html#cb467-4" tabindex="-1"></a>df.plot <span class="ot">=</span> df.sampling_distribution_means</span>
<span id="cb467-5"><a href="simulation-2.html#cb467-5" tabindex="-1"></a></span>
<span id="cb467-6"><a href="simulation-2.html#cb467-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.plot,</span>
<span id="cb467-7"><a href="simulation-2.html#cb467-7" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mean)) <span class="sc">+</span> </span>
<span id="cb467-8"><a href="simulation-2.html#cb467-8" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stat</span>(density)),</span>
<span id="cb467-9"><a href="simulation-2.html#cb467-9" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.05</span>, </span>
<span id="cb467-10"><a href="simulation-2.html#cb467-10" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb467-11"><a href="simulation-2.html#cb467-11" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb467-12"><a href="simulation-2.html#cb467-12" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">bw =</span> <span class="fl">0.1</span>,</span>
<span id="cb467-13"><a href="simulation-2.html#cb467-13" tabindex="-1"></a>               <span class="at">linewidth =</span> <span class="dv">2</span>,</span>
<span id="cb467-14"><a href="simulation-2.html#cb467-14" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>) <span class="sc">+</span> </span>
<span id="cb467-15"><a href="simulation-2.html#cb467-15" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>)))</span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Even though our population distribution was far from normal (and much more heavy-metal like), the means of the sampling distribution are normally distributed.</p>
<p>And here are the mean and standard deviation of the sampling distribution:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="simulation-2.html#cb468-1" tabindex="-1"></a><span class="co"># print out sampling distribution mean and standard deviation </span></span>
<span id="cb468-2"><a href="simulation-2.html#cb468-2" tabindex="-1"></a>df.sampling_distribution_means <span class="sc">%&gt;%</span> </span>
<span id="cb468-3"><a href="simulation-2.html#cb468-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sampling_distribution_mean =</span> <span class="fu">mean</span>(mean),</span>
<span id="cb468-4"><a href="simulation-2.html#cb468-4" tabindex="-1"></a>            <span class="at">sampling_distribution_sd =</span> <span class="fu">sd</span>(mean)) <span class="sc">%&gt;%</span> </span>
<span id="cb468-5"><a href="simulation-2.html#cb468-5" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb468-6"><a href="simulation-2.html#cb468-6" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb468-7"><a href="simulation-2.html#cb468-7" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
sampling_distribution_mean
</th>
<th style="text-align:right;">
sampling_distribution_sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
</tbody>
</table>
<p>Here is a data frame that I’ve used for illustrating the idea behind how a sampling distribution is constructed from the population distribution.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="simulation-2.html#cb469-1" tabindex="-1"></a><span class="co"># data frame for illustration in class </span></span>
<span id="cb469-2"><a href="simulation-2.html#cb469-2" tabindex="-1"></a>df.sampling_distribution <span class="sc">%&gt;%</span> </span>
<span id="cb469-3"><a href="simulation-2.html#cb469-3" tabindex="-1"></a>  <span class="fu">filter</span>(sample <span class="sc">&lt;=</span> <span class="dv">10</span>, draw <span class="sc">&lt;=</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb469-4"><a href="simulation-2.html#cb469-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> draw,</span>
<span id="cb469-5"><a href="simulation-2.html#cb469-5" tabindex="-1"></a>              <span class="at">values_from =</span> number) <span class="sc">%&gt;%</span> </span>
<span id="cb469-6"><a href="simulation-2.html#cb469-6" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">c</span>(<span class="st">&quot;sample&quot;</span>, <span class="fu">str_c</span>(<span class="st">&quot;draw_&quot;</span>, <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(.) <span class="sc">-</span> <span class="dv">1</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb469-7"><a href="simulation-2.html#cb469-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_mean =</span> <span class="fu">rowMeans</span>(.[, <span class="sc">-</span><span class="dv">1</span>])) <span class="sc">%&gt;%</span> </span>
<span id="cb469-8"><a href="simulation-2.html#cb469-8" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb469-9"><a href="simulation-2.html#cb469-9" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb469-10"><a href="simulation-2.html#cb469-10" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb469-11"><a href="simulation-2.html#cb469-11" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
sample
</th>
<th style="text-align:right;">
draw_1
</th>
<th style="text-align:right;">
draw_2
</th>
<th style="text-align:right;">
draw_3
</th>
<th style="text-align:right;">
draw_4
</th>
<th style="text-align:right;">
sample_mean
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4.25
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4.50
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.00
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4.25
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3.50
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.25
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.00
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4.25
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4.25
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.75
</td>
</tr>
</tbody>
</table>
<div id="bootstrapping-a-sampling-distribution" class="section level4 hasAnchor" number="8.2.3.1">
<h4><span class="header-section-number">8.2.3.1</span> Bootstrapping a sampling distribution<a href="simulation-2.html#bootstrapping-a-sampling-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Of course, in actuality, we never have access to the population distribution. We try to infer characteristics of that distribution (e.g. its mean) from our sample. So using the population distribution to create a sampling distribution is sort of cheating – helpful cheating though since it gives us a sense for the relationship between population, sample, and sampling distribution.</p>
<p>It urns out that we can approximate the sampling distribution only using our actual sample. The idea is to take the sample that we drew, and generate new samples from it by drawing with replacement. Essentially, we are treating our original sample like the population from which we are generating random samples to derive the sampling distribution.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="simulation-2.html#cb470-1" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb470-2"><a href="simulation-2.html#cb470-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb470-3"><a href="simulation-2.html#cb470-3" tabindex="-1"></a></span>
<span id="cb470-4"><a href="simulation-2.html#cb470-4" tabindex="-1"></a><span class="co"># how many bootstrapped samples shall we draw? </span></span>
<span id="cb470-5"><a href="simulation-2.html#cb470-5" tabindex="-1"></a>n_samples <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb470-6"><a href="simulation-2.html#cb470-6" tabindex="-1"></a></span>
<span id="cb470-7"><a href="simulation-2.html#cb470-7" tabindex="-1"></a><span class="co"># generate a new sample from the original one by sampling with replacement</span></span>
<span id="cb470-8"><a href="simulation-2.html#cb470-8" tabindex="-1"></a>func.bootstrap <span class="ot">=</span> <span class="cf">function</span>(df){</span>
<span id="cb470-9"><a href="simulation-2.html#cb470-9" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb470-10"><a href="simulation-2.html#cb470-10" tabindex="-1"></a>    <span class="fu">sample_frac</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">replace =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb470-11"><a href="simulation-2.html#cb470-11" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(number)) <span class="sc">%&gt;%</span> </span>
<span id="cb470-12"><a href="simulation-2.html#cb470-12" tabindex="-1"></a>    <span class="fu">pull</span>(mean)</span>
<span id="cb470-13"><a href="simulation-2.html#cb470-13" tabindex="-1"></a>}</span>
<span id="cb470-14"><a href="simulation-2.html#cb470-14" tabindex="-1"></a></span>
<span id="cb470-15"><a href="simulation-2.html#cb470-15" tabindex="-1"></a><span class="co"># data frame with bootstrapped results </span></span>
<span id="cb470-16"><a href="simulation-2.html#cb470-16" tabindex="-1"></a>df.bootstrap <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">bootstrap =</span> <span class="dv">1</span><span class="sc">:</span>n_samples, </span>
<span id="cb470-17"><a href="simulation-2.html#cb470-17" tabindex="-1"></a>                      <span class="at">average =</span> <span class="fu">replicate</span>(<span class="at">n =</span> n_samples, <span class="fu">func.bootstrap</span>(df.sample)))</span></code></pre></div>
<p>Let’s plot our sample first:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="simulation-2.html#cb471-1" tabindex="-1"></a><span class="co"># plot the distribution </span></span>
<span id="cb471-2"><a href="simulation-2.html#cb471-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sample,</span>
<span id="cb471-3"><a href="simulation-2.html#cb471-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> number)) <span class="sc">+</span></span>
<span id="cb471-4"><a href="simulation-2.html#cb471-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;count&quot;</span>,</span>
<span id="cb471-5"><a href="simulation-2.html#cb471-5" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb471-6"><a href="simulation-2.html#cb471-6" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb471-7"><a href="simulation-2.html#cb471-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb471-8"><a href="simulation-2.html#cb471-8" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,</span>
<span id="cb471-9"><a href="simulation-2.html#cb471-9" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">6.9</span>)) <span class="sc">+</span></span>
<span id="cb471-10"><a href="simulation-2.html#cb471-10" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> F)</span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Let’s plot the bootstrapped sampling distribution:</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="simulation-2.html#cb472-1" tabindex="-1"></a><span class="co"># plot the bootstrapped sampling distribution</span></span>
<span id="cb472-2"><a href="simulation-2.html#cb472-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.bootstrap, </span>
<span id="cb472-3"><a href="simulation-2.html#cb472-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> average)) <span class="sc">+</span></span>
<span id="cb472-4"><a href="simulation-2.html#cb472-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stat</span>(density)),</span>
<span id="cb472-5"><a href="simulation-2.html#cb472-5" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb472-6"><a href="simulation-2.html#cb472-6" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb472-7"><a href="simulation-2.html#cb472-7" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.05</span>) <span class="sc">+</span> </span>
<span id="cb472-8"><a href="simulation-2.html#cb472-8" tabindex="-1"></a>  <span class="co"># stat_density(geom = &quot;line&quot;,</span></span>
<span id="cb472-9"><a href="simulation-2.html#cb472-9" tabindex="-1"></a>  <span class="co">#              size = 1.5,</span></span>
<span id="cb472-10"><a href="simulation-2.html#cb472-10" tabindex="-1"></a>  <span class="co">#              bw = 0.1,</span></span>
<span id="cb472-11"><a href="simulation-2.html#cb472-11" tabindex="-1"></a>  <span class="co">#              color = &quot;blue&quot;,</span></span>
<span id="cb472-12"><a href="simulation-2.html#cb472-12" tabindex="-1"></a>  <span class="co">#              linetype = 2) +</span></span>
<span id="cb472-13"><a href="simulation-2.html#cb472-13" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dnorm</span>(.,</span>
<span id="cb472-14"><a href="simulation-2.html#cb472-14" tabindex="-1"></a>                              <span class="at">mean =</span> <span class="fu">mean</span>(df.sample<span class="sc">$</span>number),</span>
<span id="cb472-15"><a href="simulation-2.html#cb472-15" tabindex="-1"></a>                              <span class="at">sd =</span> <span class="fu">sd</span>(df.sample<span class="sc">$</span>number <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(df.sample)))),</span>
<span id="cb472-16"><a href="simulation-2.html#cb472-16" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb472-17"><a href="simulation-2.html#cb472-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;mean&quot;</span>) <span class="sc">+</span></span>
<span id="cb472-18"><a href="simulation-2.html#cb472-18" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>)))</span></code></pre></div>
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>And let’s calculate the mean and standard deviation:</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="simulation-2.html#cb474-1" tabindex="-1"></a><span class="co"># print out sampling distribution mean and standard deviation </span></span>
<span id="cb474-2"><a href="simulation-2.html#cb474-2" tabindex="-1"></a>df.bootstrap <span class="sc">%&gt;%</span> </span>
<span id="cb474-3"><a href="simulation-2.html#cb474-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">bootstrapped_distribution_mean =</span> <span class="fu">mean</span>(average),</span>
<span id="cb474-4"><a href="simulation-2.html#cb474-4" tabindex="-1"></a>            <span class="at">bootstrapped_distribution_sd =</span> <span class="fu">sd</span>(average)) <span class="sc">%&gt;%</span> </span>
<span id="cb474-5"><a href="simulation-2.html#cb474-5" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb474-6"><a href="simulation-2.html#cb474-6" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb474-7"><a href="simulation-2.html#cb474-7" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
bootstrapped_distribution_mean
</th>
<th style="text-align:right;">
bootstrapped_distribution_sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
3.74
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
</tbody>
</table>
<p>Neat, as we can see, the mean and standard deviation of the bootstrapped sampling distribution are very close to the sampling distribution that we generated from the population distribution.</p>
</div>
</div>
</div>
<div id="understanding-p-values" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Understanding p-values<a href="simulation-2.html#understanding-p-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>The p-value is the probability of finding the observed, or more extreme, results when the null hypothesis (<span class="math inline">\(H_0\)</span>) is true.</p>
</blockquote>
<p><span class="math display">\[
\text{p-value = p(observed or more extreme test statistic} | H_{0}=\text{true})
\]</span>
What we are really interested in is the probability of a hypothesis given the data. However, frequentist statistics doesn’t give us this probability – we’ll get to Bayesian statistics later in the course.</p>
<p>Instead, we define a null hypothesis, construct a sampling distribution that tells us what we would expect the test statistic of interest to look like if the null hypothesis were true. We reject the null hypothesis in case our observed result would be unlikely if the null hypothesis were true.</p>
<p>An intutive way for illustrating (this rather unintuitive procedure) is the permutation test.</p>
<div id="permutation-test" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Permutation test<a href="simulation-2.html#permutation-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start by generating some random data from two different normal distributions (simulating a possible experiment).</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="simulation-2.html#cb475-1" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb475-2"><a href="simulation-2.html#cb475-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb475-3"><a href="simulation-2.html#cb475-3" tabindex="-1"></a></span>
<span id="cb475-4"><a href="simulation-2.html#cb475-4" tabindex="-1"></a><span class="co"># generate data from two conditions </span></span>
<span id="cb475-5"><a href="simulation-2.html#cb475-5" tabindex="-1"></a>df.permutation <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">control =</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="fl">5.5</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb475-6"><a href="simulation-2.html#cb475-6" tabindex="-1"></a>                        <span class="at">experimental =</span> <span class="fu">rnorm</span>(<span class="dv">25</span>, <span class="at">mean =</span> <span class="fl">4.5</span>, <span class="at">sd =</span> <span class="fl">1.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb475-7"><a href="simulation-2.html#cb475-7" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb475-8"><a href="simulation-2.html#cb475-8" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;condition&quot;</span>,</span>
<span id="cb475-9"><a href="simulation-2.html#cb475-9" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;performance&quot;</span>)</span></code></pre></div>
<p>Here is a summary of how each group performed:</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="simulation-2.html#cb476-1" tabindex="-1"></a>df.permutation <span class="sc">%&gt;%</span> </span>
<span id="cb476-2"><a href="simulation-2.html#cb476-2" tabindex="-1"></a>  <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span></span>
<span id="cb476-3"><a href="simulation-2.html#cb476-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(performance),</span>
<span id="cb476-4"><a href="simulation-2.html#cb476-4" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(performance)) <span class="sc">%&gt;%</span></span>
<span id="cb476-5"><a href="simulation-2.html#cb476-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span> condition,</span>
<span id="cb476-6"><a href="simulation-2.html#cb476-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;statistic&quot;</span>,</span>
<span id="cb476-7"><a href="simulation-2.html#cb476-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb476-8"><a href="simulation-2.html#cb476-8" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> condition,</span>
<span id="cb476-9"><a href="simulation-2.html#cb476-9" tabindex="-1"></a>              <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb476-10"><a href="simulation-2.html#cb476-10" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb476-11"><a href="simulation-2.html#cb476-11" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb476-12"><a href="simulation-2.html#cb476-12" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
statistic
</th>
<th style="text-align:right;">
control
</th>
<th style="text-align:right;">
experimental
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
mean
</td>
<td style="text-align:right;">
5.84
</td>
<td style="text-align:right;">
4.55
</td>
</tr>
<tr>
<td style="text-align:left;">
sd
</td>
<td style="text-align:right;">
1.90
</td>
<td style="text-align:right;">
1.06
</td>
</tr>
</tbody>
</table>
<p>Let’s plot the results:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="simulation-2.html#cb477-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.permutation, </span>
<span id="cb477-2"><a href="simulation-2.html#cb477-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition, <span class="at">y =</span> performance)) <span class="sc">+</span></span>
<span id="cb477-3"><a href="simulation-2.html#cb477-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.1</span>),</span>
<span id="cb477-4"><a href="simulation-2.html#cb477-4" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb477-5"><a href="simulation-2.html#cb477-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot, </span>
<span id="cb477-6"><a href="simulation-2.html#cb477-6" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;linerange&quot;</span>, </span>
<span id="cb477-7"><a href="simulation-2.html#cb477-7" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb477-8"><a href="simulation-2.html#cb477-8" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, </span>
<span id="cb477-9"><a href="simulation-2.html#cb477-9" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, </span>
<span id="cb477-10"><a href="simulation-2.html#cb477-10" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">21</span>, </span>
<span id="cb477-11"><a href="simulation-2.html#cb477-11" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb477-12"><a href="simulation-2.html#cb477-12" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb477-13"><a href="simulation-2.html#cb477-13" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb477-14"><a href="simulation-2.html#cb477-14" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb477-15"><a href="simulation-2.html#cb477-15" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb477-16"><a href="simulation-2.html#cb477-16" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>We are interested in the difference in the mean performance between the two groups:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="simulation-2.html#cb478-1" tabindex="-1"></a><span class="co"># calculate the difference between conditions</span></span>
<span id="cb478-2"><a href="simulation-2.html#cb478-2" tabindex="-1"></a>difference_actual <span class="ot">=</span> df.permutation <span class="sc">%&gt;%</span> </span>
<span id="cb478-3"><a href="simulation-2.html#cb478-3" tabindex="-1"></a>  <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span> </span>
<span id="cb478-4"><a href="simulation-2.html#cb478-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(performance)) <span class="sc">%&gt;%</span> </span>
<span id="cb478-5"><a href="simulation-2.html#cb478-5" tabindex="-1"></a>  <span class="fu">pull</span>(mean) <span class="sc">%&gt;%</span> </span>
<span id="cb478-6"><a href="simulation-2.html#cb478-6" tabindex="-1"></a>  <span class="fu">diff</span>()</span></code></pre></div>
<p>The difference in the mean rating between the control and experimental condition is -1.2889834. Is this difference between conditions statistically significant? What we are asking is: what are the chances that a result like this (or more extreme) could have come about due to chance?</p>
<p>Let’s answer the question using simulation. Here is the main idea: imagine that we were very sloppy in how we recorded the data, and now we don’t remember anymore which participants were in the controld condition and which ones were in experimental condition (we still remember though, that we tested 25 participants in each condition).</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="simulation-2.html#cb479-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb479-2"><a href="simulation-2.html#cb479-2" tabindex="-1"></a>df.permutation <span class="ot">=</span> df.permutation <span class="sc">%&gt;%</span> </span>
<span id="cb479-3"><a href="simulation-2.html#cb479-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">permutation =</span> <span class="fu">sample</span>(condition)) <span class="co">#randomly assign labels</span></span>
<span id="cb479-4"><a href="simulation-2.html#cb479-4" tabindex="-1"></a></span>
<span id="cb479-5"><a href="simulation-2.html#cb479-5" tabindex="-1"></a>df.permutation <span class="sc">%&gt;%</span> </span>
<span id="cb479-6"><a href="simulation-2.html#cb479-6" tabindex="-1"></a>  <span class="fu">group_by</span>(permutation) <span class="sc">%&gt;%</span> </span>
<span id="cb479-7"><a href="simulation-2.html#cb479-7" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(performance),</span>
<span id="cb479-8"><a href="simulation-2.html#cb479-8" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(performance)) <span class="sc">%&gt;%</span> </span>
<span id="cb479-9"><a href="simulation-2.html#cb479-9" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb479-10"><a href="simulation-2.html#cb479-10" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">diff =</span> <span class="fu">diff</span>(mean))</span></code></pre></div>
<pre><code># A tibble: 1 × 1
     diff
    &lt;dbl&gt;
1 -0.0105</code></pre>
<p>Here, the difference between the two conditions is 0.0105496.</p>
<p>After randomly shuffling the condition labels, this is how the results would look like:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="simulation-2.html#cb481-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.permutation, </span>
<span id="cb481-2"><a href="simulation-2.html#cb481-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> permutation, <span class="at">y =</span> performance))<span class="sc">+</span></span>
<span id="cb481-3"><a href="simulation-2.html#cb481-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> condition),</span>
<span id="cb481-4"><a href="simulation-2.html#cb481-4" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>,</span>
<span id="cb481-5"><a href="simulation-2.html#cb481-5" tabindex="-1"></a>                                        <span class="at">width =</span> <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb481-6"><a href="simulation-2.html#cb481-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_cl_boot,</span>
<span id="cb481-7"><a href="simulation-2.html#cb481-7" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;linerange&quot;</span>,</span>
<span id="cb481-8"><a href="simulation-2.html#cb481-8" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb481-9"><a href="simulation-2.html#cb481-9" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb481-10"><a href="simulation-2.html#cb481-10" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb481-11"><a href="simulation-2.html#cb481-11" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb481-12"><a href="simulation-2.html#cb481-12" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb481-13"><a href="simulation-2.html#cb481-13" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb481-14"><a href="simulation-2.html#cb481-14" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb481-15"><a href="simulation-2.html#cb481-15" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb481-16"><a href="simulation-2.html#cb481-16" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb481-17"><a href="simulation-2.html#cb481-17" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>The idea is now that, similar to bootstrapping above, we can get a sampling distribution of the difference in the means between the two conditions (assuming that the null hypothesis were true), by randomly shuffling the labels and calculating the difference in means (and doing this many times). What we get is a distribution of the differences we would expect, if there was no effect of condition.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="simulation-2.html#cb482-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb482-2"><a href="simulation-2.html#cb482-2" tabindex="-1"></a></span>
<span id="cb482-3"><a href="simulation-2.html#cb482-3" tabindex="-1"></a>n_permutations <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb482-4"><a href="simulation-2.html#cb482-4" tabindex="-1"></a></span>
<span id="cb482-5"><a href="simulation-2.html#cb482-5" tabindex="-1"></a><span class="co"># permutation function</span></span>
<span id="cb482-6"><a href="simulation-2.html#cb482-6" tabindex="-1"></a>fun.permutations <span class="ot">=</span> <span class="cf">function</span>(df){</span>
<span id="cb482-7"><a href="simulation-2.html#cb482-7" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb482-8"><a href="simulation-2.html#cb482-8" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">condition =</span> <span class="fu">sample</span>(condition)) <span class="sc">%&gt;%</span> <span class="co">#we randomly shuffle the condition labels</span></span>
<span id="cb482-9"><a href="simulation-2.html#cb482-9" tabindex="-1"></a>    <span class="fu">group_by</span>(condition) <span class="sc">%&gt;%</span></span>
<span id="cb482-10"><a href="simulation-2.html#cb482-10" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(performance)) <span class="sc">%&gt;%</span></span>
<span id="cb482-11"><a href="simulation-2.html#cb482-11" tabindex="-1"></a>    <span class="fu">pull</span>(mean) <span class="sc">%&gt;%</span></span>
<span id="cb482-12"><a href="simulation-2.html#cb482-12" tabindex="-1"></a>    <span class="fu">diff</span>()</span>
<span id="cb482-13"><a href="simulation-2.html#cb482-13" tabindex="-1"></a>}</span>
<span id="cb482-14"><a href="simulation-2.html#cb482-14" tabindex="-1"></a></span>
<span id="cb482-15"><a href="simulation-2.html#cb482-15" tabindex="-1"></a><span class="co"># data frame with permutation results </span></span>
<span id="cb482-16"><a href="simulation-2.html#cb482-16" tabindex="-1"></a>df.permutations <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">permutation =</span> <span class="dv">1</span><span class="sc">:</span>n_permutations, </span>
<span id="cb482-17"><a href="simulation-2.html#cb482-17" tabindex="-1"></a>  <span class="at">mean_difference =</span> <span class="fu">replicate</span>(<span class="at">n =</span> n_permutations, <span class="fu">fun.permutations</span>(df.permutation)))</span>
<span id="cb482-18"><a href="simulation-2.html#cb482-18" tabindex="-1"></a></span>
<span id="cb482-19"><a href="simulation-2.html#cb482-19" tabindex="-1"></a><span class="co">#plot the distribution of the differences </span></span>
<span id="cb482-20"><a href="simulation-2.html#cb482-20" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.permutations, <span class="fu">aes</span>(<span class="at">x =</span> mean_difference)) <span class="sc">+</span></span>
<span id="cb482-21"><a href="simulation-2.html#cb482-21" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stat</span>(density)),</span>
<span id="cb482-22"><a href="simulation-2.html#cb482-22" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb482-23"><a href="simulation-2.html#cb482-23" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb482-24"><a href="simulation-2.html#cb482-24" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="fl">0.05</span>) <span class="sc">+</span> </span>
<span id="cb482-25"><a href="simulation-2.html#cb482-25" tabindex="-1"></a>  <span class="fu">stat_density</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb482-26"><a href="simulation-2.html#cb482-26" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">1.5</span>,</span>
<span id="cb482-27"><a href="simulation-2.html#cb482-27" tabindex="-1"></a>               <span class="at">bw =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb482-28"><a href="simulation-2.html#cb482-28" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> difference_actual, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb482-29"><a href="simulation-2.html#cb482-29" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;difference between means&quot;</span>) <span class="sc">+</span></span>
<span id="cb482-30"><a href="simulation-2.html#cb482-30" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb482-31"><a href="simulation-2.html#cb482-31" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb482-32"><a href="simulation-2.html#cb482-32" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb482-33"><a href="simulation-2.html#cb482-33" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> F, <span class="at">clip =</span> <span class="st">&quot;off&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale
range (`geom_bar()`).</code></pre>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>And we can then simply calculate the p-value by using some basic data wrangling (i.e. finding the proportion of differences that were as or more extreme than the one we observed).</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="simulation-2.html#cb484-1" tabindex="-1"></a><span class="co">#calculate p-value of our observed result</span></span>
<span id="cb484-2"><a href="simulation-2.html#cb484-2" tabindex="-1"></a>df.permutations <span class="sc">%&gt;%</span> </span>
<span id="cb484-3"><a href="simulation-2.html#cb484-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p_value =</span> <span class="fu">sum</span>(mean_difference <span class="sc">&lt;=</span> difference_actual)<span class="sc">/</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1   0.002</code></pre>
</div>
<div id="t-test-by-hand" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> t-test by hand<a href="simulation-2.html#t-test-by-hand" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Examining the t-distribution.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="simulation-2.html#cb486-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb486-2"><a href="simulation-2.html#cb486-2" tabindex="-1"></a></span>
<span id="cb486-3"><a href="simulation-2.html#cb486-3" tabindex="-1"></a>n_simulations <span class="ot">=</span> <span class="dv">1000</span> </span>
<span id="cb486-4"><a href="simulation-2.html#cb486-4" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb486-5"><a href="simulation-2.html#cb486-5" tabindex="-1"></a>mean <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb486-6"><a href="simulation-2.html#cb486-6" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb486-7"><a href="simulation-2.html#cb486-7" tabindex="-1"></a></span>
<span id="cb486-8"><a href="simulation-2.html#cb486-8" tabindex="-1"></a>fun.normal_sample_mean <span class="ot">=</span> <span class="cf">function</span>(sample_size, mean, sd){</span>
<span id="cb486-9"><a href="simulation-2.html#cb486-9" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="at">n =</span> sample_size, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd) <span class="sc">%&gt;%</span> </span>
<span id="cb486-10"><a href="simulation-2.html#cb486-10" tabindex="-1"></a>    <span class="fu">mean</span>()</span>
<span id="cb486-11"><a href="simulation-2.html#cb486-11" tabindex="-1"></a>}</span>
<span id="cb486-12"><a href="simulation-2.html#cb486-12" tabindex="-1"></a></span>
<span id="cb486-13"><a href="simulation-2.html#cb486-13" tabindex="-1"></a>df.ttest <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">simulation =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations) <span class="sc">%&gt;%</span> </span>
<span id="cb486-14"><a href="simulation-2.html#cb486-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample1 =</span> <span class="fu">replicate</span>(<span class="at">n =</span> n_simulations,</span>
<span id="cb486-15"><a href="simulation-2.html#cb486-15" tabindex="-1"></a>                             <span class="at">expr =</span> <span class="fu">fun.normal_sample_mean</span>(sample_size, mean, sd)),</span>
<span id="cb486-16"><a href="simulation-2.html#cb486-16" tabindex="-1"></a>         <span class="at">sample2 =</span> <span class="fu">replicate</span>(<span class="at">n =</span> n_simulations, </span>
<span id="cb486-17"><a href="simulation-2.html#cb486-17" tabindex="-1"></a>                             <span class="at">expr =</span> <span class="fu">fun.normal_sample_mean</span>(sample_size, mean, sd))) <span class="sc">%&gt;%</span> </span>
<span id="cb486-18"><a href="simulation-2.html#cb486-18" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">difference =</span> sample1 <span class="sc">-</span> sample2,</span>
<span id="cb486-19"><a href="simulation-2.html#cb486-19" tabindex="-1"></a>         <span class="co"># assuming the same standard deviation in each sample</span></span>
<span id="cb486-20"><a href="simulation-2.html#cb486-20" tabindex="-1"></a>         <span class="at">tstatistic =</span> difference <span class="sc">/</span> <span class="fu">sqrt</span>(sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>sample_size <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>sample_size)))</span>
<span id="cb486-21"><a href="simulation-2.html#cb486-21" tabindex="-1"></a></span>
<span id="cb486-22"><a href="simulation-2.html#cb486-22" tabindex="-1"></a>df.ttest</span></code></pre></div>
<pre><code># A tibble: 1,000 × 5
   simulation sample1 sample2 difference tstatistic
        &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
 1          1    5.22    4.99     0.225      0.796 
 2          2    4.92    5.06    -0.132     -0.467 
 3          3    5.06    5.40    -0.340     -1.20  
 4          4    5.10    4.97     0.132      0.468 
 5          5    4.92    4.75     0.173      0.613 
 6          6    4.91    4.99    -0.0787    -0.278 
 7          7    4.60    5.11    -0.513     -1.82  
 8          8    5.00    5.01    -0.0113    -0.0401
 9          9    5.02    5.10    -0.0773    -0.273 
10         10    5.01    4.98     0.0267     0.0945
# ℹ 990 more rows</code></pre>
<p>Population distribution</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="simulation-2.html#cb488-1" tabindex="-1"></a>mean <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb488-2"><a href="simulation-2.html#cb488-2" tabindex="-1"></a>sd <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb488-3"><a href="simulation-2.html#cb488-3" tabindex="-1"></a></span>
<span id="cb488-4"><a href="simulation-2.html#cb488-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(mean <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> sd, mean <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> sd)),</span>
<span id="cb488-5"><a href="simulation-2.html#cb488-5" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb488-6"><a href="simulation-2.html#cb488-6" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dnorm</span>(.,<span class="at">mean =</span> mean, <span class="at">sd =</span> sd),</span>
<span id="cb488-7"><a href="simulation-2.html#cb488-7" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb488-8"><a href="simulation-2.html#cb488-8" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb488-9"><a href="simulation-2.html#cb488-9" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> mean, <span class="at">sd =</span> sd),</span>
<span id="cb488-10"><a href="simulation-2.html#cb488-10" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>)</span>
<span id="cb488-11"><a href="simulation-2.html#cb488-11" tabindex="-1"></a>  <span class="co"># labs(x = &quot;performance&quot;)</span></span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Distribution of differences in means</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="simulation-2.html#cb489-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.ttest,</span>
<span id="cb489-2"><a href="simulation-2.html#cb489-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> difference)) <span class="sc">+</span> </span>
<span id="cb489-3"><a href="simulation-2.html#cb489-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb489-4"><a href="simulation-2.html#cb489-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(df.ttest<span class="sc">$</span>difference,</span>
<span id="cb489-5"><a href="simulation-2.html#cb489-5" tabindex="-1"></a>                                   <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)),</span>
<span id="cb489-6"><a href="simulation-2.html#cb489-6" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>t-distribution</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="simulation-2.html#cb490-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.ttest,</span>
<span id="cb490-2"><a href="simulation-2.html#cb490-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> tstatistic)) <span class="sc">+</span> </span>
<span id="cb490-3"><a href="simulation-2.html#cb490-3" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="sc">~</span> <span class="fu">dt</span>(., <span class="at">df =</span> sample_size <span class="sc">*</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span>),</span>
<span id="cb490-4"><a href="simulation-2.html#cb490-4" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb490-5"><a href="simulation-2.html#cb490-5" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb490-6"><a href="simulation-2.html#cb490-6" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb490-7"><a href="simulation-2.html#cb490-7" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df =</span> sample_size <span class="sc">*</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span>),</span>
<span id="cb490-8"><a href="simulation-2.html#cb490-8" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb490-9"><a href="simulation-2.html#cb490-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb490-10"><a href="simulation-2.html#cb490-10" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
</div>
<div id="confidence-intervals" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Confidence intervals<a href="simulation-2.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The definition of the confidence interval is the following:</p>
<blockquote>
<p>“If we were to repeat the experiment over and over, then 95% of the time the confidence intervals contain the true mean.”</p>
</blockquote>
<p>If we assume normally distributed data (and a large enough sample size), then we can calculate the confidence interval on the estimate of the mean in the following way: <span class="math inline">\(\overline X \pm Z \frac{s}{\sqrt{n}}\)</span>, where <span class="math inline">\(Z\)</span> equals the value of the standard normal distribution for the desired level of confidence.</p>
<p>For smaller sample sizes, we can use the <span class="math inline">\(t\)</span>-distribution instead with <span class="math inline">\(n-1\)</span> degrees of freedom. For larger <span class="math inline">\(n\)</span> the <span class="math inline">\(t\)</span>-distribution closely approximates the normal distribution.</p>
<p>So let’s run a a simulation to check whether the definition of the confidence interval seems right. We will use our heavy metal distribution from above, take samples from the distribution, calculate the mean and confidence interval, and check how often the true mean of the population (<span class="math inline">\(M = 3.5\)</span>) is contained within the confidence interval.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="simulation-2.html#cb491-1" tabindex="-1"></a><span class="co"># make example reproducible </span></span>
<span id="cb491-2"><a href="simulation-2.html#cb491-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb491-3"><a href="simulation-2.html#cb491-3" tabindex="-1"></a></span>
<span id="cb491-4"><a href="simulation-2.html#cb491-4" tabindex="-1"></a><span class="co"># parameters </span></span>
<span id="cb491-5"><a href="simulation-2.html#cb491-5" tabindex="-1"></a>sample_size <span class="ot">=</span> <span class="dv">25</span> <span class="co"># size of each sample</span></span>
<span id="cb491-6"><a href="simulation-2.html#cb491-6" tabindex="-1"></a>sample_n <span class="ot">=</span> <span class="dv">20</span> <span class="co"># number of samples </span></span>
<span id="cb491-7"><a href="simulation-2.html#cb491-7" tabindex="-1"></a>confidence_level <span class="ot">=</span> <span class="fl">0.95</span> <span class="co"># desired level of confidence </span></span>
<span id="cb491-8"><a href="simulation-2.html#cb491-8" tabindex="-1"></a></span>
<span id="cb491-9"><a href="simulation-2.html#cb491-9" tabindex="-1"></a><span class="co"># define a function that draws samples and calculates means and CIs</span></span>
<span id="cb491-10"><a href="simulation-2.html#cb491-10" tabindex="-1"></a>fun.confidence <span class="ot">=</span> <span class="cf">function</span>(sample_size, distribution){</span>
<span id="cb491-11"><a href="simulation-2.html#cb491-11" tabindex="-1"></a>  df <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">values =</span> <span class="fu">sample</span>(distribution<span class="sc">$</span>numbers,</span>
<span id="cb491-12"><a href="simulation-2.html#cb491-12" tabindex="-1"></a>                              <span class="at">size =</span> sample_size,</span>
<span id="cb491-13"><a href="simulation-2.html#cb491-13" tabindex="-1"></a>                              <span class="at">replace =</span> T,</span>
<span id="cb491-14"><a href="simulation-2.html#cb491-14" tabindex="-1"></a>                              <span class="at">prob =</span> distribution<span class="sc">$</span>probability)) <span class="sc">%&gt;%</span> </span>
<span id="cb491-15"><a href="simulation-2.html#cb491-15" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(values),</span>
<span id="cb491-16"><a href="simulation-2.html#cb491-16" tabindex="-1"></a>              <span class="at">sd =</span> <span class="fu">sd</span>(values),</span>
<span id="cb491-17"><a href="simulation-2.html#cb491-17" tabindex="-1"></a>              <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb491-18"><a href="simulation-2.html#cb491-18" tabindex="-1"></a>              <span class="co"># confidence interval assuming a normal distribution </span></span>
<span id="cb491-19"><a href="simulation-2.html#cb491-19" tabindex="-1"></a>              <span class="co"># error = qnorm(1 - (1 - confidence_level)/2) * sd / sqrt(n),</span></span>
<span id="cb491-20"><a href="simulation-2.html#cb491-20" tabindex="-1"></a>              <span class="co"># assuming a t-distribution (more conservative, appropriate for smaller</span></span>
<span id="cb491-21"><a href="simulation-2.html#cb491-21" tabindex="-1"></a>              <span class="co"># sample sizes)</span></span>
<span id="cb491-22"><a href="simulation-2.html#cb491-22" tabindex="-1"></a>              <span class="at">error =</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> confidence_level)<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> sd <span class="sc">/</span> <span class="fu">sqrt</span>(n),</span>
<span id="cb491-23"><a href="simulation-2.html#cb491-23" tabindex="-1"></a>              <span class="at">conf_low =</span> mean <span class="sc">-</span> error,</span>
<span id="cb491-24"><a href="simulation-2.html#cb491-24" tabindex="-1"></a>              <span class="at">conf_high =</span> mean <span class="sc">+</span> error)</span>
<span id="cb491-25"><a href="simulation-2.html#cb491-25" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb491-26"><a href="simulation-2.html#cb491-26" tabindex="-1"></a>}</span>
<span id="cb491-27"><a href="simulation-2.html#cb491-27" tabindex="-1"></a></span>
<span id="cb491-28"><a href="simulation-2.html#cb491-28" tabindex="-1"></a><span class="co"># build data frame of confidence intervals </span></span>
<span id="cb491-29"><a href="simulation-2.html#cb491-29" tabindex="-1"></a>df.confidence <span class="ot">=</span> <span class="fu">tibble</span>()</span>
<span id="cb491-30"><a href="simulation-2.html#cb491-30" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>sample_n){</span>
<span id="cb491-31"><a href="simulation-2.html#cb491-31" tabindex="-1"></a>  df.tmp <span class="ot">=</span> <span class="fu">fun.confidence</span>(sample_size, df.population)</span>
<span id="cb491-32"><a href="simulation-2.html#cb491-32" tabindex="-1"></a>  df.confidence <span class="ot">=</span> df.confidence <span class="sc">%&gt;%</span> </span>
<span id="cb491-33"><a href="simulation-2.html#cb491-33" tabindex="-1"></a>    <span class="fu">bind_rows</span>(df.tmp)</span>
<span id="cb491-34"><a href="simulation-2.html#cb491-34" tabindex="-1"></a>}</span>
<span id="cb491-35"><a href="simulation-2.html#cb491-35" tabindex="-1"></a></span>
<span id="cb491-36"><a href="simulation-2.html#cb491-36" tabindex="-1"></a><span class="co"># code which CIs contain the true value, and which ones don&#39;t </span></span>
<span id="cb491-37"><a href="simulation-2.html#cb491-37" tabindex="-1"></a>population_mean <span class="ot">=</span> <span class="fl">3.5</span></span>
<span id="cb491-38"><a href="simulation-2.html#cb491-38" tabindex="-1"></a>df.confidence <span class="ot">=</span> df.confidence <span class="sc">%&gt;%</span> </span>
<span id="cb491-39"><a href="simulation-2.html#cb491-39" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb491-40"><a href="simulation-2.html#cb491-40" tabindex="-1"></a>         <span class="at">conf_index =</span> <span class="fu">ifelse</span>(conf_low <span class="sc">&gt;</span> population_mean <span class="sc">|</span> conf_high <span class="sc">&lt;</span> population_mean,</span>
<span id="cb491-41"><a href="simulation-2.html#cb491-41" tabindex="-1"></a>                             <span class="st">&#39;outside&#39;</span>,</span>
<span id="cb491-42"><a href="simulation-2.html#cb491-42" tabindex="-1"></a>                             <span class="st">&#39;inside&#39;</span>))</span>
<span id="cb491-43"><a href="simulation-2.html#cb491-43" tabindex="-1"></a></span>
<span id="cb491-44"><a href="simulation-2.html#cb491-44" tabindex="-1"></a><span class="co"># plot the result</span></span>
<span id="cb491-45"><a href="simulation-2.html#cb491-45" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.confidence, <span class="fu">aes</span>(<span class="at">x =</span> sample,</span>
<span id="cb491-46"><a href="simulation-2.html#cb491-46" tabindex="-1"></a>                                 <span class="at">y =</span> mean,</span>
<span id="cb491-47"><a href="simulation-2.html#cb491-47" tabindex="-1"></a>                                 <span class="at">color =</span> conf_index)) <span class="sc">+</span></span>
<span id="cb491-48"><a href="simulation-2.html#cb491-48" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">3.5</span>,</span>
<span id="cb491-49"><a href="simulation-2.html#cb491-49" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb491-50"><a href="simulation-2.html#cb491-50" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb491-51"><a href="simulation-2.html#cb491-51" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> conf_low,</span>
<span id="cb491-52"><a href="simulation-2.html#cb491-52" tabindex="-1"></a>                     <span class="at">ymax =</span> conf_high)) <span class="sc">+</span></span>
<span id="cb491-53"><a href="simulation-2.html#cb491-53" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb491-54"><a href="simulation-2.html#cb491-54" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb491-55"><a href="simulation-2.html#cb491-55" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;inside&quot;</span>, <span class="st">&quot;outside&quot;</span>)) <span class="sc">+</span></span>
<span id="cb491-56"><a href="simulation-2.html#cb491-56" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb491-57"><a href="simulation-2.html#cb491-57" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>So, out of the 20 samples that we drew the 95% confidence interval of 1 sample did not contain the true mean. That makes sense!</p>
<p>Feel free to play around with the code above. For example, change the sample size, the number of samples, the confidence level.</p>
<div id="mean_cl_boot-explained" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> <code>mean_cl_boot()</code> explained<a href="simulation-2.html#mean_cl_boot-explained" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="simulation-2.html#cb492-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb492-2"><a href="simulation-2.html#cb492-2" tabindex="-1"></a></span>
<span id="cb492-3"><a href="simulation-2.html#cb492-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span> <span class="co"># sample size per group</span></span>
<span id="cb492-4"><a href="simulation-2.html#cb492-4" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">3</span> <span class="co"># number of groups </span></span>
<span id="cb492-5"><a href="simulation-2.html#cb492-5" tabindex="-1"></a></span>
<span id="cb492-6"><a href="simulation-2.html#cb492-6" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="sc">*</span>k),</span>
<span id="cb492-7"><a href="simulation-2.html#cb492-7" tabindex="-1"></a>                 <span class="at">condition =</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">each =</span> n)),</span>
<span id="cb492-8"><a href="simulation-2.html#cb492-8" tabindex="-1"></a>                 <span class="at">rating =</span> <span class="fu">rnorm</span>(n<span class="sc">*</span>k, <span class="at">mean =</span> <span class="dv">7</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb492-9"><a href="simulation-2.html#cb492-9" tabindex="-1"></a></span>
<span id="cb492-10"><a href="simulation-2.html#cb492-10" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.data,</span>
<span id="cb492-11"><a href="simulation-2.html#cb492-11" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> condition,</span>
<span id="cb492-12"><a href="simulation-2.html#cb492-12" tabindex="-1"></a>                     <span class="at">y =</span> rating)) <span class="sc">+</span> </span>
<span id="cb492-13"><a href="simulation-2.html#cb492-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>,</span>
<span id="cb492-14"><a href="simulation-2.html#cb492-14" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">height =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb492-15"><a href="simulation-2.html#cb492-15" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb492-16"><a href="simulation-2.html#cb492-16" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">21</span>, </span>
<span id="cb492-17"><a href="simulation-2.html#cb492-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb492-18"><a href="simulation-2.html#cb492-18" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb492-19"><a href="simulation-2.html#cb492-19" tabindex="-1"></a></span>
<span id="cb492-20"><a href="simulation-2.html#cb492-20" tabindex="-1"></a><span class="fu">print</span>(p)</span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<p>Peeking behind the scenes</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="simulation-2.html#cb493-1" tabindex="-1"></a>build <span class="ot">=</span> <span class="fu">ggplot_build</span>(p)</span>
<span id="cb493-2"><a href="simulation-2.html#cb493-2" tabindex="-1"></a></span>
<span id="cb493-3"><a href="simulation-2.html#cb493-3" tabindex="-1"></a>build<span class="sc">$</span>data[[<span class="dv">2</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb493-4"><a href="simulation-2.html#cb493-4" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb493-5"><a href="simulation-2.html#cb493-5" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>,</span>
<span id="cb493-6"><a href="simulation-2.html#cb493-6" tabindex="-1"></a>                <span class="at">full_width =</span> F)</span></code></pre></div>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
x
</th>
<th style="text-align:right;">
group
</th>
<th style="text-align:right;">
y
</th>
<th style="text-align:right;">
ymin
</th>
<th style="text-align:right;">
ymax
</th>
<th style="text-align:left;">
PANEL
</th>
<th style="text-align:left;">
flipped_aes
</th>
<th style="text-align:left;">
colour
</th>
<th style="text-align:right;">
size
</th>
<th style="text-align:right;">
linewidth
</th>
<th style="text-align:right;">
linetype
</th>
<th style="text-align:right;">
shape
</th>
<th style="text-align:left;">
fill
</th>
<th style="text-align:left;">
alpha
</th>
<th style="text-align:right;">
stroke
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7.13
</td>
<td style="text-align:right;">
6.69
</td>
<td style="text-align:right;">
7.62
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
black
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
lightblue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7.25
</td>
<td style="text-align:right;">
6.56
</td>
<td style="text-align:right;">
7.82
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
black
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
lightblue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6.87
</td>
<td style="text-align:right;">
6.28
</td>
<td style="text-align:right;">
7.41
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
FALSE
</td>
<td style="text-align:left;">
black
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
lightblue
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>Let’s focus on condition 1</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="simulation-2.html#cb494-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb494-2"><a href="simulation-2.html#cb494-2" tabindex="-1"></a></span>
<span id="cb494-3"><a href="simulation-2.html#cb494-3" tabindex="-1"></a>df.condition1 <span class="ot">=</span> df.data <span class="sc">%&gt;%</span> </span>
<span id="cb494-4"><a href="simulation-2.html#cb494-4" tabindex="-1"></a>  <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb494-5"><a href="simulation-2.html#cb494-5" tabindex="-1"></a></span>
<span id="cb494-6"><a href="simulation-2.html#cb494-6" tabindex="-1"></a>fun.sample_with_replacement <span class="ot">=</span> <span class="cf">function</span>(df){</span>
<span id="cb494-7"><a href="simulation-2.html#cb494-7" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb494-8"><a href="simulation-2.html#cb494-8" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fu">nrow</span>(df),</span>
<span id="cb494-9"><a href="simulation-2.html#cb494-9" tabindex="-1"></a>                 <span class="at">replace =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb494-10"><a href="simulation-2.html#cb494-10" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(rating)) <span class="sc">%&gt;%</span> </span>
<span id="cb494-11"><a href="simulation-2.html#cb494-11" tabindex="-1"></a>    <span class="fu">pull</span>(mean)</span>
<span id="cb494-12"><a href="simulation-2.html#cb494-12" tabindex="-1"></a>}</span>
<span id="cb494-13"><a href="simulation-2.html#cb494-13" tabindex="-1"></a></span>
<span id="cb494-14"><a href="simulation-2.html#cb494-14" tabindex="-1"></a>bootstraps <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="fu">fun.sample_with_replacement</span>(df.condition1))</span>
<span id="cb494-15"><a href="simulation-2.html#cb494-15" tabindex="-1"></a></span>
<span id="cb494-16"><a href="simulation-2.html#cb494-16" tabindex="-1"></a><span class="fu">quantile</span>(bootstraps, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>    2.5%    97.5% 
6.671962 7.583905 </code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="simulation-2.html#cb496-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">as_tibble</span>(bootstraps),</span>
<span id="cb496-2"><a href="simulation-2.html#cb496-2" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span> </span>
<span id="cb496-3"><a href="simulation-2.html#cb496-3" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb496-4"><a href="simulation-2.html#cb496-4" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(bootstraps,</span>
<span id="cb496-5"><a href="simulation-2.html#cb496-5" tabindex="-1"></a>                                   <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)),</span>
<span id="cb496-6"><a href="simulation-2.html#cb496-6" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>) </span></code></pre></div>
<p><img src="08-simulation2_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
</div>
</div>
<div id="additional-resources-6" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Additional resources<a href="simulation-2.html#additional-resources-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="misc-3" class="section level3 hasAnchor" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Misc<a href="simulation-2.html#misc-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://www.jwilber.me/permutationtest/?s=09">Nice illustration of the permutation test</a></li>
<li><a href="https://www.the100.ci/2024/12/05/why-you-are-not-allowed-to-say-that-your-95-confidence-interval-contains-the-true-parameter-with-a-probability-of-95/">Good article on interpretation of confidence intervals</a></li>
</ul>
</div>
<div id="datacamp-1" class="section level3 hasAnchor" number="8.5.2">
<h3><span class="header-section-number">8.5.2</span> Datacamp<a href="simulation-2.html#datacamp-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://www.datacamp.com/courses/foundations-of-inference">Foundations of Inference</a></li>
</ul>
</div>
</div>
<div id="session-info-7" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Session info<a href="simulation-2.html#session-info-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="simulation-2.html#cb497-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.4.2 (2024-10-31)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.2

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Los_Angeles
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] lubridate_1.9.3  forcats_1.0.0    stringr_1.5.1    dplyr_1.1.4     
 [5] purrr_1.0.2      readr_2.1.5      tidyr_1.3.1      tibble_3.2.1    
 [9] ggplot2_3.5.1    tidyverse_2.0.0  janitor_2.2.1    kableExtra_1.4.0
[13] knitr_1.49      

loaded via a namespace (and not attached):
 [1] gtable_0.3.5      xfun_0.49         bslib_0.7.0       htmlwidgets_1.6.4
 [5] tzdb_0.4.0        vctrs_0.6.5       tools_4.4.2       generics_0.1.3   
 [9] fansi_1.0.6       cluster_2.1.6     pkgconfig_2.0.3   data.table_1.15.4
[13] checkmate_2.3.1   lifecycle_1.0.4   compiler_4.4.2    farver_2.1.2     
[17] munsell_0.5.1     snakecase_0.11.1  htmltools_0.5.8.1 sass_0.4.9       
[21] yaml_2.3.10       htmlTable_2.4.2   Formula_1.2-5     pillar_1.9.0     
[25] crayon_1.5.3      jquerylib_0.1.4   cachem_1.1.0      Hmisc_5.2-1      
[29] rpart_4.1.23      tidyselect_1.2.1  digest_0.6.36     stringi_1.8.4    
[33] bookdown_0.42     labeling_0.4.3    fastmap_1.2.0     grid_4.4.2       
[37] colorspace_2.1-0  cli_3.6.3         magrittr_2.0.3    base64enc_0.1-3  
[41] utf8_1.2.4        foreign_0.8-87    withr_3.0.2       scales_1.3.0     
[45] backports_1.5.0   timechange_0.3.0  rmarkdown_2.29    nnet_7.3-19      
[49] gridExtra_2.3     hms_1.1.3         evaluate_0.24.0   viridisLite_0.4.2
[53] rlang_1.1.4       glue_1.8.0        xml2_1.3.6        svglite_2.1.3    
[57] rstudioapi_0.16.0 jsonlite_1.8.8    R6_2.5.1          systemfonts_1.1.0</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulation-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/08-simulation2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
