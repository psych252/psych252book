<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 23 Bayesian data analysis 2 | Psych 252: Statistical Methods for Behavioral and Social Sciences</title>
  <meta name="description" content="Course notes for Psych 252." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 23 Bayesian data analysis 2 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course notes for Psych 252." />
  <meta name="github-repo" content="psych252/psych252book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 23 Bayesian data analysis 2 | Psych 252: Statistical Methods for Behavioral and Social Sciences" />
  
  <meta name="twitter:description" content="Course notes for Psych 252." />
  

<meta name="author" content="Tobias Gerstenberg" />


<meta name="date" content="2022-05-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-data-analysis.html"/>
<link rel="next" href="bayesian-data-analysis-3.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.22/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.9/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Psych 252</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-description"><i class="fa fa-check"></i>Course description</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-homepage"><i class="fa fa-check"></i>Course homepage</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#thanks"><i class="fa fa-check"></i><b>1.1</b> Thanks</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#list-of-r-packages-used-in-this-book"><i class="fa fa-check"></i><b>1.2</b> List of R packages used in this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>1.3</b> Installing packages</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#session-info"><i class="fa fa-check"></i><b>1.4</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization-1.html"><a href="visualization-1.html"><i class="fa fa-check"></i><b>2</b> Visualization 1</a>
<ul>
<li class="chapter" data-level="2.1" data-path="visualization-1.html"><a href="visualization-1.html#learning-goals"><i class="fa fa-check"></i><b>2.1</b> Learning goals</a></li>
<li class="chapter" data-level="2.2" data-path="visualization-1.html"><a href="visualization-1.html#load-packages"><i class="fa fa-check"></i><b>2.2</b> Load packages</a></li>
<li class="chapter" data-level="2.3" data-path="visualization-1.html"><a href="visualization-1.html#why-visualize-data"><i class="fa fa-check"></i><b>2.3</b> Why visualize data?</a></li>
<li class="chapter" data-level="2.4" data-path="visualization-1.html"><a href="visualization-1.html#some-basics"><i class="fa fa-check"></i><b>2.4</b> Some basics</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-rstudio"><i class="fa fa-check"></i><b>2.4.1</b> Setting up RStudio</a></li>
<li class="chapter" data-level="2.4.2" data-path="visualization-1.html"><a href="visualization-1.html#getting-help"><i class="fa fa-check"></i><b>2.4.2</b> Getting help</a></li>
<li class="chapter" data-level="2.4.3" data-path="visualization-1.html"><a href="visualization-1.html#r-markdown-infos"><i class="fa fa-check"></i><b>2.4.3</b> R Markdown infos</a></li>
<li class="chapter" data-level="2.4.4" data-path="visualization-1.html"><a href="visualization-1.html#helpful-keyboard-shortcuts"><i class="fa fa-check"></i><b>2.4.4</b> Helpful keyboard shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="visualization-1.html"><a href="visualization-1.html#data-visualization"><i class="fa fa-check"></i><b>2.5</b> Data visualization</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="visualization-1.html"><a href="visualization-1.html#setting-up-a-plot"><i class="fa fa-check"></i><b>2.5.1</b> Setting up a plot</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization-1.html"><a href="visualization-1.html#bar-plot"><i class="fa fa-check"></i><b>2.5.2</b> Bar plot</a></li>
<li class="chapter" data-level="2.5.3" data-path="visualization-1.html"><a href="visualization-1.html#setting-the-default-plot-theme"><i class="fa fa-check"></i><b>2.5.3</b> Setting the default plot theme</a></li>
<li class="chapter" data-level="2.5.4" data-path="visualization-1.html"><a href="visualization-1.html#scatter-plot"><i class="fa fa-check"></i><b>2.5.4</b> Scatter plot</a></li>
<li class="chapter" data-level="2.5.5" data-path="visualization-1.html"><a href="visualization-1.html#line-plot"><i class="fa fa-check"></i><b>2.5.5</b> Line plot</a></li>
<li class="chapter" data-level="2.5.6" data-path="visualization-1.html"><a href="visualization-1.html#adding-error-bars"><i class="fa fa-check"></i><b>2.5.6</b> Adding error bars</a></li>
<li class="chapter" data-level="2.5.7" data-path="visualization-1.html"><a href="visualization-1.html#order-matters"><i class="fa fa-check"></i><b>2.5.7</b> Order matters</a></li>
<li class="chapter" data-level="2.5.8" data-path="visualization-1.html"><a href="visualization-1.html#grouping-data"><i class="fa fa-check"></i><b>2.5.8</b> Grouping data</a></li>
<li class="chapter" data-level="2.5.9" data-path="visualization-1.html"><a href="visualization-1.html#making-facets"><i class="fa fa-check"></i><b>2.5.9</b> Making facets</a></li>
<li class="chapter" data-level="2.5.10" data-path="visualization-1.html"><a href="visualization-1.html#global-local-and-setting-aes"><i class="fa fa-check"></i><b>2.5.10</b> Global, local, and setting <code>aes()</code></a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="visualization-1.html"><a href="visualization-1.html#additional-resources"><i class="fa fa-check"></i><b>2.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="visualization-1.html"><a href="visualization-1.html#cheatsheets"><i class="fa fa-check"></i><b>2.6.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="2.6.2" data-path="visualization-1.html"><a href="visualization-1.html#datacamp-courses"><i class="fa fa-check"></i><b>2.6.2</b> Datacamp courses</a></li>
<li class="chapter" data-level="2.6.3" data-path="visualization-1.html"><a href="visualization-1.html#books-and-chapters"><i class="fa fa-check"></i><b>2.6.3</b> Books and chapters</a></li>
<li class="chapter" data-level="2.6.4" data-path="visualization-1.html"><a href="visualization-1.html#misc"><i class="fa fa-check"></i><b>2.6.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="visualization-1.html"><a href="visualization-1.html#session-info-1"><i class="fa fa-check"></i><b>2.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualization-2.html"><a href="visualization-2.html"><i class="fa fa-check"></i><b>3</b> Visualization 2</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualization-2.html"><a href="visualization-2.html#learning-objectives"><i class="fa fa-check"></i><b>3.1</b> Learning objectives</a></li>
<li class="chapter" data-level="3.2" data-path="visualization-2.html"><a href="visualization-2.html#install-and-load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>3.2</b> Install and load packages, load data, set theme</a></li>
<li class="chapter" data-level="3.3" data-path="visualization-2.html"><a href="visualization-2.html#overview-of-different-plot-types-for-different-things"><i class="fa fa-check"></i><b>3.3</b> Overview of different plot types for different things</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualization-2.html"><a href="visualization-2.html#proportions"><i class="fa fa-check"></i><b>3.3.1</b> Proportions</a></li>
<li class="chapter" data-level="3.3.2" data-path="visualization-2.html"><a href="visualization-2.html#comparisons"><i class="fa fa-check"></i><b>3.3.2</b> Comparisons</a></li>
<li class="chapter" data-level="3.3.3" data-path="visualization-2.html"><a href="visualization-2.html#relationships"><i class="fa fa-check"></i><b>3.3.3</b> Relationships</a></li>
<li class="chapter" data-level="3.3.4" data-path="visualization-2.html"><a href="visualization-2.html#temporal-data"><i class="fa fa-check"></i><b>3.3.4</b> Temporal data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualization-2.html"><a href="visualization-2.html#customizing-plots"><i class="fa fa-check"></i><b>3.4</b> Customizing plots</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="visualization-2.html"><a href="visualization-2.html#anatomy-of-a-ggplot"><i class="fa fa-check"></i><b>3.4.1</b> Anatomy of a <code>ggplot</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="visualization-2.html"><a href="visualization-2.html#changing-the-order-of-things"><i class="fa fa-check"></i><b>3.4.2</b> Changing the order of things</a></li>
<li class="chapter" data-level="3.4.3" data-path="visualization-2.html"><a href="visualization-2.html#dealing-with-legends"><i class="fa fa-check"></i><b>3.4.3</b> Dealing with legends</a></li>
<li class="chapter" data-level="3.4.4" data-path="visualization-2.html"><a href="visualization-2.html#choosing-good-colors"><i class="fa fa-check"></i><b>3.4.4</b> Choosing good colors</a></li>
<li class="chapter" data-level="3.4.5" data-path="visualization-2.html"><a href="visualization-2.html#customizing-themes"><i class="fa fa-check"></i><b>3.4.5</b> Customizing themes</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="visualization-2.html"><a href="visualization-2.html#saving-plots"><i class="fa fa-check"></i><b>3.5</b> Saving plots</a></li>
<li class="chapter" data-level="3.6" data-path="visualization-2.html"><a href="visualization-2.html#creating-figure-panels"><i class="fa fa-check"></i><b>3.6</b> Creating figure panels</a></li>
<li class="chapter" data-level="3.7" data-path="visualization-2.html"><a href="visualization-2.html#peeking-behind-the-scenes"><i class="fa fa-check"></i><b>3.7</b> Peeking behind the scenes</a></li>
<li class="chapter" data-level="3.8" data-path="visualization-2.html"><a href="visualization-2.html#making-animations"><i class="fa fa-check"></i><b>3.8</b> Making animations</a></li>
<li class="chapter" data-level="3.9" data-path="visualization-2.html"><a href="visualization-2.html#shiny-apps"><i class="fa fa-check"></i><b>3.9</b> Shiny apps</a></li>
<li class="chapter" data-level="3.10" data-path="visualization-2.html"><a href="visualization-2.html#defining-snippets"><i class="fa fa-check"></i><b>3.10</b> Defining snippets</a></li>
<li class="chapter" data-level="3.11" data-path="visualization-2.html"><a href="visualization-2.html#additional-resources-1"><i class="fa fa-check"></i><b>3.11</b> Additional resources</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="visualization-2.html"><a href="visualization-2.html#cheatsheets-1"><i class="fa fa-check"></i><b>3.11.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="3.11.2" data-path="visualization-2.html"><a href="visualization-2.html#data-camp-courses"><i class="fa fa-check"></i><b>3.11.2</b> Data camp courses</a></li>
<li class="chapter" data-level="3.11.3" data-path="visualization-2.html"><a href="visualization-2.html#books-and-chapters-1"><i class="fa fa-check"></i><b>3.11.3</b> Books and chapters</a></li>
<li class="chapter" data-level="3.11.4" data-path="visualization-2.html"><a href="visualization-2.html#misc-1"><i class="fa fa-check"></i><b>3.11.4</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="visualization-2.html"><a href="visualization-2.html#session-info-2"><i class="fa fa-check"></i><b>3.12</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html"><i class="fa fa-check"></i><b>4</b> Data wrangling 1</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#learning-goals-1"><i class="fa fa-check"></i><b>4.1</b> Learning goals</a></li>
<li class="chapter" data-level="4.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#load-packages-1"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#some-r-basics"><i class="fa fa-check"></i><b>4.3</b> Some R basics</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#modes"><i class="fa fa-check"></i><b>4.3.1</b> Modes</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-types"><i class="fa fa-check"></i><b>4.3.2</b> Data types</a></li>
<li class="chapter" data-level="4.3.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#operators"><i class="fa fa-check"></i><b>4.3.3</b> Operators</a></li>
<li class="chapter" data-level="4.3.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#control-flow"><i class="fa fa-check"></i><b>4.3.4</b> Control flow</a></li>
<li class="chapter" data-level="4.3.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#functions"><i class="fa fa-check"></i><b>4.3.5</b> Functions</a></li>
<li class="chapter" data-level="4.3.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.3.6</b> The pipe operator <code>%&gt;%</code></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#a-quick-note-on-naming-things"><i class="fa fa-check"></i><b>4.4</b> A quick note on naming things</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#looking-at-data"><i class="fa fa-check"></i><b>4.5</b> Looking at data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#head"><i class="fa fa-check"></i><b>4.5.1</b> <code>head()</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#glimpse"><i class="fa fa-check"></i><b>4.5.2</b> <code>glimpse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#distinct"><i class="fa fa-check"></i><b>4.5.3</b> <code>distinct()</code></a></li>
<li class="chapter" data-level="4.5.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#count"><i class="fa fa-check"></i><b>4.5.4</b> <code>count()</code></a></li>
<li class="chapter" data-level="4.5.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#datatable"><i class="fa fa-check"></i><b>4.5.5</b> <code>datatable()</code></a></li>
<li class="chapter" data-level="4.5.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#other-tools-for-taking-a-quick-look-at-data"><i class="fa fa-check"></i><b>4.5.6</b> Other tools for taking a quick look at data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#wrangling-data"><i class="fa fa-check"></i><b>4.6</b> Wrangling data</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#filter"><i class="fa fa-check"></i><b>4.6.1</b> <code>filter()</code></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#arrange"><i class="fa fa-check"></i><b>4.6.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#rename"><i class="fa fa-check"></i><b>4.6.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#relocate"><i class="fa fa-check"></i><b>4.6.4</b> <code>relocate()</code></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#select"><i class="fa fa-check"></i><b>4.6.5</b> <code>select()</code></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-2"><i class="fa fa-check"></i><b>4.6.6</b> Practice 2</a></li>
<li class="chapter" data-level="4.6.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#mutate"><i class="fa fa-check"></i><b>4.6.7</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="4.6.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#practice-3"><i class="fa fa-check"></i><b>4.6.8</b> Practice 3</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#additional-resources-2"><i class="fa fa-check"></i><b>4.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#cheatsheets-2"><i class="fa fa-check"></i><b>4.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="4.7.2" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#data-camp-courses-1"><i class="fa fa-check"></i><b>4.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="4.7.3" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#books-and-chapters-2"><i class="fa fa-check"></i><b>4.7.3</b> Books and chapters</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="data-wrangling-1.html"><a href="data-wrangling-1.html#session-info-3"><i class="fa fa-check"></i><b>4.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html"><i class="fa fa-check"></i><b>5</b> Data wrangling 2</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#learning-goals-2"><i class="fa fa-check"></i><b>5.1</b> Learning goals</a></li>
<li class="chapter" data-level="5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#load-packages-2"><i class="fa fa-check"></i><b>5.2</b> Load packages</a></li>
<li class="chapter" data-level="5.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#settings"><i class="fa fa-check"></i><b>5.3</b> Settings</a></li>
<li class="chapter" data-level="5.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#wrangling-data-continued"><i class="fa fa-check"></i><b>5.4</b> Wrangling data (continued)</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#summarizing-data"><i class="fa fa-check"></i><b>5.4.1</b> Summarizing data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reshaping-data"><i class="fa fa-check"></i><b>5.4.2</b> Reshaping data</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#joining-multiple-data-frames"><i class="fa fa-check"></i><b>5.4.3</b> Joining multiple data frames</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>5.4.4</b> Dealing with missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#reading-in-data"><i class="fa fa-check"></i><b>5.5</b> Reading in data</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv"><i class="fa fa-check"></i><b>5.5.1</b> csv</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata"><i class="fa fa-check"></i><b>5.5.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#saving-data"><i class="fa fa-check"></i><b>5.6</b> Saving data</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#csv-1"><i class="fa fa-check"></i><b>5.6.1</b> csv</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#rdata-1"><i class="fa fa-check"></i><b>5.6.2</b> RData</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#additional-resources-3"><i class="fa fa-check"></i><b>5.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#cheatsheets-3"><i class="fa fa-check"></i><b>5.7.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="5.7.2" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#data-camp-courses-2"><i class="fa fa-check"></i><b>5.7.2</b> Data camp courses</a></li>
<li class="chapter" data-level="5.7.3" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#books-and-chapters-3"><i class="fa fa-check"></i><b>5.7.3</b> Books and chapters</a></li>
<li class="chapter" data-level="5.7.4" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#tutorials"><i class="fa fa-check"></i><b>5.7.4</b> Tutorials</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="data-wrangling-2.html"><a href="data-wrangling-2.html#session-info-4"><i class="fa fa-check"></i><b>5.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-and-causality.html"><a href="probability-and-causality.html"><i class="fa fa-check"></i><b>6</b> Probability and causality</a>
<ul>
<li class="chapter" data-level="6.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#load-packages-load-data-set-theme"><i class="fa fa-check"></i><b>6.1</b> Load packages, load data, set theme</a></li>
<li class="chapter" data-level="6.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#counting"><i class="fa fa-check"></i><b>6.2</b> Counting</a></li>
<li class="chapter" data-level="6.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#the-random-secretary"><i class="fa fa-check"></i><b>6.3</b> The random secretary</a></li>
<li class="chapter" data-level="6.4" data-path="probability-and-causality.html"><a href="probability-and-causality.html#flipping-a-coin-many-times"><i class="fa fa-check"></i><b>6.4</b> Flipping a coin many times</a></li>
<li class="chapter" data-level="6.5" data-path="probability-and-causality.html"><a href="probability-and-causality.html#clue-guide-to-probability"><i class="fa fa-check"></i><b>6.5</b> Clue guide to probability</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#conditional-probability"><i class="fa fa-check"></i><b>6.5.1</b> Conditional probability</a></li>
<li class="chapter" data-level="6.5.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#law-of-total-probability"><i class="fa fa-check"></i><b>6.5.2</b> Law of total probability</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="probability-and-causality.html"><a href="probability-and-causality.html#probability-operations"><i class="fa fa-check"></i><b>6.6</b> Probability operations</a></li>
<li class="chapter" data-level="6.7" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-explained"><i class="fa fa-check"></i><b>6.7</b> Bayesian reasoning explained</a></li>
<li class="chapter" data-level="6.8" data-path="probability-and-causality.html"><a href="probability-and-causality.html#getting-bayes-right-matters"><i class="fa fa-check"></i><b>6.8</b> Getting Bayes right matters</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example"><i class="fa fa-check"></i><b>6.8.1</b> Bayesian reasoning example</a></li>
<li class="chapter" data-level="6.8.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#bayesian-reasoning-example-covid-rapid-test"><i class="fa fa-check"></i><b>6.8.2</b> Bayesian reasoning example (COVID rapid test)</a></li>
<li class="chapter" data-level="6.8.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#most-people-in-the-hospital-are-vaccinated"><i class="fa fa-check"></i><b>6.8.3</b> Most people in the hospital are vaccinated</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="probability-and-causality.html"><a href="probability-and-causality.html#building-a-bayesis"><i class="fa fa-check"></i><b>6.9</b> Building a Bayesis</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#dice-example"><i class="fa fa-check"></i><b>6.9.1</b> Dice example</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="probability-and-causality.html"><a href="probability-and-causality.html#additional-resources-4"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="probability-and-causality.html"><a href="probability-and-causality.html#cheatsheets-4"><i class="fa fa-check"></i><b>6.10.1</b> Cheatsheets</a></li>
<li class="chapter" data-level="6.10.2" data-path="probability-and-causality.html"><a href="probability-and-causality.html#books-and-chapters-4"><i class="fa fa-check"></i><b>6.10.2</b> Books and chapters</a></li>
<li class="chapter" data-level="6.10.3" data-path="probability-and-causality.html"><a href="probability-and-causality.html#misc-2"><i class="fa fa-check"></i><b>6.10.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="6.11" data-path="probability-and-causality.html"><a href="probability-and-causality.html#session-info-5"><i class="fa fa-check"></i><b>6.11</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="simulation-1.html"><a href="simulation-1.html"><i class="fa fa-check"></i><b>7</b> Simulation 1</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simulation-1.html"><a href="simulation-1.html#load-packages-and-set-plotting-theme"><i class="fa fa-check"></i><b>7.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="7.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling"><i class="fa fa-check"></i><b>7.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="simulation-1.html"><a href="simulation-1.html#drawing-numbers-from-a-vector"><i class="fa fa-check"></i><b>7.2.1</b> Drawing numbers from a vector</a></li>
<li class="chapter" data-level="7.2.2" data-path="simulation-1.html"><a href="simulation-1.html#drawing-rows-from-a-data-frame"><i class="fa fa-check"></i><b>7.2.2</b> Drawing rows from a data frame</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="simulation-1.html"><a href="simulation-1.html#working-with-distributions"><i class="fa fa-check"></i><b>7.3</b> Working with distributions</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="simulation-1.html"><a href="simulation-1.html#plotting-distributions"><i class="fa fa-check"></i><b>7.3.1</b> Plotting distributions</a></li>
<li class="chapter" data-level="7.3.2" data-path="simulation-1.html"><a href="simulation-1.html#sampling-from-distributions"><i class="fa fa-check"></i><b>7.3.2</b> Sampling from distributions</a></li>
<li class="chapter" data-level="7.3.3" data-path="simulation-1.html"><a href="simulation-1.html#understanding-density"><i class="fa fa-check"></i><b>7.3.3</b> Understanding <code>density()</code></a></li>
<li class="chapter" data-level="7.3.4" data-path="simulation-1.html"><a href="simulation-1.html#cumulative-probability-distribution"><i class="fa fa-check"></i><b>7.3.4</b> Cumulative probability distribution</a></li>
<li class="chapter" data-level="7.3.5" data-path="simulation-1.html"><a href="simulation-1.html#inverse-cumulative-distribution"><i class="fa fa-check"></i><b>7.3.5</b> Inverse cumulative distribution</a></li>
<li class="chapter" data-level="7.3.6" data-path="simulation-1.html"><a href="simulation-1.html#computing-probabilities"><i class="fa fa-check"></i><b>7.3.6</b> Computing probabilities</a></li>
<li class="chapter" data-level="7.3.7" data-path="simulation-1.html"><a href="simulation-1.html#make-the-plot"><i class="fa fa-check"></i><b>7.3.7</b> Make the plot</a></li>
<li class="chapter" data-level="7.3.8" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solutions"><i class="fa fa-check"></i><b>7.3.8</b> Analytic solutions</a></li>
<li class="chapter" data-level="7.3.9" data-path="simulation-1.html"><a href="simulation-1.html#sampling-solution"><i class="fa fa-check"></i><b>7.3.9</b> Sampling solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="simulation-1.html"><a href="simulation-1.html#bayesian-inference-with-the-normal-distribution"><i class="fa fa-check"></i><b>7.4</b> Bayesian inference with the normal distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="simulation-1.html"><a href="simulation-1.html#analytic-solution"><i class="fa fa-check"></i><b>7.4.1</b> Analytic solution</a></li>
<li class="chapter" data-level="7.4.2" data-path="simulation-1.html"><a href="simulation-1.html#solution-via-sampling"><i class="fa fa-check"></i><b>7.4.2</b> Solution via sampling</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="simulation-1.html"><a href="simulation-1.html#additional-resources-5"><i class="fa fa-check"></i><b>7.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="simulation-1.html"><a href="simulation-1.html#datacamp"><i class="fa fa-check"></i><b>7.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="simulation-1.html"><a href="simulation-1.html#session-info-6"><i class="fa fa-check"></i><b>7.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-2.html"><a href="simulation-2.html"><i class="fa fa-check"></i><b>8</b> Simulation 2</a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-2.html"><a href="simulation-2.html#load-packages-and-set-plotting-theme-1"><i class="fa fa-check"></i><b>8.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="8.2" data-path="simulation-2.html"><a href="simulation-2.html#making-statistical-inferences-frequentist-style"><i class="fa fa-check"></i><b>8.2</b> Making statistical inferences (frequentist style)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-2.html"><a href="simulation-2.html#population-distribution"><i class="fa fa-check"></i><b>8.2.1</b> Population distribution</a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-2.html"><a href="simulation-2.html#distribution-of-a-single-sample"><i class="fa fa-check"></i><b>8.2.2</b> Distribution of a single sample</a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-2.html"><a href="simulation-2.html#the-sampling-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The sampling distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-2.html"><a href="simulation-2.html#understanding-p-values"><i class="fa fa-check"></i><b>8.3</b> Understanding p-values</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-2.html"><a href="simulation-2.html#permutation-test"><i class="fa fa-check"></i><b>8.3.1</b> Permutation test</a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-2.html"><a href="simulation-2.html#t-test-by-hand"><i class="fa fa-check"></i><b>8.3.2</b> t-test by hand</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-2.html"><a href="simulation-2.html#confidence-intervals"><i class="fa fa-check"></i><b>8.4</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="simulation-2.html"><a href="simulation-2.html#mean_cl_boot-explained"><i class="fa fa-check"></i><b>8.4.1</b> <code>mean_cl_boot()</code> explained</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="simulation-2.html"><a href="simulation-2.html#additional-resources-6"><i class="fa fa-check"></i><b>8.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-2.html"><a href="simulation-2.html#datacamp-1"><i class="fa fa-check"></i><b>8.5.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="simulation-2.html"><a href="simulation-2.html#session-info-7"><i class="fa fa-check"></i><b>8.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="modeling-data.html"><a href="modeling-data.html"><i class="fa fa-check"></i><b>9</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="modeling-data.html"><a href="modeling-data.html#load-packages-and-set-plotting-theme-2"><i class="fa fa-check"></i><b>9.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="9.2" data-path="modeling-data.html"><a href="modeling-data.html#modeling-data-1"><i class="fa fa-check"></i><b>9.2</b> Modeling data</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="modeling-data.html"><a href="modeling-data.html#simplicity-vs.-accuracy-trade-off"><i class="fa fa-check"></i><b>9.2.1</b> Simplicity vs. accuracy trade-off</a></li>
<li class="chapter" data-level="9.2.2" data-path="modeling-data.html"><a href="modeling-data.html#sampling-distributions-for-median-and-mean"><i class="fa fa-check"></i><b>9.2.2</b> Sampling distributions for median and mean</a></li>
<li class="chapter" data-level="9.2.3" data-path="modeling-data.html"><a href="modeling-data.html#residuals-need-to-be-normally-distributed-not-the-data-itself"><i class="fa fa-check"></i><b>9.2.3</b> Residuals need to be normally distributed, not the data itself</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="modeling-data.html"><a href="modeling-data.html#hypothesis-testing-one-sample-t-test"><i class="fa fa-check"></i><b>9.3</b> Hypothesis testing: “One-sample t-test”</a></li>
<li class="chapter" data-level="9.4" data-path="modeling-data.html"><a href="modeling-data.html#building-a-sampling-distribution-of-pre"><i class="fa fa-check"></i><b>9.4</b> Building a sampling distribution of PRE</a></li>
<li class="chapter" data-level="9.5" data-path="modeling-data.html"><a href="modeling-data.html#misc-3"><i class="fa fa-check"></i><b>9.5</b> Misc</a></li>
<li class="chapter" data-level="9.6" data-path="modeling-data.html"><a href="modeling-data.html#additional-resources-7"><i class="fa fa-check"></i><b>9.6</b> Additional resources</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="modeling-data.html"><a href="modeling-data.html#reading"><i class="fa fa-check"></i><b>9.6.1</b> Reading</a></li>
<li class="chapter" data-level="9.6.2" data-path="modeling-data.html"><a href="modeling-data.html#datacamp-2"><i class="fa fa-check"></i><b>9.6.2</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="modeling-data.html"><a href="modeling-data.html#session-info-8"><i class="fa fa-check"></i><b>9.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-model-1.html"><a href="linear-model-1.html"><i class="fa fa-check"></i><b>10</b> Linear model 1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-model-1.html"><a href="linear-model-1.html#load-packages-and-set-plotting-theme-3"><i class="fa fa-check"></i><b>10.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="10.2" data-path="linear-model-1.html"><a href="linear-model-1.html#correlation"><i class="fa fa-check"></i><b>10.2</b> Correlation</a></li>
<li class="chapter" data-level="10.3" data-path="linear-model-1.html"><a href="linear-model-1.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="linear-model-1.html"><a href="linear-model-1.html#define-and-fit-the-models"><i class="fa fa-check"></i><b>10.3.1</b> Define and fit the models</a></li>
<li class="chapter" data-level="10.3.2" data-path="linear-model-1.html"><a href="linear-model-1.html#calculate-the-sum-of-squared-errors-of-each-model"><i class="fa fa-check"></i><b>10.3.2</b> Calculate the sum of squared errors of each model</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="linear-model-1.html"><a href="linear-model-1.html#credit-example"><i class="fa fa-check"></i><b>10.4</b> Credit example</a></li>
<li class="chapter" data-level="10.5" data-path="linear-model-1.html"><a href="linear-model-1.html#additional-resources-8"><i class="fa fa-check"></i><b>10.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="linear-model-1.html"><a href="linear-model-1.html#datacamp-3"><i class="fa fa-check"></i><b>10.5.1</b> Datacamp</a></li>
<li class="chapter" data-level="10.5.2" data-path="linear-model-1.html"><a href="linear-model-1.html#misc-4"><i class="fa fa-check"></i><b>10.5.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="linear-model-1.html"><a href="linear-model-1.html#session-info-9"><i class="fa fa-check"></i><b>10.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="linear-model-2.html"><a href="linear-model-2.html"><i class="fa fa-check"></i><b>11</b> Linear model 2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="linear-model-2.html"><a href="linear-model-2.html#learning-goals-3"><i class="fa fa-check"></i><b>11.1</b> Learning goals</a></li>
<li class="chapter" data-level="11.2" data-path="linear-model-2.html"><a href="linear-model-2.html#load-packages-and-set-plotting-theme-4"><i class="fa fa-check"></i><b>11.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="11.3" data-path="linear-model-2.html"><a href="linear-model-2.html#load-data-sets"><i class="fa fa-check"></i><b>11.3</b> Load data sets</a></li>
<li class="chapter" data-level="11.4" data-path="linear-model-2.html"><a href="linear-model-2.html#multiple-continuous-variables"><i class="fa fa-check"></i><b>11.4</b> Multiple continuous variables</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="linear-model-2.html"><a href="linear-model-2.html#explore-correlations"><i class="fa fa-check"></i><b>11.4.1</b> Explore correlations</a></li>
<li class="chapter" data-level="11.4.2" data-path="linear-model-2.html"><a href="linear-model-2.html#multipe-regression"><i class="fa fa-check"></i><b>11.4.2</b> Multipe regression</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="linear-model-2.html"><a href="linear-model-2.html#one-categorical-variable"><i class="fa fa-check"></i><b>11.5</b> One categorical variable</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions"><i class="fa fa-check"></i><b>11.5.1</b> Visualization of the model predictions</a></li>
<li class="chapter" data-level="11.5.2" data-path="linear-model-2.html"><a href="linear-model-2.html#dummy-coding"><i class="fa fa-check"></i><b>11.5.2</b> Dummy coding</a></li>
<li class="chapter" data-level="11.5.3" data-path="linear-model-2.html"><a href="linear-model-2.html#reporting-the-results"><i class="fa fa-check"></i><b>11.5.3</b> Reporting the results</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="linear-model-2.html"><a href="linear-model-2.html#one-continuous-and-one-categorical-variable"><i class="fa fa-check"></i><b>11.6</b> One continuous and one categorical variable</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-of-the-model-predictions-1"><i class="fa fa-check"></i><b>11.6.1</b> Visualization of the model predictions</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="linear-model-2.html"><a href="linear-model-2.html#interactions"><i class="fa fa-check"></i><b>11.7</b> Interactions</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="linear-model-2.html"><a href="linear-model-2.html#visualization-3"><i class="fa fa-check"></i><b>11.7.1</b> Visualization</a></li>
<li class="chapter" data-level="11.7.2" data-path="linear-model-2.html"><a href="linear-model-2.html#hypothesis-test"><i class="fa fa-check"></i><b>11.7.2</b> Hypothesis test</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="linear-model-2.html"><a href="linear-model-2.html#additional-resources-9"><i class="fa fa-check"></i><b>11.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="linear-model-2.html"><a href="linear-model-2.html#datacamp-4"><i class="fa fa-check"></i><b>11.8.1</b> Datacamp</a></li>
<li class="chapter" data-level="11.8.2" data-path="linear-model-2.html"><a href="linear-model-2.html#misc-5"><i class="fa fa-check"></i><b>11.8.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="linear-model-2.html"><a href="linear-model-2.html#session-info-10"><i class="fa fa-check"></i><b>11.9</b> Session info</a></li>
<li class="chapter" data-level="11.10" data-path="linear-model-2.html"><a href="linear-model-2.html#references"><i class="fa fa-check"></i><b>11.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-model-3.html"><a href="linear-model-3.html"><i class="fa fa-check"></i><b>12</b> Linear model 3</a>
<ul>
<li class="chapter" data-level="12.1" data-path="linear-model-3.html"><a href="linear-model-3.html#learning-goals-4"><i class="fa fa-check"></i><b>12.1</b> Learning goals</a></li>
<li class="chapter" data-level="12.2" data-path="linear-model-3.html"><a href="linear-model-3.html#load-packages-and-set-plotting-theme-5"><i class="fa fa-check"></i><b>12.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="12.3" data-path="linear-model-3.html"><a href="linear-model-3.html#load-data-sets-1"><i class="fa fa-check"></i><b>12.3</b> Load data sets</a></li>
<li class="chapter" data-level="12.4" data-path="linear-model-3.html"><a href="linear-model-3.html#one-way-anova"><i class="fa fa-check"></i><b>12.4</b> One-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-4"><i class="fa fa-check"></i><b>12.4.1</b> Visualization</a></li>
<li class="chapter" data-level="12.4.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting"><i class="fa fa-check"></i><b>12.4.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.4.3" data-path="linear-model-3.html"><a href="linear-model-3.html#hypothesis-test-1"><i class="fa fa-check"></i><b>12.4.3</b> Hypothesis test</a></li>
<li class="chapter" data-level="12.4.4" data-path="linear-model-3.html"><a href="linear-model-3.html#visualize-the-models-predictions"><i class="fa fa-check"></i><b>12.4.4</b> Visualize the model’s predictions</a></li>
<li class="chapter" data-level="12.4.5" data-path="linear-model-3.html"><a href="linear-model-3.html#dummy-coding-1"><i class="fa fa-check"></i><b>12.4.5</b> Dummy coding</a></li>
<li class="chapter" data-level="12.4.6" data-path="linear-model-3.html"><a href="linear-model-3.html#follow-up-questions"><i class="fa fa-check"></i><b>12.4.6</b> Follow up questions</a></li>
<li class="chapter" data-level="12.4.7" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition"><i class="fa fa-check"></i><b>12.4.7</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova"><i class="fa fa-check"></i><b>12.5</b> Two-way ANOVA</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="linear-model-3.html"><a href="linear-model-3.html#visualization-5"><i class="fa fa-check"></i><b>12.5.1</b> Visualization</a></li>
<li class="chapter" data-level="12.5.2" data-path="linear-model-3.html"><a href="linear-model-3.html#model-fitting-1"><i class="fa fa-check"></i><b>12.5.2</b> Model fitting</a></li>
<li class="chapter" data-level="12.5.3" data-path="linear-model-3.html"><a href="linear-model-3.html#interpreting-interactions"><i class="fa fa-check"></i><b>12.5.3</b> Interpreting interactions</a></li>
<li class="chapter" data-level="12.5.4" data-path="linear-model-3.html"><a href="linear-model-3.html#variance-decomposition-1"><i class="fa fa-check"></i><b>12.5.4</b> Variance decomposition</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="linear-model-3.html"><a href="linear-model-3.html#two-way-anova-with-interaction"><i class="fa fa-check"></i><b>12.6</b> Two-way ANOVA (with interaction)</a></li>
<li class="chapter" data-level="12.7" data-path="linear-model-3.html"><a href="linear-model-3.html#additional-resources-10"><i class="fa fa-check"></i><b>12.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="linear-model-3.html"><a href="linear-model-3.html#datacamp-5"><i class="fa fa-check"></i><b>12.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="12.7.2" data-path="linear-model-3.html"><a href="linear-model-3.html#misc-6"><i class="fa fa-check"></i><b>12.7.2</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="linear-model-3.html"><a href="linear-model-3.html#session-info-11"><i class="fa fa-check"></i><b>12.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="linear-model-4.html"><a href="linear-model-4.html"><i class="fa fa-check"></i><b>13</b> Linear model 4</a>
<ul>
<li class="chapter" data-level="13.1" data-path="linear-model-4.html"><a href="linear-model-4.html#load-packages-and-set-plotting-theme-6"><i class="fa fa-check"></i><b>13.1</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="13.2" data-path="linear-model-4.html"><a href="linear-model-4.html#load-data-sets-2"><i class="fa fa-check"></i><b>13.2</b> Load data sets</a></li>
<li class="chapter" data-level="13.3" data-path="linear-model-4.html"><a href="linear-model-4.html#anova-with-unbalanced-design"><i class="fa fa-check"></i><b>13.3</b> ANOVA with unbalanced design</a></li>
<li class="chapter" data-level="13.4" data-path="linear-model-4.html"><a href="linear-model-4.html#interpreting-parameters-very-important"><i class="fa fa-check"></i><b>13.4</b> Interpreting parameters (very important!)</a></li>
<li class="chapter" data-level="13.5" data-path="linear-model-4.html"><a href="linear-model-4.html#linear-contrasts"><i class="fa fa-check"></i><b>13.5</b> Linear contrasts</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="linear-model-4.html"><a href="linear-model-4.html#hypothetical-data"><i class="fa fa-check"></i><b>13.5.1</b> Hypothetical data</a></li>
<li class="chapter" data-level="13.5.2" data-path="linear-model-4.html"><a href="linear-model-4.html#visualization-6"><i class="fa fa-check"></i><b>13.5.2</b> Visualization</a></li>
<li class="chapter" data-level="13.5.3" data-path="linear-model-4.html"><a href="linear-model-4.html#post-hoc-tests"><i class="fa fa-check"></i><b>13.5.3</b> Post-hoc tests</a></li>
<li class="chapter" data-level="13.5.4" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-dummy-coding"><i class="fa fa-check"></i><b>13.5.4</b> Understanding dummy coding</a></li>
<li class="chapter" data-level="13.5.5" data-path="linear-model-4.html"><a href="linear-model-4.html#understanding-sum-coding"><i class="fa fa-check"></i><b>13.5.5</b> Understanding sum coding</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="linear-model-4.html"><a href="linear-model-4.html#session-info-12"><i class="fa fa-check"></i><b>13.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>14</b> Power analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="power-analysis.html"><a href="power-analysis.html#learning-goals-5"><i class="fa fa-check"></i><b>14.1</b> Learning goals</a></li>
<li class="chapter" data-level="14.2" data-path="power-analysis.html"><a href="power-analysis.html#load-packages-and-set-plotting-theme-7"><i class="fa fa-check"></i><b>14.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="14.3" data-path="power-analysis.html"><a href="power-analysis.html#load-data-sets-3"><i class="fa fa-check"></i><b>14.3</b> Load data sets</a></li>
<li class="chapter" data-level="14.4" data-path="power-analysis.html"><a href="power-analysis.html#decision-making"><i class="fa fa-check"></i><b>14.4</b> Decision-making</a></li>
<li class="chapter" data-level="14.5" data-path="power-analysis.html"><a href="power-analysis.html#effect-sizes"><i class="fa fa-check"></i><b>14.5</b> Effect sizes</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="power-analysis.html"><a href="power-analysis.html#cohens-d"><i class="fa fa-check"></i><b>14.5.1</b> Cohen’s d</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="power-analysis.html"><a href="power-analysis.html#determining-sample-size"><i class="fa fa-check"></i><b>14.6</b> Determining sample size</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="power-analysis.html"><a href="power-analysis.html#pwr-package"><i class="fa fa-check"></i><b>14.6.1</b> <code>pwr</code> package</a></li>
<li class="chapter" data-level="14.6.2" data-path="power-analysis.html"><a href="power-analysis.html#power-analysis-1"><i class="fa fa-check"></i><b>14.6.2</b> Power analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="power-analysis.html"><a href="power-analysis.html#additional-resources-11"><i class="fa fa-check"></i><b>14.7</b> Additional resources</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="power-analysis.html"><a href="power-analysis.html#datacamp-6"><i class="fa fa-check"></i><b>14.7.1</b> Datacamp</a></li>
<li class="chapter" data-level="14.7.2" data-path="power-analysis.html"><a href="power-analysis.html#cheatsheets-5"><i class="fa fa-check"></i><b>14.7.2</b> Cheatsheets</a></li>
<li class="chapter" data-level="14.7.3" data-path="power-analysis.html"><a href="power-analysis.html#misc-7"><i class="fa fa-check"></i><b>14.7.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="power-analysis.html"><a href="power-analysis.html#session-info-13"><i class="fa fa-check"></i><b>14.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>15</b> Model comparison</a>
<ul>
<li class="chapter" data-level="15.1" data-path="model-comparison.html"><a href="model-comparison.html#learning-goals-6"><i class="fa fa-check"></i><b>15.1</b> Learning goals</a></li>
<li class="chapter" data-level="15.2" data-path="model-comparison.html"><a href="model-comparison.html#load-packages-and-set-plotting-theme-8"><i class="fa fa-check"></i><b>15.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="15.3" data-path="model-comparison.html"><a href="model-comparison.html#model-comparison-1"><i class="fa fa-check"></i><b>15.3</b> Model comparison</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="model-comparison.html"><a href="model-comparison.html#fitting-vs.-predicting"><i class="fa fa-check"></i><b>15.3.1</b> Fitting vs. predicting</a></li>
<li class="chapter" data-level="15.3.2" data-path="model-comparison.html"><a href="model-comparison.html#f-test"><i class="fa fa-check"></i><b>15.3.2</b> F-test</a></li>
<li class="chapter" data-level="15.3.3" data-path="model-comparison.html"><a href="model-comparison.html#cross-validation"><i class="fa fa-check"></i><b>15.3.3</b> Cross-validation</a></li>
<li class="chapter" data-level="15.3.4" data-path="model-comparison.html"><a href="model-comparison.html#bootstrap"><i class="fa fa-check"></i><b>15.3.4</b> Bootstrap</a></li>
<li class="chapter" data-level="15.3.5" data-path="model-comparison.html"><a href="model-comparison.html#aic-and-bic"><i class="fa fa-check"></i><b>15.3.5</b> AIC and BIC</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="model-comparison.html"><a href="model-comparison.html#additional-resources-12"><i class="fa fa-check"></i><b>15.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="model-comparison.html"><a href="model-comparison.html#datacamp-course"><i class="fa fa-check"></i><b>15.4.1</b> Datacamp course</a></li>
<li class="chapter" data-level="15.4.2" data-path="model-comparison.html"><a href="model-comparison.html#reading-1"><i class="fa fa-check"></i><b>15.4.2</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="model-comparison.html"><a href="model-comparison.html#session-info-14"><i class="fa fa-check"></i><b>15.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="causation.html"><a href="causation.html"><i class="fa fa-check"></i><b>16</b> Causation</a>
<ul>
<li class="chapter" data-level="16.1" data-path="causation.html"><a href="causation.html#learning-goals-7"><i class="fa fa-check"></i><b>16.1</b> Learning goals</a></li>
<li class="chapter" data-level="16.2" data-path="causation.html"><a href="causation.html#recommended-reading"><i class="fa fa-check"></i><b>16.2</b> Recommended reading</a></li>
<li class="chapter" data-level="16.3" data-path="causation.html"><a href="causation.html#load-packages-and-set-plotting-theme-9"><i class="fa fa-check"></i><b>16.3</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="16.4" data-path="causation.html"><a href="causation.html#bayesian-networks"><i class="fa fa-check"></i><b>16.4</b> Bayesian networks</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="causation.html"><a href="causation.html#sprinkler-example"><i class="fa fa-check"></i><b>16.4.1</b> Sprinkler example</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="causation.html"><a href="causation.html#controlling-for-variables"><i class="fa fa-check"></i><b>16.5</b> Controlling for variables</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="causation.html"><a href="causation.html#illustration-of-the-d-separation-algorithm"><i class="fa fa-check"></i><b>16.5.1</b> Illustration of the d-separation algorithm</a></li>
<li class="chapter" data-level="16.5.2" data-path="causation.html"><a href="causation.html#good-controls"><i class="fa fa-check"></i><b>16.5.2</b> Good controls</a></li>
<li class="chapter" data-level="16.5.3" data-path="causation.html"><a href="causation.html#bad-controls"><i class="fa fa-check"></i><b>16.5.3</b> Bad controls</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="causation.html"><a href="causation.html#mediation"><i class="fa fa-check"></i><b>16.6</b> Mediation</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="causation.html"><a href="causation.html#generate-data"><i class="fa fa-check"></i><b>16.6.1</b> Generate data</a></li>
<li class="chapter" data-level="16.6.2" data-path="causation.html"><a href="causation.html#method-1-baron-kennys-1986-indirect-effect-method"><i class="fa fa-check"></i><b>16.6.2</b> Method 1: Baron &amp; Kenny’s (1986) indirect effect method</a></li>
<li class="chapter" data-level="16.6.3" data-path="causation.html"><a href="causation.html#method-2-sobel-test"><i class="fa fa-check"></i><b>16.6.3</b> Method 2: Sobel Test</a></li>
<li class="chapter" data-level="16.6.4" data-path="causation.html"><a href="causation.html#method-3-bootstrapping"><i class="fa fa-check"></i><b>16.6.4</b> Method 3: Bootstrapping</a></li>
<li class="chapter" data-level="16.6.5" data-path="causation.html"><a href="causation.html#be-careful-about-mediation"><i class="fa fa-check"></i><b>16.6.5</b> Be careful about mediation!</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="causation.html"><a href="causation.html#moderation"><i class="fa fa-check"></i><b>16.7</b> Moderation</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="causation.html"><a href="causation.html#generate-data-1"><i class="fa fa-check"></i><b>16.7.1</b> Generate data</a></li>
<li class="chapter" data-level="16.7.2" data-path="causation.html"><a href="causation.html#moderation-analysis"><i class="fa fa-check"></i><b>16.7.2</b> Moderation analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="causation.html"><a href="causation.html#additional-resources-13"><i class="fa fa-check"></i><b>16.8</b> Additional resources</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="causation.html"><a href="causation.html#books"><i class="fa fa-check"></i><b>16.8.1</b> Books</a></li>
<li class="chapter" data-level="16.8.2" data-path="causation.html"><a href="causation.html#tutorials-1"><i class="fa fa-check"></i><b>16.8.2</b> Tutorials</a></li>
<li class="chapter" data-level="16.8.3" data-path="causation.html"><a href="causation.html#misc-8"><i class="fa fa-check"></i><b>16.8.3</b> Misc</a></li>
</ul></li>
<li class="chapter" data-level="16.9" data-path="causation.html"><a href="causation.html#session-info-15"><i class="fa fa-check"></i><b>16.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html"><i class="fa fa-check"></i><b>17</b> Linear mixed effects models 1</a>
<ul>
<li class="chapter" data-level="17.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#learning-goals-8"><i class="fa fa-check"></i><b>17.1</b> Learning goals</a></li>
<li class="chapter" data-level="17.2" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#load-packages-and-set-plotting-theme-10"><i class="fa fa-check"></i><b>17.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="17.3" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#dependence"><i class="fa fa-check"></i><b>17.3</b> Dependence</a></li>
<li class="chapter" data-level="17.4" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#additional-resources-14"><i class="fa fa-check"></i><b>17.4</b> Additional resources</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#readings"><i class="fa fa-check"></i><b>17.4.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="linear-mixed-effects-models-1.html"><a href="linear-mixed-effects-models-1.html#session-info-16"><i class="fa fa-check"></i><b>17.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html"><i class="fa fa-check"></i><b>18</b> Linear mixed effects models 2</a>
<ul>
<li class="chapter" data-level="18.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#learning-goals-9"><i class="fa fa-check"></i><b>18.1</b> Learning goals</a></li>
<li class="chapter" data-level="18.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#load-packages-and-set-plotting-theme-11"><i class="fa fa-check"></i><b>18.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="18.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#a-worked-example"><i class="fa fa-check"></i><b>18.3</b> A worked example</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#complete-pooling"><i class="fa fa-check"></i><b>18.3.1</b> Complete pooling</a></li>
<li class="chapter" data-level="18.3.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#no-pooling"><i class="fa fa-check"></i><b>18.3.2</b> No pooling</a></li>
<li class="chapter" data-level="18.3.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#partial-pooling"><i class="fa fa-check"></i><b>18.3.3</b> Partial pooling</a></li>
<li class="chapter" data-level="18.3.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#compare-results"><i class="fa fa-check"></i><b>18.3.4</b> Compare results</a></li>
<li class="chapter" data-level="18.3.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#getting-p-values"><i class="fa fa-check"></i><b>18.3.5</b> Getting p-values</a></li>
<li class="chapter" data-level="18.3.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#reporting-results"><i class="fa fa-check"></i><b>18.3.6</b> Reporting results</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simulating-a-linear-mixed-effects-model"><i class="fa fa-check"></i><b>18.4</b> Simulating a linear mixed effects model</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#the-effect-of-outliers"><i class="fa fa-check"></i><b>18.4.1</b> The effect of outliers</a></li>
<li class="chapter" data-level="18.4.2" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#different-slopes"><i class="fa fa-check"></i><b>18.4.2</b> Different slopes</a></li>
<li class="chapter" data-level="18.4.3" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#simpsons-paradox"><i class="fa fa-check"></i><b>18.4.3</b> Simpson’s paradox</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#additional-resources-15"><i class="fa fa-check"></i><b>18.5</b> Additional resources</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#readings-1"><i class="fa fa-check"></i><b>18.5.1</b> Readings</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="linear-mixed-effects-models-2.html"><a href="linear-mixed-effects-models-2.html#session-info-17"><i class="fa fa-check"></i><b>18.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html"><i class="fa fa-check"></i><b>19</b> Linear mixed effects models 3</a>
<ul>
<li class="chapter" data-level="19.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#learning-goals-10"><i class="fa fa-check"></i><b>19.1</b> Learning goals</a></li>
<li class="chapter" data-level="19.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-packages-and-set-plotting-theme-12"><i class="fa fa-check"></i><b>19.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="19.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#load-data-sets-4"><i class="fa fa-check"></i><b>19.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#sleep-data"><i class="fa fa-check"></i><b>19.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="19.3.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#reasoning-data"><i class="fa fa-check"></i><b>19.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="19.3.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#weight-loss-data"><i class="fa fa-check"></i><b>19.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="19.3.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#politness-data"><i class="fa fa-check"></i><b>19.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#understanding-the-lmer-syntax"><i class="fa fa-check"></i><b>19.4</b> Understanding the lmer() syntax</a></li>
<li class="chapter" data-level="19.5" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#anova-vs.-lmer"><i class="fa fa-check"></i><b>19.5</b> ANOVA vs. Lmer</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#between-subjects-anova"><i class="fa fa-check"></i><b>19.5.1</b> Between subjects ANOVA</a></li>
<li class="chapter" data-level="19.5.2" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#repeated-measures-anova"><i class="fa fa-check"></i><b>19.5.2</b> Repeated-measures ANOVA</a></li>
<li class="chapter" data-level="19.5.3" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#mixed-anova"><i class="fa fa-check"></i><b>19.5.3</b> Mixed ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="linear-mixed-effects-models-3.html"><a href="linear-mixed-effects-models-3.html#session-info-18"><i class="fa fa-check"></i><b>19.6</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html"><i class="fa fa-check"></i><b>20</b> Linear mixed effects models 4</a>
<ul>
<li class="chapter" data-level="20.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#learning-goals-11"><i class="fa fa-check"></i><b>20.1</b> Learning goals</a></li>
<li class="chapter" data-level="20.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-packages-and-set-plotting-theme-13"><i class="fa fa-check"></i><b>20.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="20.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#load-data-sets-5"><i class="fa fa-check"></i><b>20.3</b> Load data sets</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-data-1"><i class="fa fa-check"></i><b>20.3.1</b> Sleep data</a></li>
<li class="chapter" data-level="20.3.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#reasoning-data-1"><i class="fa fa-check"></i><b>20.3.2</b> Reasoning data</a></li>
<li class="chapter" data-level="20.3.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-data-1"><i class="fa fa-check"></i><b>20.3.3</b> Weight loss data</a></li>
<li class="chapter" data-level="20.3.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politness-data-1"><i class="fa fa-check"></i><b>20.3.4</b> Politness data</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#follow-up-tests-with-emmeans"><i class="fa fa-check"></i><b>20.4</b> Follow-up tests with emmeans</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#sleep-study"><i class="fa fa-check"></i><b>20.4.1</b> Sleep study</a></li>
<li class="chapter" data-level="20.4.2" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#weight-loss-study"><i class="fa fa-check"></i><b>20.4.2</b> Weight loss study</a></li>
<li class="chapter" data-level="20.4.3" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#politeness-study"><i class="fa fa-check"></i><b>20.4.3</b> Politeness study</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#mixtures-of-participants"><i class="fa fa-check"></i><b>20.5</b> Mixtures of participants</a></li>
<li class="chapter" data-level="20.6" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#bootstrapping"><i class="fa fa-check"></i><b>20.6</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#linear-model"><i class="fa fa-check"></i><b>20.6.1</b> Linear model</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="linear-mixed-effects-models-4.html"><a href="linear-mixed-effects-models-4.html#session-info-19"><i class="fa fa-check"></i><b>20.7</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>21</b> Generalized linear model</a>
<ul>
<li class="chapter" data-level="21.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#learning-goals-12"><i class="fa fa-check"></i><b>21.1</b> Learning goals</a></li>
<li class="chapter" data-level="21.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-packages-and-set-plotting-theme-14"><i class="fa fa-check"></i><b>21.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="21.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#load-data-set"><i class="fa fa-check"></i><b>21.3</b> Load data set</a></li>
<li class="chapter" data-level="21.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-regression"><i class="fa fa-check"></i><b>21.4</b> Logistic regression</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>21.4.1</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="21.4.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binary-predictor"><i class="fa fa-check"></i><b>21.4.2</b> Binary predictor</a></li>
<li class="chapter" data-level="21.4.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#continuous-predictor"><i class="fa fa-check"></i><b>21.4.3</b> Continuous predictor</a></li>
<li class="chapter" data-level="21.4.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#several-predictors"><i class="fa fa-check"></i><b>21.4.4</b> Several predictors</a></li>
<li class="chapter" data-level="21.4.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#using-the-ggeffects-package"><i class="fa fa-check"></i><b>21.4.5</b> Using the “ggeffects” package</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#simulate-a-logistic-regression"><i class="fa fa-check"></i><b>21.5</b> Simulate a logistic regression</a></li>
<li class="chapter" data-level="21.6" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#testing-hypotheses"><i class="fa fa-check"></i><b>21.6</b> Testing hypotheses</a></li>
<li class="chapter" data-level="21.7" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#logistic-mixed-effects-model"><i class="fa fa-check"></i><b>21.7</b> Logistic mixed effects model</a></li>
<li class="chapter" data-level="21.8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#additional-information"><i class="fa fa-check"></i><b>21.8</b> Additional information</a>
<ul>
<li class="chapter" data-level="21.8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#datacamp-7"><i class="fa fa-check"></i><b>21.8.1</b> Datacamp</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#session-info-20"><i class="fa fa-check"></i><b>21.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html"><i class="fa fa-check"></i><b>22</b> Bayesian data analysis</a>
<ul>
<li class="chapter" data-level="22.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#learning-goals-13"><i class="fa fa-check"></i><b>22.1</b> Learning goals</a></li>
<li class="chapter" data-level="22.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#load-packages-and-set-plotting-theme-15"><i class="fa fa-check"></i><b>22.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="22.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-by-hand"><i class="fa fa-check"></i><b>22.3</b> Doing Bayesian inference “by hand”</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#sequential-updating-based-on-the-beta-distribution"><i class="fa fa-check"></i><b>22.3.1</b> Sequential updating based on the Beta distribution</a></li>
<li class="chapter" data-level="22.3.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#coin-flip-example"><i class="fa fa-check"></i><b>22.3.2</b> Coin flip example</a></li>
<li class="chapter" data-level="22.3.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-inference-by-discretization"><i class="fa fa-check"></i><b>22.3.3</b> Bayesian inference by discretization</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#doing-bayesian-inference-with-greta"><i class="fa fa-check"></i><b>22.4</b> Doing Bayesian inference with Greta</a>
<ul>
<li class="chapter" data-level="22.4.1" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#attitude-data-set"><i class="fa fa-check"></i><b>22.4.1</b> Attitude data set</a></li>
<li class="chapter" data-level="22.4.2" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#frequentist-analysis"><i class="fa fa-check"></i><b>22.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="22.4.3" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#bayesian-regression"><i class="fa fa-check"></i><b>22.4.3</b> Bayesian regression</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="bayesian-data-analysis.html"><a href="bayesian-data-analysis.html#session-info-21"><i class="fa fa-check"></i><b>22.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html"><i class="fa fa-check"></i><b>23</b> Bayesian data analysis 2</a>
<ul>
<li class="chapter" data-level="23.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#learning-goals-14"><i class="fa fa-check"></i><b>23.1</b> Learning goals</a></li>
<li class="chapter" data-level="23.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-16"><i class="fa fa-check"></i><b>23.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="23.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#load-data-sets-6"><i class="fa fa-check"></i><b>23.3</b> Load data sets</a></li>
<li class="chapter" data-level="23.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#poker"><i class="fa fa-check"></i><b>23.4</b> Poker</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data"><i class="fa fa-check"></i><b>23.4.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.4.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model"><i class="fa fa-check"></i><b>23.4.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.4.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation"><i class="fa fa-check"></i><b>23.4.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.4.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-model-parameters"><i class="fa fa-check"></i><b>23.4.4</b> 4. Interpret the model parameters</a></li>
<li class="chapter" data-level="23.4.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses"><i class="fa fa-check"></i><b>23.4.5</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#sleep-study-1"><i class="fa fa-check"></i><b>23.5</b> Sleep study</a>
<ul>
<li class="chapter" data-level="23.5.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-1"><i class="fa fa-check"></i><b>23.5.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.5.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1"><i class="fa fa-check"></i><b>23.5.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.5.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-1"><i class="fa fa-check"></i><b>23.5.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.5.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters"><i class="fa fa-check"></i><b>23.5.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.5.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1"><i class="fa fa-check"></i><b>23.5.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.5.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results"><i class="fa fa-check"></i><b>23.5.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#titanic-study"><i class="fa fa-check"></i><b>23.6</b> Titanic study</a>
<ul>
<li class="chapter" data-level="23.6.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-that-data"><i class="fa fa-check"></i><b>23.6.1</b> 1. Visualize that data</a></li>
<li class="chapter" data-level="23.6.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2"><i class="fa fa-check"></i><b>23.6.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.6.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#model-evaluation-2"><i class="fa fa-check"></i><b>23.6.3</b> 3. Model evaluation</a></li>
<li class="chapter" data-level="23.6.4" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#interpret-the-parameters-1"><i class="fa fa-check"></i><b>23.6.4</b> 4. Interpret the parameters</a></li>
<li class="chapter" data-level="23.6.5" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2"><i class="fa fa-check"></i><b>23.6.5</b> 5. Test specific hypotheses</a></li>
<li class="chapter" data-level="23.6.6" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#report-results-1"><i class="fa fa-check"></i><b>23.6.6</b> 6. Report results</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#politeness-data"><i class="fa fa-check"></i><b>23.7</b> Politeness data</a>
<ul>
<li class="chapter" data-level="23.7.1" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#visualize-the-data-2"><i class="fa fa-check"></i><b>23.7.1</b> 1. Visualize the data</a></li>
<li class="chapter" data-level="23.7.2" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-3"><i class="fa fa-check"></i><b>23.7.2</b> 2. Specify and fit the model</a></li>
<li class="chapter" data-level="23.7.3" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3"><i class="fa fa-check"></i><b>23.7.3</b> 5. Test specific hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#additional-resources-16"><i class="fa fa-check"></i><b>23.8</b> Additional resources</a></li>
<li class="chapter" data-level="23.9" data-path="bayesian-data-analysis-2.html"><a href="bayesian-data-analysis-2.html#session-info-22"><i class="fa fa-check"></i><b>23.9</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html"><i class="fa fa-check"></i><b>24</b> Bayesian data analysis 3</a>
<ul>
<li class="chapter" data-level="24.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#learning-goals-15"><i class="fa fa-check"></i><b>24.1</b> Learning goals</a></li>
<li class="chapter" data-level="24.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#load-packages-and-set-plotting-theme-17"><i class="fa fa-check"></i><b>24.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="24.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>24.3</b> Evidence for the null hypothesis</a>
<ul>
<li class="chapter" data-level="24.3.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayes-factor-1"><i class="fa fa-check"></i><b>24.3.1</b> Bayes factor</a></li>
<li class="chapter" data-level="24.3.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#loo"><i class="fa fa-check"></i><b>24.3.2</b> LOO</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#dealing-with-heteroscedasticity"><i class="fa fa-check"></i><b>24.4</b> Dealing with heteroscedasticity</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#visualize-the-data-3"><i class="fa fa-check"></i><b>24.4.1</b> Visualize the data</a></li>
<li class="chapter" data-level="24.4.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#frequentist-analysis-4"><i class="fa fa-check"></i><b>24.4.2</b> Frequentist analysis</a></li>
<li class="chapter" data-level="24.4.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#bayesian-analysis-3"><i class="fa fa-check"></i><b>24.4.3</b> Bayesian analysis</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#zero-one-inflated-beta-binomial-model"><i class="fa fa-check"></i><b>24.5</b> Zero-one inflated beta binomial model</a></li>
<li class="chapter" data-level="24.6" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression"><i class="fa fa-check"></i><b>24.6</b> Ordinal regression</a>
<ul>
<li class="chapter" data-level="24.6.1" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#ordinal-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.1</b> Ordinal regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.2" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-assuming-equal-variance"><i class="fa fa-check"></i><b>24.6.2</b> Gaussian regression (assuming equal variance)</a></li>
<li class="chapter" data-level="24.6.3" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#oridnal-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.3</b> Oridnal regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.4" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#gaussian-regression-unequal-variance"><i class="fa fa-check"></i><b>24.6.4</b> Gaussian regression (unequal variance)</a></li>
<li class="chapter" data-level="24.6.5" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#model-comparison-2"><i class="fa fa-check"></i><b>24.6.5</b> Model comparison</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#additional-resources-17"><i class="fa fa-check"></i><b>24.7</b> Additional resources</a></li>
<li class="chapter" data-level="24.8" data-path="bayesian-data-analysis-3.html"><a href="bayesian-data-analysis-3.html#session-info-23"><i class="fa fa-check"></i><b>24.8</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="model-assumptions.html"><a href="model-assumptions.html"><i class="fa fa-check"></i><b>25</b> Model assumptions</a>
<ul>
<li class="chapter" data-level="25.1" data-path="model-assumptions.html"><a href="model-assumptions.html#learning-goals-16"><i class="fa fa-check"></i><b>25.1</b> Learning goals</a></li>
<li class="chapter" data-level="25.2" data-path="model-assumptions.html"><a href="model-assumptions.html#load-packages-and-set-plotting-theme-18"><i class="fa fa-check"></i><b>25.2</b> Load packages and set plotting theme</a></li>
<li class="chapter" data-level="25.3" data-path="model-assumptions.html"><a href="model-assumptions.html#model-assumptions-and-what-to-do-if-they-are-violated"><i class="fa fa-check"></i><b>25.3</b> Model assumptions and what to do if they are violated</a>
<ul>
<li class="chapter" data-level="25.3.1" data-path="model-assumptions.html"><a href="model-assumptions.html#influential-data-points"><i class="fa fa-check"></i><b>25.3.1</b> Influential data points</a></li>
<li class="chapter" data-level="25.3.2" data-path="model-assumptions.html"><a href="model-assumptions.html#linear-and-additive"><i class="fa fa-check"></i><b>25.3.2</b> Linear and additive</a></li>
<li class="chapter" data-level="25.3.3" data-path="model-assumptions.html"><a href="model-assumptions.html#normally-distributed-residuals"><i class="fa fa-check"></i><b>25.3.3</b> Normally distributed residuals</a></li>
<li class="chapter" data-level="25.3.4" data-path="model-assumptions.html"><a href="model-assumptions.html#non-parametric-tests"><i class="fa fa-check"></i><b>25.3.4</b> Non-parametric tests</a></li>
<li class="chapter" data-level="25.3.5" data-path="model-assumptions.html"><a href="model-assumptions.html#bootstrapping-regressions"><i class="fa fa-check"></i><b>25.3.5</b> Bootstrapping regressions</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="model-assumptions.html"><a href="model-assumptions.html#additional-resources-18"><i class="fa fa-check"></i><b>25.4</b> Additional resources</a></li>
<li class="chapter" data-level="25.5" data-path="model-assumptions.html"><a href="model-assumptions.html#session-info-24"><i class="fa fa-check"></i><b>25.5</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="reporting-statistics.html"><a href="reporting-statistics.html"><i class="fa fa-check"></i><b>26</b> Reporting statistics</a>
<ul>
<li class="chapter" data-level="26.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#general-advice"><i class="fa fa-check"></i><b>26.1</b> General advice</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#make-good-figures"><i class="fa fa-check"></i><b>26.1.1</b> Make good figures!</a></li>
<li class="chapter" data-level="26.1.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#use-statistical-models-to-answer-concrete-research-questions."><i class="fa fa-check"></i><b>26.1.2</b> Use statistical models to answer concrete research questions.</a></li>
<li class="chapter" data-level="26.1.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#illustrate-the-uncertainty-in-your-statistical-inferences."><i class="fa fa-check"></i><b>26.1.3</b> Illustrate the uncertainty in your statistical inferences.</a></li>
<li class="chapter" data-level="26.1.4" data-path="reporting-statistics.html"><a href="reporting-statistics.html#report-effect-sizes."><i class="fa fa-check"></i><b>26.1.4</b> Report effect sizes.</a></li>
<li class="chapter" data-level="26.1.5" data-path="reporting-statistics.html"><a href="reporting-statistics.html#reporting-statistical-results-using-rmarkdown"><i class="fa fa-check"></i><b>26.1.5</b> Reporting statistical results using RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="reporting-statistics.html"><a href="reporting-statistics.html#some-concrete-example"><i class="fa fa-check"></i><b>26.2</b> Some concrete example</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="reporting-statistics.html"><a href="reporting-statistics.html#frequentist-statistics"><i class="fa fa-check"></i><b>26.2.1</b> Frequentist statistics</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="reporting-statistics.html"><a href="reporting-statistics.html#session-info-25"><i class="fa fa-check"></i><b>26.3</b> Session info</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html"><i class="fa fa-check"></i><b>27</b> Cheatsheets</a>
<ul>
<li class="chapter" data-level="27.1" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#statistics"><i class="fa fa-check"></i><b>27.1</b> Statistics</a></li>
<li class="chapter" data-level="27.2" data-path="cheatsheets-6.html"><a href="cheatsheets-6.html#r"><i class="fa fa-check"></i><b>27.2</b> R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Psych 252: Statistical Methods for Behavioral and Social Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-data-analysis-2" class="section level1 hasAnchor" number="23">
<h1><span class="header-section-number">Chapter 23</span> Bayesian data analysis 2<a href="bayesian-data-analysis-2.html#bayesian-data-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-goals-14" class="section level2 hasAnchor" number="23.1">
<h2><span class="header-section-number">23.1</span> Learning goals<a href="bayesian-data-analysis-2.html#learning-goals-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Building Bayesian models with <code>brms</code>.
<ul>
<li>Model evaluation:
<ul>
<li>Visualizing and interpreting results.</li>
<li>Testing hypotheses.</li>
</ul></li>
<li>Inference evaluation: Did things work out?</li>
</ul></li>
</ul>
</div>
<div id="load-packages-and-set-plotting-theme-16" class="section level2 hasAnchor" number="23.2">
<h2><span class="header-section-number">23.2</span> Load packages and set plotting theme<a href="bayesian-data-analysis-2.html#load-packages-and-set-plotting-theme-16" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1216-1"><a href="bayesian-data-analysis-2.html#cb1216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;knitr&quot;</span>)       <span class="co"># for knitting RMarkdown </span></span>
<span id="cb1216-2"><a href="bayesian-data-analysis-2.html#cb1216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;kableExtra&quot;</span>)  <span class="co"># for making nice tables</span></span>
<span id="cb1216-3"><a href="bayesian-data-analysis-2.html#cb1216-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;janitor&quot;</span>)     <span class="co"># for cleaning column names</span></span>
<span id="cb1216-4"><a href="bayesian-data-analysis-2.html#cb1216-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidybayes&quot;</span>)   <span class="co"># tidying up results from Bayesian models</span></span>
<span id="cb1216-5"><a href="bayesian-data-analysis-2.html#cb1216-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;brms&quot;</span>)        <span class="co"># Bayesian regression models with Stan</span></span>
<span id="cb1216-6"><a href="bayesian-data-analysis-2.html#cb1216-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;patchwork&quot;</span>)   <span class="co"># for making figure panels</span></span>
<span id="cb1216-7"><a href="bayesian-data-analysis-2.html#cb1216-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;GGally&quot;</span>)      <span class="co"># for pairs plot</span></span>
<span id="cb1216-8"><a href="bayesian-data-analysis-2.html#cb1216-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom.mixed&quot;</span>) <span class="co"># for tidy lmer results</span></span>
<span id="cb1216-9"><a href="bayesian-data-analysis-2.html#cb1216-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;bayesplot&quot;</span>)   <span class="co"># for visualization of Bayesian model fits </span></span>
<span id="cb1216-10"><a href="bayesian-data-analysis-2.html#cb1216-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;modelr&quot;</span>)      <span class="co"># for modeling functions</span></span>
<span id="cb1216-11"><a href="bayesian-data-analysis-2.html#cb1216-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lme4&quot;</span>)        <span class="co"># for linear mixed effects models </span></span>
<span id="cb1216-12"><a href="bayesian-data-analysis-2.html#cb1216-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;afex&quot;</span>)        <span class="co"># for ANOVAs</span></span>
<span id="cb1216-13"><a href="bayesian-data-analysis-2.html#cb1216-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;car&quot;</span>)         <span class="co"># for ANOVAs</span></span>
<span id="cb1216-14"><a href="bayesian-data-analysis-2.html#cb1216-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;emmeans&quot;</span>)     <span class="co"># for linear contrasts</span></span>
<span id="cb1216-15"><a href="bayesian-data-analysis-2.html#cb1216-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggeffects&quot;</span>)   <span class="co"># for help with logistic regressions</span></span>
<span id="cb1216-16"><a href="bayesian-data-analysis-2.html#cb1216-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;titanic&quot;</span>)     <span class="co"># titanic dataset</span></span>
<span id="cb1216-17"><a href="bayesian-data-analysis-2.html#cb1216-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;gganimate&quot;</span>)   <span class="co"># for animations</span></span>
<span id="cb1216-18"><a href="bayesian-data-analysis-2.html#cb1216-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;parameters&quot;</span>)  <span class="co"># for getting parameters</span></span>
<span id="cb1216-19"><a href="bayesian-data-analysis-2.html#cb1216-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;transformr&quot;</span>)  <span class="co"># for gganimate</span></span>
<span id="cb1216-20"><a href="bayesian-data-analysis-2.html#cb1216-20" aria-hidden="true" tabindex="-1"></a><span class="co"># install via: devtools::install_github(&quot;thomasp85/transformr&quot;)</span></span>
<span id="cb1216-21"><a href="bayesian-data-analysis-2.html#cb1216-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)   <span class="co"># for wrangling, plotting, etc. </span></span></code></pre></div>
<div class="sourceCode" id="cb1217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1217-1"><a href="bayesian-data-analysis-2.html#cb1217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="co"># set the theme </span></span>
<span id="cb1217-2"><a href="bayesian-data-analysis-2.html#cb1217-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))) <span class="co"># set the default text size</span></span>
<span id="cb1217-3"><a href="bayesian-data-analysis-2.html#cb1217-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1217-4"><a href="bayesian-data-analysis-2.html#cb1217-4" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb1217-5"><a href="bayesian-data-analysis-2.html#cb1217-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fig.show =</span> <span class="st">&quot;hold&quot;</span>)</span>
<span id="cb1217-6"><a href="bayesian-data-analysis-2.html#cb1217-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1217-7"><a href="bayesian-data-analysis-2.html#cb1217-7" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">dplyr.summarise.inform =</span> F)</span>
<span id="cb1217-8"><a href="bayesian-data-analysis-2.html#cb1217-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1217-9"><a href="bayesian-data-analysis-2.html#cb1217-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set default color scheme in ggplot </span></span>
<span id="cb1217-10"><a href="bayesian-data-analysis-2.html#cb1217-10" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">ggplot2.discrete.color =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Set1&quot;</span>))</span></code></pre></div>
</div>
<div id="load-data-sets-6" class="section level2 hasAnchor" number="23.3">
<h2><span class="header-section-number">23.3</span> Load data sets<a href="bayesian-data-analysis-2.html#load-data-sets-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1218-1"><a href="bayesian-data-analysis-2.html#cb1218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># poker </span></span>
<span id="cb1218-2"><a href="bayesian-data-analysis-2.html#cb1218-2" aria-hidden="true" tabindex="-1"></a>df.poker <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/poker.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1218-3"><a href="bayesian-data-analysis-2.html#cb1218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">skill =</span> <span class="fu">factor</span>(skill,</span>
<span id="cb1218-4"><a href="bayesian-data-analysis-2.html#cb1218-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb1218-5"><a href="bayesian-data-analysis-2.html#cb1218-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;expert&quot;</span>, <span class="st">&quot;average&quot;</span>)),</span>
<span id="cb1218-6"><a href="bayesian-data-analysis-2.html#cb1218-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">skill =</span> <span class="fu">fct_relevel</span>(skill, <span class="st">&quot;average&quot;</span>, <span class="st">&quot;expert&quot;</span>),</span>
<span id="cb1218-7"><a href="bayesian-data-analysis-2.html#cb1218-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">hand =</span> <span class="fu">factor</span>(hand,</span>
<span id="cb1218-8"><a href="bayesian-data-analysis-2.html#cb1218-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb1218-9"><a href="bayesian-data-analysis-2.html#cb1218-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;bad&quot;</span>, <span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;good&quot;</span>)),</span>
<span id="cb1218-10"><a href="bayesian-data-analysis-2.html#cb1218-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">limit =</span> <span class="fu">factor</span>(limit,</span>
<span id="cb1218-11"><a href="bayesian-data-analysis-2.html#cb1218-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb1218-12"><a href="bayesian-data-analysis-2.html#cb1218-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;fixed&quot;</span>, <span class="st">&quot;none&quot;</span>)),</span>
<span id="cb1218-13"><a href="bayesian-data-analysis-2.html#cb1218-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb1218-14"><a href="bayesian-data-analysis-2.html#cb1218-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, <span class="fu">everything</span>())</span>
<span id="cb1218-15"><a href="bayesian-data-analysis-2.html#cb1218-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1218-16"><a href="bayesian-data-analysis-2.html#cb1218-16" aria-hidden="true" tabindex="-1"></a><span class="co"># sleep</span></span>
<span id="cb1218-17"><a href="bayesian-data-analysis-2.html#cb1218-17" aria-hidden="true" tabindex="-1"></a>df.sleep <span class="ot">=</span> sleepstudy <span class="sc">%&gt;%</span> </span>
<span id="cb1218-18"><a href="bayesian-data-analysis-2.html#cb1218-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1218-19"><a href="bayesian-data-analysis-2.html#cb1218-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1218-20"><a href="bayesian-data-analysis-2.html#cb1218-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subject =</span> <span class="fu">as.character</span>(subject)) <span class="sc">%&gt;%</span> </span>
<span id="cb1218-21"><a href="bayesian-data-analysis-2.html#cb1218-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(subject, days, reaction) <span class="sc">%&gt;%</span> </span>
<span id="cb1218-22"><a href="bayesian-data-analysis-2.html#cb1218-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">subject =</span> <span class="st">&quot;374&quot;</span>,</span>
<span id="cb1218-23"><a href="bayesian-data-analysis-2.html#cb1218-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">days =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb1218-24"><a href="bayesian-data-analysis-2.html#cb1218-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">reaction =</span> <span class="fu">c</span>(<span class="dv">286</span>, <span class="dv">288</span>)),</span>
<span id="cb1218-25"><a href="bayesian-data-analysis-2.html#cb1218-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tibble</span>(<span class="at">subject =</span> <span class="st">&quot;373&quot;</span>,</span>
<span id="cb1218-26"><a href="bayesian-data-analysis-2.html#cb1218-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">days =</span> <span class="dv">0</span>,</span>
<span id="cb1218-27"><a href="bayesian-data-analysis-2.html#cb1218-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">reaction =</span> <span class="dv">245</span>))</span>
<span id="cb1218-28"><a href="bayesian-data-analysis-2.html#cb1218-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1218-29"><a href="bayesian-data-analysis-2.html#cb1218-29" aria-hidden="true" tabindex="-1"></a><span class="co"># titanic </span></span>
<span id="cb1218-30"><a href="bayesian-data-analysis-2.html#cb1218-30" aria-hidden="true" tabindex="-1"></a>df.titanic <span class="ot">=</span> titanic_train <span class="sc">%&gt;%</span> </span>
<span id="cb1218-31"><a href="bayesian-data-analysis-2.html#cb1218-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1218-32"><a href="bayesian-data-analysis-2.html#cb1218-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">as.factor</span>(sex))</span>
<span id="cb1218-33"><a href="bayesian-data-analysis-2.html#cb1218-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1218-34"><a href="bayesian-data-analysis-2.html#cb1218-34" aria-hidden="true" tabindex="-1"></a><span class="co"># politeness</span></span>
<span id="cb1218-35"><a href="bayesian-data-analysis-2.html#cb1218-35" aria-hidden="true" tabindex="-1"></a>df.politeness <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/politeness_data.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1218-36"><a href="bayesian-data-analysis-2.html#cb1218-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">pitch =</span> frequency)</span></code></pre></div>
</div>
<div id="poker" class="section level2 hasAnchor" number="23.4">
<h2><span class="header-section-number">23.4</span> Poker<a href="bayesian-data-analysis-2.html#poker" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="visualize-the-data" class="section level3 hasAnchor" number="23.4.1">
<h3><span class="header-section-number">23.4.1</span> 1. Visualize the data<a href="bayesian-data-analysis-2.html#visualize-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s visualize the data first.</p>
<div class="sourceCode" id="cb1219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1219-1"><a href="bayesian-data-analysis-2.html#cb1219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1219-2"><a href="bayesian-data-analysis-2.html#cb1219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1219-3"><a href="bayesian-data-analysis-2.html#cb1219-3" aria-hidden="true" tabindex="-1"></a>df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb1219-4"><a href="bayesian-data-analysis-2.html#cb1219-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand,</span>
<span id="cb1219-5"><a href="bayesian-data-analysis-2.html#cb1219-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> balance,</span>
<span id="cb1219-6"><a href="bayesian-data-analysis-2.html#cb1219-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> hand,</span>
<span id="cb1219-7"><a href="bayesian-data-analysis-2.html#cb1219-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">group =</span> skill,</span>
<span id="cb1219-8"><a href="bayesian-data-analysis-2.html#cb1219-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> skill)) <span class="sc">+</span> </span>
<span id="cb1219-9"><a href="bayesian-data-analysis-2.html#cb1219-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb1219-10"><a href="bayesian-data-analysis-2.html#cb1219-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">dodge.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb1219-11"><a href="bayesian-data-analysis-2.html#cb1219-11" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">jitter.height =</span> <span class="dv">0</span>, </span>
<span id="cb1219-12"><a href="bayesian-data-analysis-2.html#cb1219-12" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">jitter.width =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb1219-13"><a href="bayesian-data-analysis-2.html#cb1219-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb1219-14"><a href="bayesian-data-analysis-2.html#cb1219-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>),</span>
<span id="cb1219-15"><a href="bayesian-data-analysis-2.html#cb1219-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb1219-16"><a href="bayesian-data-analysis-2.html#cb1219-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;final balance (in Euros)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1219-17"><a href="bayesian-data-analysis-2.html#cb1219-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">22</span>)) <span class="sc">+</span> </span>
<span id="cb1219-18"><a href="bayesian-data-analysis-2.html#cb1219-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1219-19"><a href="bayesian-data-analysis-2.html#cb1219-19" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">fill =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Set1&quot;</span>))),</span>
<span id="cb1219-20"><a href="bayesian-data-analysis-2.html#cb1219-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)))</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="specify-and-fit-the-model" class="section level3 hasAnchor" number="23.4.2">
<h3><span class="header-section-number">23.4.2</span> 2. Specify and fit the model<a href="bayesian-data-analysis-2.html#specify-and-fit-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="frequentist-model" class="section level4 hasAnchor" number="23.4.2.1">
<h4><span class="header-section-number">23.4.2.1</span> Frequentist model<a href="bayesian-data-analysis-2.html#frequentist-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>And let’s now fit a simple (frequentist) ANOVA model. You have multiple options to do so:</p>
<div class="sourceCode" id="cb1220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1220-1"><a href="bayesian-data-analysis-2.html#cb1220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1: Using the &quot;afex&quot; package</span></span>
<span id="cb1220-2"><a href="bayesian-data-analysis-2.html#cb1220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">&quot;participant&quot;</span>,</span>
<span id="cb1220-3"><a href="bayesian-data-analysis-2.html#cb1220-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">dv =</span> <span class="st">&quot;balance&quot;</span>,</span>
<span id="cb1220-4"><a href="bayesian-data-analysis-2.html#cb1220-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">between =</span> <span class="fu">c</span>(<span class="st">&quot;hand&quot;</span>, <span class="st">&quot;skill&quot;</span>),</span>
<span id="cb1220-5"><a href="bayesian-data-analysis-2.html#cb1220-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> df.poker)</span></code></pre></div>
<pre><code>Contrasts set to contr.sum for the following variables: hand, skill</code></pre>
<pre><code>Anova Table (Type 3 tests)

Response: balance
      Effect     df   MSE         F  ges p.value
1       hand 2, 294 16.16 79.17 *** .350   &lt;.001
2      skill 1, 294 16.16      2.43 .008    .120
3 hand:skill 2, 294 16.16  7.08 *** .046   &lt;.001
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1223-1"><a href="bayesian-data-analysis-2.html#cb1223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2: Using the car package (here we have to remember to set the contrasts to sum</span></span>
<span id="cb1223-2"><a href="bayesian-data-analysis-2.html#cb1223-2" aria-hidden="true" tabindex="-1"></a><span class="co"># contrasts!)</span></span>
<span id="cb1223-3"><a href="bayesian-data-analysis-2.html#cb1223-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(balance <span class="sc">~</span> hand <span class="sc">*</span> skill,</span>
<span id="cb1223-4"><a href="bayesian-data-analysis-2.html#cb1223-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">hand =</span> <span class="st">&quot;contr.sum&quot;</span>,</span>
<span id="cb1223-5"><a href="bayesian-data-analysis-2.html#cb1223-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">skill =</span> <span class="st">&quot;contr.sum&quot;</span>),</span>
<span id="cb1223-6"><a href="bayesian-data-analysis-2.html#cb1223-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> df.poker) <span class="sc">%&gt;%</span> </span>
<span id="cb1223-7"><a href="bayesian-data-analysis-2.html#cb1223-7" aria-hidden="true" tabindex="-1"></a>  car<span class="sc">::</span><span class="fu">Anova</span>(<span class="at">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>Anova Table (Type III tests)

Response: balance
             Sum Sq  Df   F value    Pr(&gt;F)    
(Intercept) 28644.7   1 1772.1137 &lt; 2.2e-16 ***
hand         2559.4   2   79.1692 &lt; 2.2e-16 ***
skill          39.3   1    2.4344 0.1197776    
hand:skill    229.0   2    7.0830 0.0009901 ***
Residuals    4752.3 294                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb1225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1225-1"><a href="bayesian-data-analysis-2.html#cb1225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 3: Using the emmeans package (I like this one the best! It let&#39;s us use the </span></span>
<span id="cb1225-2"><a href="bayesian-data-analysis-2.html#cb1225-2" aria-hidden="true" tabindex="-1"></a><span class="co"># general lm() syntax and we don&#39;t have to remember to set the contrast)</span></span>
<span id="cb1225-3"><a href="bayesian-data-analysis-2.html#cb1225-3" aria-hidden="true" tabindex="-1"></a>fit.lm_poker <span class="ot">=</span> <span class="fu">lm</span>(balance <span class="sc">~</span> hand <span class="sc">*</span> skill,</span>
<span id="cb1225-4"><a href="bayesian-data-analysis-2.html#cb1225-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> df.poker) </span>
<span id="cb1225-5"><a href="bayesian-data-analysis-2.html#cb1225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1225-6"><a href="bayesian-data-analysis-2.html#cb1225-6" aria-hidden="true" tabindex="-1"></a>fit.lm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1225-7"><a href="bayesian-data-analysis-2.html#cb1225-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">joint_tests</span>()</span></code></pre></div>
<pre><code> model term df1 df2 F.ratio p.value
 hand         2 294  79.169  &lt;.0001
 skill        1 294   2.434  0.1198
 hand:skill   2 294   7.083  0.0010</code></pre>
<p>All three options give the same result. Personally, I like Option 3 the best.</p>
</div>
<div id="bayesian-model" class="section level4 hasAnchor" number="23.4.2.2">
<h4><span class="header-section-number">23.4.2.2</span> Bayesian model<a href="bayesian-data-analysis-2.html#bayesian-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now, let’s fit a Bayesian regression model using the <code>brm()</code> function (starting with a simple model that only considers <code>hand</code> as a predictor):</p>
<div class="sourceCode" id="cb1227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1227-1"><a href="bayesian-data-analysis-2.html#cb1227-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hand,</span>
<span id="cb1227-2"><a href="bayesian-data-analysis-2.html#cb1227-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df.poker,</span>
<span id="cb1227-3"><a href="bayesian-data-analysis-2.html#cb1227-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seed =</span> <span class="dv">1</span>, </span>
<span id="cb1227-4"><a href="bayesian-data-analysis-2.html#cb1227-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">file =</span> <span class="st">&quot;cache/brm_poker&quot;</span>)</span>
<span id="cb1227-5"><a href="bayesian-data-analysis-2.html#cb1227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1227-6"><a href="bayesian-data-analysis-2.html#cb1227-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we&#39;ll use this model here later </span></span>
<span id="cb1227-7"><a href="bayesian-data-analysis-2.html#cb1227-7" aria-hidden="true" tabindex="-1"></a>fit.brm_poker2 <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hand <span class="sc">*</span> skill,</span>
<span id="cb1227-8"><a href="bayesian-data-analysis-2.html#cb1227-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df.poker,</span>
<span id="cb1227-9"><a href="bayesian-data-analysis-2.html#cb1227-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seed =</span> <span class="dv">1</span>, </span>
<span id="cb1227-10"><a href="bayesian-data-analysis-2.html#cb1227-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">file =</span> <span class="st">&quot;cache/brm_poker2&quot;</span>)</span>
<span id="cb1227-11"><a href="bayesian-data-analysis-2.html#cb1227-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1227-12"><a href="bayesian-data-analysis-2.html#cb1227-12" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span></span>
<span id="cb1227-13"><a href="bayesian-data-analysis-2.html#cb1227-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: balance ~ 1 + hand 
   Data: df.poker (Number of observations: 300) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept       5.94      0.41     5.10     6.73 1.00     3385     2517
handneutral     4.40      0.58     3.28     5.59 1.00     3607     2612
handgood        7.08      0.59     5.94     8.23 1.00     3719     2923

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     4.12      0.17     3.80     4.48 1.00     3893     3019

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>I use the <code>file =</code> argument to save the model’s results so that when I run this code chunk again, the model doesn’t need to be fit again (fitting Bayesian models takes a while …). And I used the <code>seed =</code> argument to make this example reproducible.</p>
<div id="full-specification" class="section level5 hasAnchor" number="23.4.2.2.1">
<h5><span class="header-section-number">23.4.2.2.1</span> Full specification<a href="bayesian-data-analysis-2.html#full-specification" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>So far, we have used the defaults that <code>brm()</code> comes with and not bothered about specifiying the priors, etc.</p>
<p>Notice that we didn’t specify any priors in the model. By default, “brms” assigns weakly informative priors to the parameters in the model. We can see what these are by running the following command:</p>
<div class="sourceCode" id="cb1229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1229-1"><a href="bayesian-data-analysis-2.html#cb1229-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1229-2"><a href="bayesian-data-analysis-2.html#cb1229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior_summary</span>()</span></code></pre></div>
<pre><code>                  prior     class        coef group resp dpar nlpar lb ub
                 (flat)         b                                        
                 (flat)         b    handgood                            
                 (flat)         b handneutral                            
 student_t(3, 9.5, 5.6) Intercept                                        
   student_t(3, 0, 5.6)     sigma                                    0   
       source
      default
 (vectorized)
 (vectorized)
      default
      default</code></pre>
<p>We can also get information about which priors need to be specified before fitting a model:</p>
<div class="sourceCode" id="cb1231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1231-1"><a href="bayesian-data-analysis-2.html#cb1231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(<span class="at">formula =</span> balance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hand,</span>
<span id="cb1231-2"><a href="bayesian-data-analysis-2.html#cb1231-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb1231-3"><a href="bayesian-data-analysis-2.html#cb1231-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> df.poker)</span></code></pre></div>
<pre><code>                  prior     class        coef group resp dpar nlpar lb ub
                 (flat)         b                                        
                 (flat)         b    handgood                            
                 (flat)         b handneutral                            
 student_t(3, 9.5, 5.6) Intercept                                        
   student_t(3, 0, 5.6)     sigma                                    0   
       source
      default
 (vectorized)
 (vectorized)
      default
      default</code></pre>
<p>Here is an example for what a more complete model specification could look like:</p>
<div class="sourceCode" id="cb1233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1233-1"><a href="bayesian-data-analysis-2.html#cb1233-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker_full <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hand,</span>
<span id="cb1233-2"><a href="bayesian-data-analysis-2.html#cb1233-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb1233-3"><a href="bayesian-data-analysis-2.html#cb1233-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">data =</span> df.poker,</span>
<span id="cb1233-4"><a href="bayesian-data-analysis-2.html#cb1233-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb1233-5"><a href="bayesian-data-analysis-2.html#cb1233-5" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">class =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb1233-6"><a href="bayesian-data-analysis-2.html#cb1233-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">coef =</span> <span class="st">&quot;handgood&quot;</span>),</span>
<span id="cb1233-7"><a href="bayesian-data-analysis-2.html#cb1233-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb1233-8"><a href="bayesian-data-analysis-2.html#cb1233-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">class =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb1233-9"><a href="bayesian-data-analysis-2.html#cb1233-9" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">coef =</span> <span class="st">&quot;handneutral&quot;</span>),</span>
<span id="cb1233-10"><a href="bayesian-data-analysis-2.html#cb1233-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">10</span>),</span>
<span id="cb1233-11"><a href="bayesian-data-analysis-2.html#cb1233-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">class =</span> <span class="st">&quot;Intercept&quot;</span>),</span>
<span id="cb1233-12"><a href="bayesian-data-analysis-2.html#cb1233-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb1233-13"><a href="bayesian-data-analysis-2.html#cb1233-13" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)),</span>
<span id="cb1233-14"><a href="bayesian-data-analysis-2.html#cb1233-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">inits =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">0</span>,</span>
<span id="cb1233-15"><a href="bayesian-data-analysis-2.html#cb1233-15" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sigma =</span> <span class="dv">1</span>,</span>
<span id="cb1233-16"><a href="bayesian-data-analysis-2.html#cb1233-16" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">handgood =</span> <span class="dv">5</span>,</span>
<span id="cb1233-17"><a href="bayesian-data-analysis-2.html#cb1233-17" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">handneutral =</span> <span class="dv">5</span>),</span>
<span id="cb1233-18"><a href="bayesian-data-analysis-2.html#cb1233-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb1233-19"><a href="bayesian-data-analysis-2.html#cb1233-19" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sigma =</span> <span class="dv">3</span>,</span>
<span id="cb1233-20"><a href="bayesian-data-analysis-2.html#cb1233-20" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">handgood =</span> <span class="dv">2</span>,</span>
<span id="cb1233-21"><a href="bayesian-data-analysis-2.html#cb1233-21" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">handneutral =</span> <span class="dv">2</span>),</span>
<span id="cb1233-22"><a href="bayesian-data-analysis-2.html#cb1233-22" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">2</span>,</span>
<span id="cb1233-23"><a href="bayesian-data-analysis-2.html#cb1233-23" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sigma =</span> <span class="dv">1</span>,</span>
<span id="cb1233-24"><a href="bayesian-data-analysis-2.html#cb1233-24" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">handgood =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb1233-25"><a href="bayesian-data-analysis-2.html#cb1233-25" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">handneutral =</span> <span class="dv">1</span>),</span>
<span id="cb1233-26"><a href="bayesian-data-analysis-2.html#cb1233-26" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">1</span>,</span>
<span id="cb1233-27"><a href="bayesian-data-analysis-2.html#cb1233-27" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sigma =</span> <span class="dv">2</span>,</span>
<span id="cb1233-28"><a href="bayesian-data-analysis-2.html#cb1233-28" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">handgood =</span> <span class="dv">2</span>,</span>
<span id="cb1233-29"><a href="bayesian-data-analysis-2.html#cb1233-29" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">handneutral =</span> <span class="sc">-</span><span class="dv">2</span>)),</span>
<span id="cb1233-30"><a href="bayesian-data-analysis-2.html#cb1233-30" aria-hidden="true" tabindex="-1"></a>                         <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb1233-31"><a href="bayesian-data-analysis-2.html#cb1233-31" aria-hidden="true" tabindex="-1"></a>                         <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1233-32"><a href="bayesian-data-analysis-2.html#cb1233-32" aria-hidden="true" tabindex="-1"></a>                         <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1233-33"><a href="bayesian-data-analysis-2.html#cb1233-33" aria-hidden="true" tabindex="-1"></a>                         <span class="at">file =</span> <span class="st">&quot;cache/brm_poker_full&quot;</span>,</span>
<span id="cb1233-34"><a href="bayesian-data-analysis-2.html#cb1233-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb1233-35"><a href="bayesian-data-analysis-2.html#cb1233-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1233-36"><a href="bayesian-data-analysis-2.html#cb1233-36" aria-hidden="true" tabindex="-1"></a>fit.brm_poker_full <span class="sc">%&gt;%</span></span>
<span id="cb1233-37"><a href="bayesian-data-analysis-2.html#cb1233-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: balance ~ 1 + hand 
   Data: df.poker (Number of observations: 300) 
  Draws: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 12000

Population-Level Effects: 
            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept       5.96      0.41     5.17     6.78 1.00     9472     7929
handneutral     4.37      0.59     3.21     5.49 1.00    10221     9046
handgood        7.05      0.59     5.89     8.20 1.00    10521     8934

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     4.13      0.17     3.81     4.47 1.00    10744     8408

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We can also take a look at the Stan code that the <code>brm()</code> function creates:</p>
<div class="sourceCode" id="cb1235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1235-1"><a href="bayesian-data-analysis-2.html#cb1235-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker_full <span class="sc">%&gt;%</span></span>
<span id="cb1235-2"><a href="bayesian-data-analysis-2.html#cb1235-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stancode</span>()</span></code></pre></div>
<pre><code>// generated with brms 2.14.4
functions {
}
data {
  int&lt;lower=1&gt; N;  // total number of observations
  vector[N] Y;  // response variable
  int&lt;lower=1&gt; K;  // number of population-level effects
  matrix[N, K] X;  // population-level design matrix
  int prior_only;  // should the likelihood be ignored?
}
transformed data {
  int Kc = K - 1;
  matrix[N, Kc] Xc;  // centered version of X without an intercept
  vector[Kc] means_X;  // column means of X before centering
  for (i in 2:K) {
    means_X[i - 1] = mean(X[, i]);
    Xc[, i - 1] = X[, i] - means_X[i - 1];
  }
}
parameters {
  vector[Kc] b;  // population-level effects
  real Intercept;  // temporary intercept for centered predictors
  real&lt;lower=0&gt; sigma;  // residual SD
}
transformed parameters {
}
model {
  // likelihood including all constants
  if (!prior_only) {
    target += normal_id_glm_lpdf(Y | Xc, Intercept, b, sigma);
  }
  // priors including all constants
  target += normal_lpdf(b[1] | 0, 10);
  target += normal_lpdf(b[2] | 0, 10);
  target += student_t_lpdf(Intercept | 3, 3, 10);
  target += student_t_lpdf(sigma | 3, 0, 10)
    - 1 * student_t_lccdf(0 | 3, 0, 10);
}
generated quantities {
  // actual population-level intercept
  real b_Intercept = Intercept - dot_product(means_X, b);
}</code></pre>
<p>One thing worth noticing: by default, “brms” centers the predictors which makes it easier to assign a default prior over the intercept.</p>
</div>
</div>
</div>
<div id="model-evaluation" class="section level3 hasAnchor" number="23.4.3">
<h3><span class="header-section-number">23.4.3</span> 3. Model evaluation<a href="bayesian-data-analysis-2.html#model-evaluation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a-did-the-inference-work" class="section level4 hasAnchor" number="23.4.3.1">
<h4><span class="header-section-number">23.4.3.1</span> a) Did the inference work?<a href="bayesian-data-analysis-2.html#a-did-the-inference-work" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>So far, we’ve assumed that the inference has worked out. We can check this by running <code>plot()</code> on our brm object:</p>
<div class="sourceCode" id="cb1237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1237-1"><a href="bayesian-data-analysis-2.html#cb1237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.brm_poker,</span>
<span id="cb1237-2"><a href="bayesian-data-analysis-2.html#cb1237-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">N =</span> <span class="dv">7</span>,</span>
<span id="cb1237-3"><a href="bayesian-data-analysis-2.html#cb1237-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ask =</span> F)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-11-1.png" width="960" /></p>
<p>The posterior distributions (left hand side), and the trace plots of the samples from the posterior (right hand side) look good.</p>
<p>Let’s make our own version of a trace plot for one parameter in the model:</p>
<div class="sourceCode" id="cb1238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1238-1"><a href="bayesian-data-analysis-2.html#cb1238-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1238-2"><a href="bayesian-data-analysis-2.html#cb1238-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(b_Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb1238-3"><a href="bayesian-data-analysis-2.html#cb1238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1238-4"><a href="bayesian-data-analysis-2.html#cb1238-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> <span class="fu">as.factor</span>(chain)) <span class="sc">%&gt;%</span> </span>
<span id="cb1238-5"><a href="bayesian-data-analysis-2.html#cb1238-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> iteration,</span>
<span id="cb1238-6"><a href="bayesian-data-analysis-2.html#cb1238-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> b_intercept,</span>
<span id="cb1238-7"><a href="bayesian-data-analysis-2.html#cb1238-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> chain,</span>
<span id="cb1238-8"><a href="bayesian-data-analysis-2.html#cb1238-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> chain)) <span class="sc">+</span> </span>
<span id="cb1238-9"><a href="bayesian-data-analysis-2.html#cb1238-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb1238-10"><a href="bayesian-data-analysis-2.html#cb1238-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;seq&quot;</span>,</span>
<span id="cb1238-11"><a href="bayesian-data-analysis-2.html#cb1238-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>We can also take a look at the auto-correlation plot. Ideally, we want to generate independent samples from the posterior. So we don’t want subsequent samples to be strongly correlated with each other. Let’s take a look:</p>
<div class="sourceCode" id="cb1239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1239-1"><a href="bayesian-data-analysis-2.html#cb1239-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">=</span> fit.brm_poker <span class="sc">%&gt;%</span></span>
<span id="cb1239-2"><a href="bayesian-data-analysis-2.html#cb1239-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_variables</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1239-3"><a href="bayesian-data-analysis-2.html#cb1239-3" aria-hidden="true" tabindex="-1"></a>  .[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb1239-4"><a href="bayesian-data-analysis-2.html#cb1239-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1239-5"><a href="bayesian-data-analysis-2.html#cb1239-5" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1239-6"><a href="bayesian-data-analysis-2.html#cb1239-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1239-7"><a href="bayesian-data-analysis-2.html#cb1239-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mcmc_acf</span>(<span class="at">pars =</span> variables,</span>
<span id="cb1239-8"><a href="bayesian-data-analysis-2.html#cb1239-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">lags =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>Warning: Method &#39;posterior_samples&#39; is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Looking good! The autocorrelation should become very small as the lag increases (indicating that we are getting independent samples from the posterior).</p>
<div id="when-things-go-wrong" class="section level6 hasAnchor" number="23.4.3.1.0.1">
<h6><span class="header-section-number">23.4.3.1.0.1</span> When things go wrong<a href="bayesian-data-analysis-2.html#when-things-go-wrong" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>Let’s try to fit a model to very little data (just two observations) with extremely uninformative priors:</p>
<div class="sourceCode" id="cb1241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1241-1"><a href="bayesian-data-analysis-2.html#cb1241-1" aria-hidden="true" tabindex="-1"></a>df.data <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1241-2"><a href="bayesian-data-analysis-2.html#cb1241-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1241-3"><a href="bayesian-data-analysis-2.html#cb1241-3" aria-hidden="true" tabindex="-1"></a>fit.brm_wrong <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">data =</span> df.data,</span>
<span id="cb1241-4"><a href="bayesian-data-analysis-2.html#cb1241-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> gaussian,</span>
<span id="cb1241-5"><a href="bayesian-data-analysis-2.html#cb1241-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1241-6"><a href="bayesian-data-analysis-2.html#cb1241-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="sc">-</span><span class="fl">1e10</span>, <span class="fl">1e10</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1241-7"><a href="bayesian-data-analysis-2.html#cb1241-7" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">prior</span>(<span class="fu">uniform</span>(<span class="dv">0</span>, <span class="fl">1e10</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1241-8"><a href="bayesian-data-analysis-2.html#cb1241-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">inits =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>),</span>
<span id="cb1241-9"><a href="bayesian-data-analysis-2.html#cb1241-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">0</span>, <span class="at">sigma =</span> <span class="dv">1</span>)),</span>
<span id="cb1241-10"><a href="bayesian-data-analysis-2.html#cb1241-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb1241-11"><a href="bayesian-data-analysis-2.html#cb1241-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1241-12"><a href="bayesian-data-analysis-2.html#cb1241-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb1241-13"><a href="bayesian-data-analysis-2.html#cb1241-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">file =</span> <span class="st">&quot;cache/brm_wrong&quot;</span>)</span></code></pre></div>
<p>Let’s take a look at the posterior distributions of the model parameters:</p>
<div class="sourceCode" id="cb1242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1242-1"><a href="bayesian-data-analysis-2.html#cb1242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.brm_wrong)</span></code></pre></div>
<pre><code>Warning: Parts of the model have not converged (some Rhats are &gt; 1.05). Be
careful when analysing the results! We recommend running more iterations and/or
setting stronger priors.</code></pre>
<pre><code>Warning: There were 1348 divergent transitions after warmup.
Increasing adapt_delta above 0.8 may help. See http://mc-stan.org/misc/
warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: y ~ 1 
   Data: df.data (Number of observations: 2) 
  Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 6000

Population-Level Effects: 
              Estimate     Est.Error       l-95% CI      u-95% CI Rhat Bulk_ESS
Intercept -44780254.01 1085496757.06 -3091150221.00 2498148317.09 1.73      218
          Tail_ESS
Intercept      113

Family Specific Parameters: 
          Estimate     Est.Error l-95% CI      u-95% CI Rhat Bulk_ESS Tail_ESS
sigma 924899544.31 1859482970.46 22790.00 6962912540.71 1.69        3       64

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Not looking good – The estimates and credible intervals are off the charts. And the effective samples sizes in the chains are very small.</p>
<p>Let’s visualize the trace plots:</p>
<div class="sourceCode" id="cb1246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1246-1"><a href="bayesian-data-analysis-2.html#cb1246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.brm_wrong,</span>
<span id="cb1246-2"><a href="bayesian-data-analysis-2.html#cb1246-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">N =</span> <span class="dv">2</span>, </span>
<span id="cb1246-3"><a href="bayesian-data-analysis-2.html#cb1246-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ask =</span> F)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-16-1.png" width="1152" /></p>
<div class="sourceCode" id="cb1247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1247-1"><a href="bayesian-data-analysis-2.html#cb1247-1" aria-hidden="true" tabindex="-1"></a>fit.brm_wrong <span class="sc">%&gt;%</span> </span>
<span id="cb1247-2"><a href="bayesian-data-analysis-2.html#cb1247-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(b_Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb1247-3"><a href="bayesian-data-analysis-2.html#cb1247-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1247-4"><a href="bayesian-data-analysis-2.html#cb1247-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> <span class="fu">as.factor</span>(chain)) <span class="sc">%&gt;%</span> </span>
<span id="cb1247-5"><a href="bayesian-data-analysis-2.html#cb1247-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> iteration,</span>
<span id="cb1247-6"><a href="bayesian-data-analysis-2.html#cb1247-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> b_intercept,</span>
<span id="cb1247-7"><a href="bayesian-data-analysis-2.html#cb1247-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> chain,</span>
<span id="cb1247-8"><a href="bayesian-data-analysis-2.html#cb1247-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> chain)) <span class="sc">+</span> </span>
<span id="cb1247-9"><a href="bayesian-data-analysis-2.html#cb1247-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb1247-10"><a href="bayesian-data-analysis-2.html#cb1247-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Given that we have so little data in this case, we need to help the model a little bit by providing some slighlty more specific priors.</p>
<div class="sourceCode" id="cb1248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1248-1"><a href="bayesian-data-analysis-2.html#cb1248-1" aria-hidden="true" tabindex="-1"></a>fit.brm_right <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">data =</span> df.data,</span>
<span id="cb1248-2"><a href="bayesian-data-analysis-2.html#cb1248-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> gaussian,</span>
<span id="cb1248-3"><a href="bayesian-data-analysis-2.html#cb1248-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb1248-4"><a href="bayesian-data-analysis-2.html#cb1248-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> Intercept), <span class="co"># more reasonable priors</span></span>
<span id="cb1248-5"><a href="bayesian-data-analysis-2.html#cb1248-5" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">prior</span>(<span class="fu">cauchy</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1248-6"><a href="bayesian-data-analysis-2.html#cb1248-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb1248-7"><a href="bayesian-data-analysis-2.html#cb1248-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1248-8"><a href="bayesian-data-analysis-2.html#cb1248-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">chains =</span> <span class="dv">2</span>,</span>
<span id="cb1248-9"><a href="bayesian-data-analysis-2.html#cb1248-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seed =</span> <span class="dv">1</span>,</span>
<span id="cb1248-10"><a href="bayesian-data-analysis-2.html#cb1248-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">file =</span> <span class="st">&quot;cache/brm_right&quot;</span>)</span></code></pre></div>
<p>Let’s take a look at the posterior distributions of the model parameters:</p>
<div class="sourceCode" id="cb1249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1249-1"><a href="bayesian-data-analysis-2.html#cb1249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.brm_right)</span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: y ~ 1 
   Data: df.data (Number of observations: 2) 
  Draws: 2 chains, each with iter = 4000; warmup = 1000; thin = 1;
         total post-warmup draws = 6000

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept    -0.03      1.72    -3.62     3.50 1.00     1240     1015

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     2.07      2.03     0.59     6.69 1.00     1180     1608

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>This looks much better. There is still quite a bit of uncertainty in our paremeter estimates, but it has reduced dramatically.</p>
<p>Let’s visualize the trace plots:</p>
<div class="sourceCode" id="cb1251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1251-1"><a href="bayesian-data-analysis-2.html#cb1251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.brm_right,</span>
<span id="cb1251-2"><a href="bayesian-data-analysis-2.html#cb1251-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">N =</span> <span class="dv">2</span>, </span>
<span id="cb1251-3"><a href="bayesian-data-analysis-2.html#cb1251-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ask =</span> F)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<div class="sourceCode" id="cb1252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1252-1"><a href="bayesian-data-analysis-2.html#cb1252-1" aria-hidden="true" tabindex="-1"></a>fit.brm_right <span class="sc">%&gt;%</span> </span>
<span id="cb1252-2"><a href="bayesian-data-analysis-2.html#cb1252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread_draws</span>(b_Intercept, sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-3"><a href="bayesian-data-analysis-2.html#cb1252-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1252-4"><a href="bayesian-data-analysis-2.html#cb1252-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chain =</span> <span class="fu">as.factor</span>(chain)) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-5"><a href="bayesian-data-analysis-2.html#cb1252-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(b_intercept, sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb1252-6"><a href="bayesian-data-analysis-2.html#cb1252-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> iteration,</span>
<span id="cb1252-7"><a href="bayesian-data-analysis-2.html#cb1252-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> value,</span>
<span id="cb1252-8"><a href="bayesian-data-analysis-2.html#cb1252-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> chain,</span>
<span id="cb1252-9"><a href="bayesian-data-analysis-2.html#cb1252-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> chain)) <span class="sc">+</span> </span>
<span id="cb1252-10"><a href="bayesian-data-analysis-2.html#cb1252-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb1252-11"><a href="bayesian-data-analysis-2.html#cb1252-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(name), <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb1252-12"><a href="bayesian-data-analysis-2.html#cb1252-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Looking mostly good!</p>
</div>
</div>
<div id="b-visualize-model-predictions" class="section level4 hasAnchor" number="23.4.3.2">
<h4><span class="header-section-number">23.4.3.2</span> b) Visualize model predictions<a href="bayesian-data-analysis-2.html#b-visualize-model-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="posterior-predictive-check-1" class="section level5 hasAnchor" number="23.4.3.2.1">
<h5><span class="header-section-number">23.4.3.2.1</span> Posterior predictive check<a href="bayesian-data-analysis-2.html#posterior-predictive-check-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To check whether the model did a good job capturing the data, we can simulate what future data the Bayesian model predicts, now that it has learned from the data we feed into it.</p>
<div class="sourceCode" id="cb1253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1253-1"><a href="bayesian-data-analysis-2.html#cb1253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit.brm_poker, <span class="at">nsamples =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>Warning: Argument &#39;nsamples&#39; is deprecated. Please use argument &#39;ndraws&#39;
instead.</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>This looks good! The predicted shaped of the data based on samples from the posterior distribution looks very similar to the shape of the actual data.</p>
<p>Let’s make a hypothetical outcome plot that shows what concrete data sets the model would predict. The <code>add_predicted_draws()</code> function from the “tidybayes” package is helpful for generating predictions from the posterior.</p>
<div class="sourceCode" id="cb1255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1255-1"><a href="bayesian-data-analysis-2.html#cb1255-1" aria-hidden="true" tabindex="-1"></a>df.predictive_samples <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb1255-2"><a href="bayesian-data-analysis-2.html#cb1255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predicted_draws</span>(<span class="at">newdata =</span> .,</span>
<span id="cb1255-3"><a href="bayesian-data-analysis-2.html#cb1255-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">object =</span> fit.brm_poker2,</span>
<span id="cb1255-4"><a href="bayesian-data-analysis-2.html#cb1255-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ndraws =</span> <span class="dv">10</span>)</span>
<span id="cb1255-5"><a href="bayesian-data-analysis-2.html#cb1255-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1255-6"><a href="bayesian-data-analysis-2.html#cb1255-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.predictive_samples,</span>
<span id="cb1255-7"><a href="bayesian-data-analysis-2.html#cb1255-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand,</span>
<span id="cb1255-8"><a href="bayesian-data-analysis-2.html#cb1255-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> .prediction,</span>
<span id="cb1255-9"><a href="bayesian-data-analysis-2.html#cb1255-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> hand,</span>
<span id="cb1255-10"><a href="bayesian-data-analysis-2.html#cb1255-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">group =</span> skill,</span>
<span id="cb1255-11"><a href="bayesian-data-analysis-2.html#cb1255-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">shape =</span> skill)) <span class="sc">+</span> </span>
<span id="cb1255-12"><a href="bayesian-data-analysis-2.html#cb1255-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb1255-13"><a href="bayesian-data-analysis-2.html#cb1255-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">dodge.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb1255-14"><a href="bayesian-data-analysis-2.html#cb1255-14" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">jitter.height =</span> <span class="dv">0</span>, </span>
<span id="cb1255-15"><a href="bayesian-data-analysis-2.html#cb1255-15" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">jitter.width =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb1255-16"><a href="bayesian-data-analysis-2.html#cb1255-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb1255-17"><a href="bayesian-data-analysis-2.html#cb1255-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>),</span>
<span id="cb1255-18"><a href="bayesian-data-analysis-2.html#cb1255-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb1255-19"><a href="bayesian-data-analysis-2.html#cb1255-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;final balance (in Euros)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1255-20"><a href="bayesian-data-analysis-2.html#cb1255-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">22</span>)) <span class="sc">+</span> </span>
<span id="cb1255-21"><a href="bayesian-data-analysis-2.html#cb1255-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>)),</span>
<span id="cb1255-22"><a href="bayesian-data-analysis-2.html#cb1255-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb1255-23"><a href="bayesian-data-analysis-2.html#cb1255-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_manual</span>(.draw)</span>
<span id="cb1255-24"><a href="bayesian-data-analysis-2.html#cb1255-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1255-25"><a href="bayesian-data-analysis-2.html#cb1255-25" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(p, <span class="at">nframes =</span> <span class="dv">120</span>, <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="at">res =</span> <span class="dv">96</span>, <span class="at">type =</span> <span class="st">&quot;cairo&quot;</span>)</span></code></pre></div>
<pre><code>nframes and fps adjusted to match transition</code></pre>
<pre><code>Rendering [========&gt;-----------------------------------] at 6.6 fps ~ eta: 1s
Rendering [=============&gt;--------------------------------] at 7 fps ~ eta: 1s
Rendering [=================&gt;--------------------------] at 7.3 fps ~ eta: 1s
Rendering [=====================&gt;----------------------] at 7.4 fps ~ eta: 1s
Rendering [=========================&gt;------------------] at 7.5 fps ~ eta: 1s
Rendering [==============================&gt;-------------] at 7.6 fps ~ eta: 0s
Rendering [==================================&gt;---------] at 7.5 fps ~ eta: 0s
Rendering [=======================================&gt;----] at 7.6 fps ~ eta: 0s
Rendering [============================================] at 7.7 fps ~ eta: 0s</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-23-1.gif" /><!-- --></p>
</div>
<div id="prior-predictive-check-1" class="section level5 hasAnchor" number="23.4.3.2.2">
<h5><span class="header-section-number">23.4.3.2.2</span> Prior predictive check<a href="bayesian-data-analysis-2.html#prior-predictive-check-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb1258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1258-1"><a href="bayesian-data-analysis-2.html#cb1258-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker_prior <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> hand <span class="sc">*</span> skill,</span>
<span id="cb1258-2"><a href="bayesian-data-analysis-2.html#cb1258-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb1258-3"><a href="bayesian-data-analysis-2.html#cb1258-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> df.poker,</span>
<span id="cb1258-4"><a href="bayesian-data-analysis-2.html#cb1258-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> <span class="st">&quot;b&quot;</span>),</span>
<span id="cb1258-5"><a href="bayesian-data-analysis-2.html#cb1258-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> <span class="st">&quot;sigma&quot;</span>)),</span>
<span id="cb1258-6"><a href="bayesian-data-analysis-2.html#cb1258-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">iter =</span> <span class="dv">4000</span>,</span>
<span id="cb1258-7"><a href="bayesian-data-analysis-2.html#cb1258-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb1258-8"><a href="bayesian-data-analysis-2.html#cb1258-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1258-9"><a href="bayesian-data-analysis-2.html#cb1258-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">file =</span> <span class="st">&quot;cache/brm_poker_prior&quot;</span>,</span>
<span id="cb1258-10"><a href="bayesian-data-analysis-2.html#cb1258-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">sample_prior =</span> <span class="st">&quot;only&quot;</span>,</span>
<span id="cb1258-11"><a href="bayesian-data-analysis-2.html#cb1258-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb1258-12"><a href="bayesian-data-analysis-2.html#cb1258-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1258-13"><a href="bayesian-data-analysis-2.html#cb1258-13" aria-hidden="true" tabindex="-1"></a><span class="co"># generate prior samples </span></span>
<span id="cb1258-14"><a href="bayesian-data-analysis-2.html#cb1258-14" aria-hidden="true" tabindex="-1"></a>df.prior_samples <span class="ot">=</span> df.poker <span class="sc">%&gt;%</span> </span>
<span id="cb1258-15"><a href="bayesian-data-analysis-2.html#cb1258-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predicted_draws</span>(<span class="at">newdata =</span> .,</span>
<span id="cb1258-16"><a href="bayesian-data-analysis-2.html#cb1258-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">object =</span> fit.brm_poker_prior,</span>
<span id="cb1258-17"><a href="bayesian-data-analysis-2.html#cb1258-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ndraws =</span> <span class="dv">10</span>)</span>
<span id="cb1258-18"><a href="bayesian-data-analysis-2.html#cb1258-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1258-19"><a href="bayesian-data-analysis-2.html#cb1258-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the results as an animation</span></span>
<span id="cb1258-20"><a href="bayesian-data-analysis-2.html#cb1258-20" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df.prior_samples,</span>
<span id="cb1258-21"><a href="bayesian-data-analysis-2.html#cb1258-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hand,</span>
<span id="cb1258-22"><a href="bayesian-data-analysis-2.html#cb1258-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> .prediction,</span>
<span id="cb1258-23"><a href="bayesian-data-analysis-2.html#cb1258-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> hand,</span>
<span id="cb1258-24"><a href="bayesian-data-analysis-2.html#cb1258-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">group =</span> skill,</span>
<span id="cb1258-25"><a href="bayesian-data-analysis-2.html#cb1258-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">shape =</span> skill)) <span class="sc">+</span> </span>
<span id="cb1258-26"><a href="bayesian-data-analysis-2.html#cb1258-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb1258-27"><a href="bayesian-data-analysis-2.html#cb1258-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitterdodge</span>(<span class="at">dodge.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb1258-28"><a href="bayesian-data-analysis-2.html#cb1258-28" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">jitter.height =</span> <span class="dv">0</span>, </span>
<span id="cb1258-29"><a href="bayesian-data-analysis-2.html#cb1258-29" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">jitter.width =</span> <span class="fl">0.2</span>)) <span class="sc">+</span> </span>
<span id="cb1258-30"><a href="bayesian-data-analysis-2.html#cb1258-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb1258-31"><a href="bayesian-data-analysis-2.html#cb1258-31" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>),</span>
<span id="cb1258-32"><a href="bayesian-data-analysis-2.html#cb1258-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb1258-33"><a href="bayesian-data-analysis-2.html#cb1258-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;final balance (in Euros)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1258-34"><a href="bayesian-data-analysis-2.html#cb1258-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">22</span>)) <span class="sc">+</span> </span>
<span id="cb1258-35"><a href="bayesian-data-analysis-2.html#cb1258-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1258-36"><a href="bayesian-data-analysis-2.html#cb1258-36" aria-hidden="true" tabindex="-1"></a>                                                 <span class="at">fill =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Set1&quot;</span>))),</span>
<span id="cb1258-37"><a href="bayesian-data-analysis-2.html#cb1258-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">shape =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>))) <span class="sc">+</span> </span>
<span id="cb1258-38"><a href="bayesian-data-analysis-2.html#cb1258-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_manual</span>(.draw)</span>
<span id="cb1258-39"><a href="bayesian-data-analysis-2.html#cb1258-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1258-40"><a href="bayesian-data-analysis-2.html#cb1258-40" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(p, <span class="at">nframes =</span> <span class="dv">120</span>, <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="at">res =</span> <span class="dv">96</span>, <span class="at">type =</span> <span class="st">&quot;cairo&quot;</span>)</span></code></pre></div>
<pre><code>nframes and fps adjusted to match transition</code></pre>
<pre><code>Rendering [========&gt;-----------------------------------] at 7.5 fps ~ eta: 1s
Rendering [============&gt;-------------------------------] at 7.5 fps ~ eta: 1s
Rendering [=================&gt;--------------------------] at 7.3 fps ~ eta: 1s
Rendering [=====================&gt;----------------------] at 7.2 fps ~ eta: 1s
Rendering [=========================&gt;------------------] at 7.3 fps ~ eta: 1s
Rendering [==============================&gt;-------------] at 7.2 fps ~ eta: 0s
Rendering [==================================&gt;---------] at 7.2 fps ~ eta: 0s
Rendering [=======================================&gt;----] at 7.2 fps ~ eta: 0s
Rendering [============================================] at 7.2 fps ~ eta: 0s</code></pre>
<div class="sourceCode" id="cb1261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1261-1"><a href="bayesian-data-analysis-2.html#cb1261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anim_save(&quot;poker_prior_predictive.gif&quot;)</span></span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-24-1.gif" /><!-- --></p>
</div>
</div>
</div>
<div id="interpret-the-model-parameters" class="section level3 hasAnchor" number="23.4.4">
<h3><span class="header-section-number">23.4.4</span> 4. Interpret the model parameters<a href="bayesian-data-analysis-2.html#interpret-the-model-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="visualize-the-posteriors-1" class="section level4 hasAnchor" number="23.4.4.1">
<h4><span class="header-section-number">23.4.4.1</span> Visualize the posteriors<a href="bayesian-data-analysis-2.html#visualize-the-posteriors-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s visualize what the posterior for the different parameters looks like. We use the <code>stat_halfeye()</code> function from the “tidybayes” package to do so:</p>
<div class="sourceCode" id="cb1262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1262-1"><a href="bayesian-data-analysis-2.html#cb1262-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1262-2"><a href="bayesian-data-analysis-2.html#cb1262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1262-3"><a href="bayesian-data-analysis-2.html#cb1262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1262-4"><a href="bayesian-data-analysis-2.html#cb1262-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;b_&quot;</span>), sigma) <span class="sc">%&gt;%</span></span>
<span id="cb1262-5"><a href="bayesian-data-analysis-2.html#cb1262-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb1262-6"><a href="bayesian-data-analysis-2.html#cb1262-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>,</span>
<span id="cb1262-7"><a href="bayesian-data-analysis-2.html#cb1262-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1262-8"><a href="bayesian-data-analysis-2.html#cb1262-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1262-9"><a href="bayesian-data-analysis-2.html#cb1262-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_rev</span>(variable),</span>
<span id="cb1262-10"><a href="bayesian-data-analysis-2.html#cb1262-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb1262-11"><a href="bayesian-data-analysis-2.html#cb1262-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1262-12"><a href="bayesian-data-analysis-2.html#cb1262-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<pre><code>Warning: Method &#39;posterior_samples&#39; is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
<div id="compute-highest-density-intervals" class="section level4 hasAnchor" number="23.4.4.2">
<h4><span class="header-section-number">23.4.4.2</span> Compute highest density intervals<a href="bayesian-data-analysis-2.html#compute-highest-density-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To compute the MAP (maximum a posteriori probability) estimate and highest density interval, we use the <code>mean_hdi()</code> function that comes with the “tidybayes” package.</p>
<div class="sourceCode" id="cb1264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1264-1"><a href="bayesian-data-analysis-2.html#cb1264-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1264-2"><a href="bayesian-data-analysis-2.html#cb1264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1264-3"><a href="bayesian-data-analysis-2.html#cb1264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1264-4"><a href="bayesian-data-analysis-2.html#cb1264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;b_&quot;</span>), sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb1264-5"><a href="bayesian-data-analysis-2.html#cb1264-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_hdi</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1264-6"><a href="bayesian-data-analysis-2.html#cb1264-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(.width<span class="sc">:</span>.interval),</span>
<span id="cb1264-7"><a href="bayesian-data-analysis-2.html#cb1264-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;index&quot;</span>,</span>
<span id="cb1264-8"><a href="bayesian-data-analysis-2.html#cb1264-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1264-9"><a href="bayesian-data-analysis-2.html#cb1264-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(index, value) <span class="sc">%&gt;%</span> </span>
<span id="cb1264-10"><a href="bayesian-data-analysis-2.html#cb1264-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">ifelse</span>(<span class="fu">str_detect</span>(index, <span class="fu">fixed</span>(<span class="st">&quot;.&quot;</span>)), index, <span class="fu">str_c</span>(index, <span class="st">&quot;.mean&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1264-11"><a href="bayesian-data-analysis-2.html#cb1264-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(index, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;parameter&quot;</span>, <span class="st">&quot;type&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1264-12"><a href="bayesian-data-analysis-2.html#cb1264-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> type, </span>
<span id="cb1264-13"><a href="bayesian-data-analysis-2.html#cb1264-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> value)</span></code></pre></div>
<pre><code>Warning: Method &#39;posterior_samples&#39; is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
<pre><code># A tibble: 4 × 4
  parameter      mean lower upper
  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 b_intercept    5.94  5.16  6.78
2 b_handneutral  4.40  3.24  5.52
3 b_handgood     7.08  5.92  8.20
4 sigma          4.12  3.79  4.45</code></pre>
</div>
</div>
<div id="test-specific-hypotheses" class="section level3 hasAnchor" number="23.4.5">
<h3><span class="header-section-number">23.4.5</span> 5. Test specific hypotheses<a href="bayesian-data-analysis-2.html#test-specific-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="with-hypothesis" class="section level4 hasAnchor" number="23.4.5.1">
<h4><span class="header-section-number">23.4.5.1</span> with <code>hypothesis()</code><a href="bayesian-data-analysis-2.html#with-hypothesis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>One key advantage of Bayesian over frequentist analysis is that we can test hypothesis in a very flexible manner by directly probing our posterior samples in different ways.</p>
<p>We may ask, for example, what the probability is that the parameter for the difference between a bad hand and a neutral hand (<code>b_handneutral</code>) is greater than 0. Let’s plot the posterior distribution together with the criterion:</p>
<div class="sourceCode" id="cb1267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1267-1"><a href="bayesian-data-analysis-2.html#cb1267-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1267-2"><a href="bayesian-data-analysis-2.html#cb1267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1267-3"><a href="bayesian-data-analysis-2.html#cb1267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(b_handneutral) <span class="sc">%&gt;%</span> </span>
<span id="cb1267-4"><a href="bayesian-data-analysis-2.html#cb1267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb1267-5"><a href="bayesian-data-analysis-2.html#cb1267-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>,</span>
<span id="cb1267-6"><a href="bayesian-data-analysis-2.html#cb1267-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1267-7"><a href="bayesian-data-analysis-2.html#cb1267-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1267-8"><a href="bayesian-data-analysis-2.html#cb1267-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> variable, <span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb1267-9"><a href="bayesian-data-analysis-2.html#cb1267-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1267-10"><a href="bayesian-data-analysis-2.html#cb1267-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>,</span>
<span id="cb1267-11"><a href="bayesian-data-analysis-2.html#cb1267-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Method &#39;posterior_samples&#39; is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>We see that the posterior is definitely greater than 0.</p>
<p>We can ask many different kinds of questions about the data by doing basic arithmetic on our posterior samples. The <code>hypothesis()</code> function makes this even easier. Here are some examples:</p>
<div class="sourceCode" id="cb1269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1269-1"><a href="bayesian-data-analysis-2.html#cb1269-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the probability that the posterior for handneutral is less than 0</span></span>
<span id="cb1269-2"><a href="bayesian-data-analysis-2.html#cb1269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(fit.brm_poker,</span>
<span id="cb1269-3"><a href="bayesian-data-analysis-2.html#cb1269-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">hypothesis =</span> <span class="st">&quot;handneutral &lt; 0&quot;</span>)</span></code></pre></div>
<pre><code>Hypothesis Tests for class b:
         Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob
1 (handneutral) &lt; 0      4.4      0.58     3.47     5.38          0         0
  Star
1     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<div class="sourceCode" id="cb1271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1271-1"><a href="bayesian-data-analysis-2.html#cb1271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the probability that the posterior for handneutral is greater than 4</span></span>
<span id="cb1271-2"><a href="bayesian-data-analysis-2.html#cb1271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(fit.brm_poker,</span>
<span id="cb1271-3"><a href="bayesian-data-analysis-2.html#cb1271-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">hypothesis =</span> <span class="st">&quot;handneutral &gt; 4&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1271-4"><a href="bayesian-data-analysis-2.html#cb1271-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb1272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1272-1"><a href="bayesian-data-analysis-2.html#cb1272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the probability that good hands make twice as much as bad hands</span></span>
<span id="cb1272-2"><a href="bayesian-data-analysis-2.html#cb1272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(fit.brm_poker,</span>
<span id="cb1272-3"><a href="bayesian-data-analysis-2.html#cb1272-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">hypothesis =</span> <span class="st">&quot;Intercept + handgood &gt; 2 * Intercept&quot;</span>)</span></code></pre></div>
<pre><code>Hypothesis Tests for class b:
                Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio
1 (Intercept+handgo... &gt; 0     1.14      0.92    -0.37     2.68       8.55
  Post.Prob Star
1       0.9     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>We can also make a plot of what the posterior distribution of the hypothesis looks like:</p>
<div class="sourceCode" id="cb1274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1274-1"><a href="bayesian-data-analysis-2.html#cb1274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(fit.brm_poker,</span>
<span id="cb1274-2"><a href="bayesian-data-analysis-2.html#cb1274-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">hypothesis =</span> <span class="st">&quot;Intercept + handgood &gt; 2 * Intercept&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1274-3"><a href="bayesian-data-analysis-2.html#cb1274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb1275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1275-1"><a href="bayesian-data-analysis-2.html#cb1275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the probability that neutral hands make less than the average of bad and good hands</span></span>
<span id="cb1275-2"><a href="bayesian-data-analysis-2.html#cb1275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(fit.brm_poker,</span>
<span id="cb1275-3"><a href="bayesian-data-analysis-2.html#cb1275-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">hypothesis =</span> <span class="st">&quot;Intercept + handneutral &lt; (Intercept + Intercept + handgood) / 2&quot;</span>)</span></code></pre></div>
<pre><code>Hypothesis Tests for class b:
                Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio
1 (Intercept+handne... &lt; 0     0.86      0.51     0.02      1.7       0.05
  Post.Prob Star
1      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>Let’s double check one example, and calculate the result directly based on the posterior samples:</p>
<div class="sourceCode" id="cb1277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1277-1"><a href="bayesian-data-analysis-2.html#cb1277-1" aria-hidden="true" tabindex="-1"></a>df.hypothesis <span class="ot">=</span> fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1277-2"><a href="bayesian-data-analysis-2.html#cb1277-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1277-3"><a href="bayesian-data-analysis-2.html#cb1277-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1277-4"><a href="bayesian-data-analysis-2.html#cb1277-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;b_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1277-5"><a href="bayesian-data-analysis-2.html#cb1277-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neutral =</span> b_intercept <span class="sc">+</span> b_handneutral,</span>
<span id="cb1277-6"><a href="bayesian-data-analysis-2.html#cb1277-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">bad_good_average =</span> (b_intercept <span class="sc">+</span> b_intercept <span class="sc">+</span> b_handgood)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb1277-7"><a href="bayesian-data-analysis-2.html#cb1277-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">hypothesis =</span> neutral <span class="sc">&lt;</span> bad_good_average)</span></code></pre></div>
<pre><code>Warning: Method &#39;posterior_samples&#39; is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
<div class="sourceCode" id="cb1279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1279-1"><a href="bayesian-data-analysis-2.html#cb1279-1" aria-hidden="true" tabindex="-1"></a>df.hypothesis <span class="sc">%&gt;%</span> </span>
<span id="cb1279-2"><a href="bayesian-data-analysis-2.html#cb1279-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">p =</span> <span class="fu">sum</span>(hypothesis)<span class="sc">/</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code>      p
1 0.045</code></pre>
</div>
<div id="with-emmeans" class="section level4 hasAnchor" number="23.4.5.2">
<h4><span class="header-section-number">23.4.5.2</span> with <code>emmeans()</code><a href="bayesian-data-analysis-2.html#with-emmeans" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can also use the <code>emmeans()</code> function to compute contrasts.</p>
<div class="sourceCode" id="cb1281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1281-1"><a href="bayesian-data-analysis-2.html#cb1281-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1281-2"><a href="bayesian-data-analysis-2.html#cb1281-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> consec <span class="sc">~</span> hand)</span></code></pre></div>
<pre><code>Loading required namespace: rstanarm</code></pre>
<pre><code>$emmeans
 hand    emmean lower.HPD upper.HPD
 bad       5.94      5.16      6.78
 neutral  10.34      9.55     11.15
 good     13.02     12.22     13.82

Point estimate displayed: median 
HPD interval probability: 0.95 

$contrasts
 contrast       estimate lower.HPD upper.HPD
 neutral - bad      4.38      3.24      5.52
 good - neutral     2.69      1.51      3.78

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
<p>Here, it computed the estimated means for each group for us, as well as the consecutive contrasts between each group.</p>
<p>Let’s visualize the contrasts. First, let’s just use the <code>plot()</code> function as it’s been adapted by the emmeans package:</p>
<div class="sourceCode" id="cb1284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1284-1"><a href="bayesian-data-analysis-2.html#cb1284-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1284-2"><a href="bayesian-data-analysis-2.html#cb1284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> consec <span class="sc">~</span> hand) <span class="sc">%&gt;%</span> </span>
<span id="cb1284-3"><a href="bayesian-data-analysis-2.html#cb1284-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1284-4"><a href="bayesian-data-analysis-2.html#cb1284-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>To get full posterior distributions instead of summaries, we can use the “tidybayes” package like so:</p>
<div class="sourceCode" id="cb1285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1285-1"><a href="bayesian-data-analysis-2.html#cb1285-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1285-2"><a href="bayesian-data-analysis-2.html#cb1285-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> consec <span class="sc">~</span> hand) <span class="sc">%&gt;%</span> </span>
<span id="cb1285-3"><a href="bayesian-data-analysis-2.html#cb1285-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1285-4"><a href="bayesian-data-analysis-2.html#cb1285-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_emmeans_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1285-5"><a href="bayesian-data-analysis-2.html#cb1285-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> contrast,</span>
<span id="cb1285-6"><a href="bayesian-data-analysis-2.html#cb1285-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> .value)) <span class="sc">+</span> </span>
<span id="cb1285-7"><a href="bayesian-data-analysis-2.html#cb1285-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb1285-8"><a href="bayesian-data-analysis-2.html#cb1285-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">point_interval =</span> mean_hdi,</span>
<span id="cb1285-9"><a href="bayesian-data-analysis-2.html#cb1285-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">.width =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span>))</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>To see whether neutral hands did differently from bad and good hands (combined), we can define the following contrast.</p>
<div class="sourceCode" id="cb1286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1286-1"><a href="bayesian-data-analysis-2.html#cb1286-1" aria-hidden="true" tabindex="-1"></a>contrasts <span class="ot">=</span> <span class="fu">list</span>(<span class="at">neutral_vs_rest =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb1286-2"><a href="bayesian-data-analysis-2.html#cb1286-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1286-3"><a href="bayesian-data-analysis-2.html#cb1286-3" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1286-4"><a href="bayesian-data-analysis-2.html#cb1286-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> <span class="st">&quot;hand&quot;</span>,</span>
<span id="cb1286-5"><a href="bayesian-data-analysis-2.html#cb1286-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">contr =</span> contrasts) <span class="sc">%&gt;%</span> </span>
<span id="cb1286-6"><a href="bayesian-data-analysis-2.html#cb1286-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1286-7"><a href="bayesian-data-analysis-2.html#cb1286-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_emmeans_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1286-8"><a href="bayesian-data-analysis-2.html#cb1286-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_hdi</span>()</span></code></pre></div>
<pre><code># A tibble: 1 × 7
  contrast        .value .lower .upper .width .point .interval
  &lt;chr&gt;            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1 neutral_vs_rest   1.72 -0.298   3.63   0.95 mean   hdi      </code></pre>
<p>Here, the HDP does not exclude 0.</p>
<p>Let’s double check that we get the same result using the <code>hypothesis()</code> function, or by directly computing from the posterior samples.</p>
<div class="sourceCode" id="cb1288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1288-1"><a href="bayesian-data-analysis-2.html#cb1288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using hypothesis()</span></span>
<span id="cb1288-2"><a href="bayesian-data-analysis-2.html#cb1288-2" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1288-3"><a href="bayesian-data-analysis-2.html#cb1288-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesis</span>(<span class="st">&quot;(Intercept + handneutral)*2 &lt; (Intercept + Intercept + handgood)&quot;</span>)</span></code></pre></div>
<pre><code>Hypothesis Tests for class b:
                Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio
1 ((Intercept+handn... &lt; 0     1.72      1.02     0.05     3.41       0.05
  Post.Prob Star
1      0.04     
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<div class="sourceCode" id="cb1290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1290-1"><a href="bayesian-data-analysis-2.html#cb1290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># directly computing from the posterior</span></span>
<span id="cb1290-2"><a href="bayesian-data-analysis-2.html#cb1290-2" aria-hidden="true" tabindex="-1"></a>fit.brm_poker <span class="sc">%&gt;%</span> </span>
<span id="cb1290-3"><a href="bayesian-data-analysis-2.html#cb1290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1290-4"><a href="bayesian-data-analysis-2.html#cb1290-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1290-5"><a href="bayesian-data-analysis-2.html#cb1290-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">contrast =</span> (b_intercept <span class="sc">+</span> b_handneutral) <span class="sc">*</span> <span class="dv">2</span> <span class="sc">-</span> (b_intercept <span class="sc">+</span> b_intercept <span class="sc">+</span> b_handgood)) <span class="sc">%&gt;%</span> </span>
<span id="cb1290-6"><a href="bayesian-data-analysis-2.html#cb1290-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">contrast =</span> <span class="fu">mean</span>(contrast))</span></code></pre></div>
<pre><code>Warning: Method &#39;posterior_samples&#39; is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
<pre><code>  contrast
1 1.724884</code></pre>
<p>The <code>emmeans()</code> function becomes particularly useful when our model has several categorical predictors, and we are interested in comparing differences along one predictor while marginalizing over the values of the other predictor.</p>
<p>Let’s take a look for a model that considers both <code>skill</code> and <code>hand</code> as predictors (as well as the interaction).</p>
<div class="sourceCode" id="cb1293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1293-1"><a href="bayesian-data-analysis-2.html#cb1293-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker2 <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> hand <span class="sc">*</span> skill,</span>
<span id="cb1293-2"><a href="bayesian-data-analysis-2.html#cb1293-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> df.poker,</span>
<span id="cb1293-3"><a href="bayesian-data-analysis-2.html#cb1293-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">seed =</span> <span class="dv">1</span>, </span>
<span id="cb1293-4"><a href="bayesian-data-analysis-2.html#cb1293-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">file =</span> <span class="st">&quot;cache/brm_poker2&quot;</span>)</span>
<span id="cb1293-5"><a href="bayesian-data-analysis-2.html#cb1293-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1293-6"><a href="bayesian-data-analysis-2.html#cb1293-6" aria-hidden="true" tabindex="-1"></a>fit.brm_poker2 <span class="sc">%&gt;%</span> </span>
<span id="cb1293-7"><a href="bayesian-data-analysis-2.html#cb1293-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: balance ~ hand * skill 
   Data: df.poker (Number of observations: 300) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
Intercept                   4.59      0.57     3.46     5.73 1.00     1870
handneutral                 5.24      0.81     3.66     6.84 1.00     2163
handgood                    9.20      0.81     7.61    10.76 1.00     2027
skillexpert                 2.71      0.81     1.09     4.26 1.00     1785
handneutral:skillexpert    -1.69      1.16    -3.96     0.57 1.00     1826
handgood:skillexpert       -4.26      1.14    -6.52    -2.05 1.00     1822
                        Tail_ESS
Intercept                   2429
handneutral                 2747
handgood                    2805
skillexpert                 2506
handneutral:skillexpert     2488
handgood:skillexpert        2495

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma     4.03      0.17     3.72     4.37 1.00     3665     2627

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>In the summary table above, <code>skillexpert</code> captures the difference between an expert and an average player <strong>when they have a bad hand</strong>. To see whether there was a difference in expertise overall (i.e. across all three kinds of hands), we can calculate a linear contrast.</p>
<div class="sourceCode" id="cb1295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1295-1"><a href="bayesian-data-analysis-2.html#cb1295-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker2 <span class="sc">%&gt;%</span> </span>
<span id="cb1295-2"><a href="bayesian-data-analysis-2.html#cb1295-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(pairwise <span class="sc">~</span> skill)</span></code></pre></div>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>$emmeans
 skill   emmean lower.HPD upper.HPD
 average   9.41      8.74      10.0
 expert   10.14      9.45      10.7

Point estimate displayed: median 
HPD interval probability: 0.95 

$contrasts
 contrast         estimate lower.HPD upper.HPD
 average - expert    -0.73      -1.6     0.207

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
<p>It looks like overall, skilled players weren’t doing much better than average players.</p>
<p>We can even do something like an equivalent of an ANOVA using <code>emmeans()</code>, like so:</p>
<div class="sourceCode" id="cb1298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1298-1"><a href="bayesian-data-analysis-2.html#cb1298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">joint_tests</span>(fit.brm_poker2)</span></code></pre></div>
<pre><code> model term df1 df2 F.ratio p.value
 hand         2 Inf  78.554  &lt;.0001
 skill        1 Inf   2.450  0.1176
 hand:skill   2 Inf   7.040  0.0009</code></pre>
<p>The values we get here are very similar to what we would get from a frequentist ANOVA:</p>
<div class="sourceCode" id="cb1300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1300-1"><a href="bayesian-data-analysis-2.html#cb1300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">&quot;participant&quot;</span>,</span>
<span id="cb1300-2"><a href="bayesian-data-analysis-2.html#cb1300-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">dv =</span> <span class="st">&quot;balance&quot;</span>,</span>
<span id="cb1300-3"><a href="bayesian-data-analysis-2.html#cb1300-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">between =</span> <span class="fu">c</span>(<span class="st">&quot;hand&quot;</span>, <span class="st">&quot;skill&quot;</span>),</span>
<span id="cb1300-4"><a href="bayesian-data-analysis-2.html#cb1300-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> df.poker)</span></code></pre></div>
<pre><code>Contrasts set to contr.sum for the following variables: hand, skill</code></pre>
<pre><code>Anova Table (Type 3 tests)

Response: balance
      Effect     df   MSE         F  ges p.value
1       hand 2, 294 16.16 79.17 *** .350   &lt;.001
2      skill 1, 294 16.16      2.43 .008    .120
3 hand:skill 2, 294 16.16  7.08 *** .046   &lt;.001
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;+&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="bayes-factor" class="section level4 hasAnchor" number="23.4.5.3">
<h4><span class="header-section-number">23.4.5.3</span> Bayes factor<a href="bayesian-data-analysis-2.html#bayes-factor" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another way of testing hypothesis is via the Bayes factor. Let’s fit the two models we are interested in comparing with each other:</p>
<div class="sourceCode" id="cb1303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1303-1"><a href="bayesian-data-analysis-2.html#cb1303-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker_bf1 <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hand,</span>
<span id="cb1303-2"><a href="bayesian-data-analysis-2.html#cb1303-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> df.poker,</span>
<span id="cb1303-3"><a href="bayesian-data-analysis-2.html#cb1303-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> T),</span>
<span id="cb1303-4"><a href="bayesian-data-analysis-2.html#cb1303-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">file =</span> <span class="st">&quot;cache/brm_poker_bf1&quot;</span>)</span>
<span id="cb1303-5"><a href="bayesian-data-analysis-2.html#cb1303-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1303-6"><a href="bayesian-data-analysis-2.html#cb1303-6" aria-hidden="true" tabindex="-1"></a>fit.brm_poker_bf2 <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> balance <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> hand <span class="sc">+</span> skill,</span>
<span id="cb1303-7"><a href="bayesian-data-analysis-2.html#cb1303-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> df.poker,</span>
<span id="cb1303-8"><a href="bayesian-data-analysis-2.html#cb1303-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">all =</span> T),</span>
<span id="cb1303-9"><a href="bayesian-data-analysis-2.html#cb1303-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">file =</span> <span class="st">&quot;cache/brm_poker_bf2&quot;</span>)</span></code></pre></div>
<p>And then compare the models using the <code>bayes_factor()</code> function:</p>
<div class="sourceCode" id="cb1304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1304-1"><a href="bayesian-data-analysis-2.html#cb1304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bayes_factor</span>(fit.brm_poker_bf2, fit.brm_poker_bf1)</span></code></pre></div>
<pre><code>Iteration: 1
Iteration: 2
Iteration: 3
Iteration: 4
Iteration: 5
Iteration: 1
Iteration: 2
Iteration: 3
Iteration: 4</code></pre>
<pre><code>Estimated Bayes factor in favor of fit.brm_poker_bf2 over fit.brm_poker_bf1: 3.80995</code></pre>
<p>Bayes factors don’t have a very good reputation (see here and here). Instead, the way to go these days appears to be via approximate leave one out cross-validation.</p>
</div>
<div id="approximate-leave-one-out-cross-validation" class="section level4 hasAnchor" number="23.4.5.4">
<h4><span class="header-section-number">23.4.5.4</span> Approximate leave one out cross-validation<a href="bayesian-data-analysis-2.html#approximate-leave-one-out-cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1307-1"><a href="bayesian-data-analysis-2.html#cb1307-1" aria-hidden="true" tabindex="-1"></a>fit.brm_poker_bf1 <span class="ot">=</span> <span class="fu">add_criterion</span>(fit.brm_poker_bf1,</span>
<span id="cb1307-2"><a href="bayesian-data-analysis-2.html#cb1307-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>,</span>
<span id="cb1307-3"><a href="bayesian-data-analysis-2.html#cb1307-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">reloo =</span> T,</span>
<span id="cb1307-4"><a href="bayesian-data-analysis-2.html#cb1307-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">file =</span> <span class="st">&quot;cache/brm_poker_bf1&quot;</span>)</span>
<span id="cb1307-5"><a href="bayesian-data-analysis-2.html#cb1307-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1307-6"><a href="bayesian-data-analysis-2.html#cb1307-6" aria-hidden="true" tabindex="-1"></a>fit.brm_poker_bf2 <span class="ot">=</span> <span class="fu">add_criterion</span>(fit.brm_poker_bf2,</span>
<span id="cb1307-7"><a href="bayesian-data-analysis-2.html#cb1307-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">criterion =</span> <span class="st">&quot;loo&quot;</span>,</span>
<span id="cb1307-8"><a href="bayesian-data-analysis-2.html#cb1307-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">reloo =</span> T,</span>
<span id="cb1307-9"><a href="bayesian-data-analysis-2.html#cb1307-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">file =</span> <span class="st">&quot;cache/brm_poker_bf2&quot;</span>)</span>
<span id="cb1307-10"><a href="bayesian-data-analysis-2.html#cb1307-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1307-11"><a href="bayesian-data-analysis-2.html#cb1307-11" aria-hidden="true" tabindex="-1"></a><span class="fu">loo_compare</span>(fit.brm_poker_bf1,</span>
<span id="cb1307-12"><a href="bayesian-data-analysis-2.html#cb1307-12" aria-hidden="true" tabindex="-1"></a>            fit.brm_poker_bf2)</span></code></pre></div>
<pre><code>                  elpd_diff se_diff
fit.brm_poker_bf2  0.0       0.0   
fit.brm_poker_bf1 -0.2       1.5   </code></pre>
</div>
</div>
</div>
<div id="sleep-study-1" class="section level2 hasAnchor" number="23.5">
<h2><span class="header-section-number">23.5</span> Sleep study<a href="bayesian-data-analysis-2.html#sleep-study-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="visualize-the-data-1" class="section level3 hasAnchor" number="23.5.1">
<h3><span class="header-section-number">23.5.1</span> 1. Visualize the data<a href="bayesian-data-analysis-2.html#visualize-the-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1309-1"><a href="bayesian-data-analysis-2.html#cb1309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1309-2"><a href="bayesian-data-analysis-2.html#cb1309-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1309-3"><a href="bayesian-data-analysis-2.html#cb1309-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1309-4"><a href="bayesian-data-analysis-2.html#cb1309-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">mutate</span>(<span class="at">days =</span> <span class="fu">as.factor</span>(days)),</span>
<span id="cb1309-5"><a href="bayesian-data-analysis-2.html#cb1309-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1309-6"><a href="bayesian-data-analysis-2.html#cb1309-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1309-7"><a href="bayesian-data-analysis-2.html#cb1309-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb1309-8"><a href="bayesian-data-analysis-2.html#cb1309-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb1309-9"><a href="bayesian-data-analysis-2.html#cb1309-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>) </span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
</div>
<div id="specify-and-fit-the-model-1" class="section level3 hasAnchor" number="23.5.2">
<h3><span class="header-section-number">23.5.2</span> 2. Specify and fit the model<a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="frequentist-analysis-1" class="section level4 hasAnchor" number="23.5.2.1">
<h4><span class="header-section-number">23.5.2.1</span> Frequentist analysis<a href="bayesian-data-analysis-2.html#frequentist-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1310-1"><a href="bayesian-data-analysis-2.html#cb1310-1" aria-hidden="true" tabindex="-1"></a>fit.lmer_sleep <span class="ot">=</span> <span class="fu">lmer</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb1310-2"><a href="bayesian-data-analysis-2.html#cb1310-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> df.sleep)</span>
<span id="cb1310-3"><a href="bayesian-data-analysis-2.html#cb1310-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1310-4"><a href="bayesian-data-analysis-2.html#cb1310-4" aria-hidden="true" tabindex="-1"></a>fit.lmer_sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1310-5"><a href="bayesian-data-analysis-2.html#cb1310-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
lmerModLmerTest]
Formula: reaction ~ 1 + days + (1 + days | subject)
   Data: df.sleep

REML criterion at convergence: 1771.4

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.9707 -0.4703  0.0276  0.4594  5.2009 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 subject  (Intercept) 582.72   24.140       
          days         35.03    5.919   0.07
 Residual             649.36   25.483       
Number of obs: 183, groups:  subject, 20

Fixed effects:
            Estimate Std. Error      df t value Pr(&gt;|t|)    
(Intercept)  252.543      6.433  19.295  39.257  &lt; 2e-16 ***
days          10.452      1.542  17.163   6.778 3.06e-06 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Correlation of Fixed Effects:
     (Intr)
days -0.137</code></pre>
</div>
<div id="bayesian-analysis" class="section level4 hasAnchor" number="23.5.2.2">
<h4><span class="header-section-number">23.5.2.2</span> Bayesian analysis<a href="bayesian-data-analysis-2.html#bayesian-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1312-1"><a href="bayesian-data-analysis-2.html#cb1312-1" aria-hidden="true" tabindex="-1"></a>fit.brm_sleep <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> reaction <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> days <span class="sc">|</span> subject),</span>
<span id="cb1312-2"><a href="bayesian-data-analysis-2.html#cb1312-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> df.sleep,</span>
<span id="cb1312-3"><a href="bayesian-data-analysis-2.html#cb1312-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seed =</span> <span class="dv">1</span>,</span>
<span id="cb1312-4"><a href="bayesian-data-analysis-2.html#cb1312-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">file =</span> <span class="st">&quot;cache/brm_sleep&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="model-evaluation-1" class="section level3 hasAnchor" number="23.5.3">
<h3><span class="header-section-number">23.5.3</span> 3. Model evaluation<a href="bayesian-data-analysis-2.html#model-evaluation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a-did-the-inference-work-1" class="section level4 hasAnchor" number="23.5.3.1">
<h4><span class="header-section-number">23.5.3.1</span> a) Did the inference work?<a href="bayesian-data-analysis-2.html#a-did-the-inference-work-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1313-1"><a href="bayesian-data-analysis-2.html#cb1313-1" aria-hidden="true" tabindex="-1"></a>fit.brm_sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1313-2"><a href="bayesian-data-analysis-2.html#cb1313-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: reaction ~ 1 + days + (1 + days | subject) 
   Data: df.sleep (Number of observations: 183) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Group-Level Effects: 
~subject (Number of levels: 20) 
                    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Intercept)          26.14      6.37    15.50    40.39 1.00     1988     2693
sd(days)                6.55      1.54     4.12    10.02 1.00     1341     1613
cor(Intercept,days)     0.09      0.30    -0.48     0.67 1.00      943     1403

Population-Level Effects: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept   252.39      7.00   238.22   266.40 1.00     1631     2124
days         10.34      1.72     6.88    13.70 1.00     1240     1911

Family Specific Parameters: 
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    25.80      1.54    23.01    29.10 1.00     3592     2762

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb1315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1315-1"><a href="bayesian-data-analysis-2.html#cb1315-1" aria-hidden="true" tabindex="-1"></a>fit.brm_sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1315-2"><a href="bayesian-data-analysis-2.html#cb1315-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">N =</span> <span class="dv">6</span>)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-49-1.png" width="768" /></p>
</div>
<div id="b-visualize-model-predictions-1" class="section level4 hasAnchor" number="23.5.3.2">
<h4><span class="header-section-number">23.5.3.2</span> b) Visualize model predictions<a href="bayesian-data-analysis-2.html#b-visualize-model-predictions-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1316-1"><a href="bayesian-data-analysis-2.html#cb1316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit.brm_sleep,</span>
<span id="cb1316-2"><a href="bayesian-data-analysis-2.html#cb1316-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">nsamples =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>Warning: Argument &#39;nsamples&#39; is deprecated. Please use argument &#39;ndraws&#39;
instead.</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
</div>
<div id="interpret-the-parameters" class="section level3 hasAnchor" number="23.5.4">
<h3><span class="header-section-number">23.5.4</span> 4. Interpret the parameters<a href="bayesian-data-analysis-2.html#interpret-the-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1318-1"><a href="bayesian-data-analysis-2.html#cb1318-1" aria-hidden="true" tabindex="-1"></a>fit.brm_sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1318-2"><a href="bayesian-data-analysis-2.html#cb1318-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="at">conf.method =</span> <span class="st">&quot;HPDinterval&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 6 × 8
  effect   component group    term         estimate std.error conf.low conf.high
  &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 fixed    cond      &lt;NA&gt;     (Intercept)  252.         7.00   239.      267.   
2 fixed    cond      &lt;NA&gt;     days          10.3        1.72     7.05     13.8  
3 ran_pars cond      subject  sd__(Interc…  26.1        6.37    15.0      39.3  
4 ran_pars cond      subject  sd__days       6.55       1.54     3.92      9.50 
5 ran_pars cond      subject  cor__(Inter…   0.0909     0.298   -0.467     0.677
6 ran_pars cond      Residual sd__Observa…  25.8        1.54    22.9      28.9  </code></pre>
<div id="summary-of-posterior-distributions" class="section level4 hasAnchor" number="23.5.4.1">
<h4><span class="header-section-number">23.5.4.1</span> Summary of posterior distributions<a href="bayesian-data-analysis-2.html#summary-of-posterior-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1320-1"><a href="bayesian-data-analysis-2.html#cb1320-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all parameters</span></span>
<span id="cb1320-2"><a href="bayesian-data-analysis-2.html#cb1320-2" aria-hidden="true" tabindex="-1"></a>fit.brm_sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1320-3"><a href="bayesian-data-analysis-2.html#cb1320-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1320-4"><a href="bayesian-data-analysis-2.html#cb1320-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(lp__, <span class="fu">contains</span>(<span class="st">&quot;[&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb1320-5"><a href="bayesian-data-analysis-2.html#cb1320-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb1320-6"><a href="bayesian-data-analysis-2.html#cb1320-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>,</span>
<span id="cb1320-7"><a href="bayesian-data-analysis-2.html#cb1320-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1320-8"><a href="bayesian-data-analysis-2.html#cb1320-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1320-9"><a href="bayesian-data-analysis-2.html#cb1320-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb1320-10"><a href="bayesian-data-analysis-2.html#cb1320-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">point_interval =</span> mode_hdi,</span>
<span id="cb1320-11"><a href="bayesian-data-analysis-2.html#cb1320-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1320-12"><a href="bayesian-data-analysis-2.html#cb1320-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,</span>
<span id="cb1320-13"><a href="bayesian-data-analysis-2.html#cb1320-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb1320-14"><a href="bayesian-data-analysis-2.html#cb1320-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb1320-15"><a href="bayesian-data-analysis-2.html#cb1320-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<pre><code>Warning: Method &#39;posterior_samples&#39; is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
<div class="sourceCode" id="cb1322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1322-1"><a href="bayesian-data-analysis-2.html#cb1322-1" aria-hidden="true" tabindex="-1"></a><span class="co"># just the parameter of interest</span></span>
<span id="cb1322-2"><a href="bayesian-data-analysis-2.html#cb1322-2" aria-hidden="true" tabindex="-1"></a>fit.brm_sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1322-3"><a href="bayesian-data-analysis-2.html#cb1322-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1322-4"><a href="bayesian-data-analysis-2.html#cb1322-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(b_days) <span class="sc">%&gt;%</span></span>
<span id="cb1322-5"><a href="bayesian-data-analysis-2.html#cb1322-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1322-6"><a href="bayesian-data-analysis-2.html#cb1322-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> b_days)) <span class="sc">+</span></span>
<span id="cb1322-7"><a href="bayesian-data-analysis-2.html#cb1322-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">point_interval =</span> mode_hdi,</span>
<span id="cb1322-8"><a href="bayesian-data-analysis-2.html#cb1322-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1322-9"><a href="bayesian-data-analysis-2.html#cb1322-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<pre><code>Warning: Method &#39;posterior_samples&#39; is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-52-1.png" width="672" /><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-52-2.png" width="672" /></p>
</div>
</div>
<div id="test-specific-hypotheses-1" class="section level3 hasAnchor" number="23.5.5">
<h3><span class="header-section-number">23.5.5</span> 5. Test specific hypotheses<a href="bayesian-data-analysis-2.html#test-specific-hypotheses-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, we were just interested in how the number of days of sleep deprivation affected reaction time (and we can see that by inspecting the posterior for the <code>days</code> predictor in the model).</p>
</div>
<div id="report-results" class="section level3 hasAnchor" number="23.5.6">
<h3><span class="header-section-number">23.5.6</span> 6. Report results<a href="bayesian-data-analysis-2.html#report-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="model-prediction-with-posterior-draws-aggregate" class="section level4 hasAnchor" number="23.5.6.1">
<h4><span class="header-section-number">23.5.6.1</span> Model prediction with posterior draws (aggregate)<a href="bayesian-data-analysis-2.html#model-prediction-with-posterior-draws-aggregate" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1324-1"><a href="bayesian-data-analysis-2.html#cb1324-1" aria-hidden="true" tabindex="-1"></a>df.model <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">days =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1324-2"><a href="bayesian-data-analysis-2.html#cb1324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_linpred_draws</span>(<span class="at">newdata =</span> .,</span>
<span id="cb1324-3"><a href="bayesian-data-analysis-2.html#cb1324-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">object =</span> fit.brm_sleep,</span>
<span id="cb1324-4"><a href="bayesian-data-analysis-2.html#cb1324-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ndraws =</span> <span class="dv">10</span>,</span>
<span id="cb1324-5"><a href="bayesian-data-analysis-2.html#cb1324-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seed =</span> <span class="dv">1</span>,</span>
<span id="cb1324-6"><a href="bayesian-data-analysis-2.html#cb1324-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">re_formula =</span> <span class="cn">NA</span>)</span>
<span id="cb1324-7"><a href="bayesian-data-analysis-2.html#cb1324-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1324-8"><a href="bayesian-data-analysis-2.html#cb1324-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep,</span>
<span id="cb1324-9"><a href="bayesian-data-analysis-2.html#cb1324-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1324-10"><a href="bayesian-data-analysis-2.html#cb1324-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1324-11"><a href="bayesian-data-analysis-2.html#cb1324-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb1324-12"><a href="bayesian-data-analysis-2.html#cb1324-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb1324-13"><a href="bayesian-data-analysis-2.html#cb1324-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.model,</span>
<span id="cb1324-14"><a href="bayesian-data-analysis-2.html#cb1324-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> .linpred,</span>
<span id="cb1324-15"><a href="bayesian-data-analysis-2.html#cb1324-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">group =</span> .draw),</span>
<span id="cb1324-16"><a href="bayesian-data-analysis-2.html#cb1324-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1324-17"><a href="bayesian-data-analysis-2.html#cb1324-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>) <span class="sc">+</span></span>
<span id="cb1324-18"><a href="bayesian-data-analysis-2.html#cb1324-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
</div>
<div id="model-prediction-with-credible-intervals-aggregate" class="section level4 hasAnchor" number="23.5.6.2">
<h4><span class="header-section-number">23.5.6.2</span> Model prediction with credible intervals (aggregate)<a href="bayesian-data-analysis-2.html#model-prediction-with-credible-intervals-aggregate" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1325-1"><a href="bayesian-data-analysis-2.html#cb1325-1" aria-hidden="true" tabindex="-1"></a>df.model <span class="ot">=</span> fit.brm_sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1325-2"><a href="bayesian-data-analysis-2.html#cb1325-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(<span class="at">re_formula =</span> <span class="cn">NA</span>,</span>
<span id="cb1325-3"><a href="bayesian-data-analysis-2.html#cb1325-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">days =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1325-4"><a href="bayesian-data-analysis-2.html#cb1325-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1325-5"><a href="bayesian-data-analysis-2.html#cb1325-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">days =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1325-6"><a href="bayesian-data-analysis-2.html#cb1325-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb1325-7"><a href="bayesian-data-analysis-2.html#cb1325-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1325-8"><a href="bayesian-data-analysis-2.html#cb1325-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.sleep,</span>
<span id="cb1325-9"><a href="bayesian-data-analysis-2.html#cb1325-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1325-10"><a href="bayesian-data-analysis-2.html#cb1325-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1325-11"><a href="bayesian-data-analysis-2.html#cb1325-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb1325-12"><a href="bayesian-data-analysis-2.html#cb1325-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>)) <span class="sc">+</span> </span>
<span id="cb1325-13"><a href="bayesian-data-analysis-2.html#cb1325-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> df.model,</span>
<span id="cb1325-14"><a href="bayesian-data-analysis-2.html#cb1325-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> estimate,</span>
<span id="cb1325-15"><a href="bayesian-data-analysis-2.html#cb1325-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ymin =</span> q2_5,</span>
<span id="cb1325-16"><a href="bayesian-data-analysis-2.html#cb1325-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ymax =</span> q97_5),</span>
<span id="cb1325-17"><a href="bayesian-data-analysis-2.html#cb1325-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb1325-18"><a href="bayesian-data-analysis-2.html#cb1325-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1325-19"><a href="bayesian-data-analysis-2.html#cb1325-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.model,</span>
<span id="cb1325-20"><a href="bayesian-data-analysis-2.html#cb1325-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> estimate),</span>
<span id="cb1325-21"><a href="bayesian-data-analysis-2.html#cb1325-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb1325-22"><a href="bayesian-data-analysis-2.html#cb1325-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1325-23"><a href="bayesian-data-analysis-2.html#cb1325-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>) <span class="sc">+</span></span>
<span id="cb1325-24"><a href="bayesian-data-analysis-2.html#cb1325-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
<div id="model-prediction-with-credible-intervals-individual-participants" class="section level4 hasAnchor" number="23.5.6.3">
<h4><span class="header-section-number">23.5.6.3</span> Model prediction with credible intervals (individual participants)<a href="bayesian-data-analysis-2.html#model-prediction-with-credible-intervals-individual-participants" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1326-1"><a href="bayesian-data-analysis-2.html#cb1326-1" aria-hidden="true" tabindex="-1"></a>fit.brm_sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1326-2"><a href="bayesian-data-analysis-2.html#cb1326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1326-3"><a href="bayesian-data-analysis-2.html#cb1326-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1326-4"><a href="bayesian-data-analysis-2.html#cb1326-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1326-5"><a href="bayesian-data-analysis-2.html#cb1326-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(df.sleep) <span class="sc">%&gt;%</span> </span>
<span id="cb1326-6"><a href="bayesian-data-analysis-2.html#cb1326-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1326-7"><a href="bayesian-data-analysis-2.html#cb1326-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1326-8"><a href="bayesian-data-analysis-2.html#cb1326-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1326-9"><a href="bayesian-data-analysis-2.html#cb1326-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> q2_5,</span>
<span id="cb1326-10"><a href="bayesian-data-analysis-2.html#cb1326-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ymax =</span> q97_5),</span>
<span id="cb1326-11"><a href="bayesian-data-analysis-2.html#cb1326-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1326-12"><a href="bayesian-data-analysis-2.html#cb1326-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> estimate),</span>
<span id="cb1326-13"><a href="bayesian-data-analysis-2.html#cb1326-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb1326-14"><a href="bayesian-data-analysis-2.html#cb1326-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1326-15"><a href="bayesian-data-analysis-2.html#cb1326-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1326-16"><a href="bayesian-data-analysis-2.html#cb1326-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb1326-17"><a href="bayesian-data-analysis-2.html#cb1326-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1326-18"><a href="bayesian-data-analysis-2.html#cb1326-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1326-19"><a href="bayesian-data-analysis-2.html#cb1326-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb1326-20"><a href="bayesian-data-analysis-2.html#cb1326-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="model-prediction-for-random-samples" class="section level4 hasAnchor" number="23.5.6.4">
<h4><span class="header-section-number">23.5.6.4</span> Model prediction for random samples<a href="bayesian-data-analysis-2.html#model-prediction-for-random-samples" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1327-1"><a href="bayesian-data-analysis-2.html#cb1327-1" aria-hidden="true" tabindex="-1"></a>df.model <span class="ot">=</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1327-2"><a href="bayesian-data-analysis-2.html#cb1327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(subject, days) <span class="sc">%&gt;%</span> </span>
<span id="cb1327-3"><a href="bayesian-data-analysis-2.html#cb1327-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_linpred_draws</span>(<span class="at">newdata =</span> .,</span>
<span id="cb1327-4"><a href="bayesian-data-analysis-2.html#cb1327-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">object =</span> fit.brm_sleep,</span>
<span id="cb1327-5"><a href="bayesian-data-analysis-2.html#cb1327-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ndraws =</span> <span class="dv">10</span>,</span>
<span id="cb1327-6"><a href="bayesian-data-analysis-2.html#cb1327-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb1327-7"><a href="bayesian-data-analysis-2.html#cb1327-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1327-8"><a href="bayesian-data-analysis-2.html#cb1327-8" aria-hidden="true" tabindex="-1"></a>df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1327-9"><a href="bayesian-data-analysis-2.html#cb1327-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1327-10"><a href="bayesian-data-analysis-2.html#cb1327-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1327-11"><a href="bayesian-data-analysis-2.html#cb1327-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1327-12"><a href="bayesian-data-analysis-2.html#cb1327-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.model,</span>
<span id="cb1327-13"><a href="bayesian-data-analysis-2.html#cb1327-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> .linpred,</span>
<span id="cb1327-14"><a href="bayesian-data-analysis-2.html#cb1327-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> .draw),</span>
<span id="cb1327-15"><a href="bayesian-data-analysis-2.html#cb1327-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb1327-16"><a href="bayesian-data-analysis-2.html#cb1327-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb1327-17"><a href="bayesian-data-analysis-2.html#cb1327-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1327-18"><a href="bayesian-data-analysis-2.html#cb1327-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1327-19"><a href="bayesian-data-analysis-2.html#cb1327-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb1327-20"><a href="bayesian-data-analysis-2.html#cb1327-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1327-21"><a href="bayesian-data-analysis-2.html#cb1327-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1327-22"><a href="bayesian-data-analysis-2.html#cb1327-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb1327-23"><a href="bayesian-data-analysis-2.html#cb1327-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
</div>
<div id="animated-model-prediction-for-random-samples" class="section level4 hasAnchor" number="23.5.6.5">
<h4><span class="header-section-number">23.5.6.5</span> Animated model prediction for random samples<a href="bayesian-data-analysis-2.html#animated-model-prediction-for-random-samples" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1328-1"><a href="bayesian-data-analysis-2.html#cb1328-1" aria-hidden="true" tabindex="-1"></a>df.model <span class="ot">=</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1328-2"><a href="bayesian-data-analysis-2.html#cb1328-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(subject, days) <span class="sc">%&gt;%</span> </span>
<span id="cb1328-3"><a href="bayesian-data-analysis-2.html#cb1328-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_linpred_draws</span>(<span class="at">newdata =</span> .,</span>
<span id="cb1328-4"><a href="bayesian-data-analysis-2.html#cb1328-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">object =</span> fit.brm_sleep,</span>
<span id="cb1328-5"><a href="bayesian-data-analysis-2.html#cb1328-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ndraws =</span> <span class="dv">10</span>,</span>
<span id="cb1328-6"><a href="bayesian-data-analysis-2.html#cb1328-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb1328-7"><a href="bayesian-data-analysis-2.html#cb1328-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1328-8"><a href="bayesian-data-analysis-2.html#cb1328-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> df.sleep <span class="sc">%&gt;%</span> </span>
<span id="cb1328-9"><a href="bayesian-data-analysis-2.html#cb1328-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1328-10"><a href="bayesian-data-analysis-2.html#cb1328-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> days,</span>
<span id="cb1328-11"><a href="bayesian-data-analysis-2.html#cb1328-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> reaction)) <span class="sc">+</span> </span>
<span id="cb1328-12"><a href="bayesian-data-analysis-2.html#cb1328-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.model,</span>
<span id="cb1328-13"><a href="bayesian-data-analysis-2.html#cb1328-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> .linpred,</span>
<span id="cb1328-14"><a href="bayesian-data-analysis-2.html#cb1328-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> .draw),</span>
<span id="cb1328-15"><a href="bayesian-data-analysis-2.html#cb1328-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1328-16"><a href="bayesian-data-analysis-2.html#cb1328-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1328-17"><a href="bayesian-data-analysis-2.html#cb1328-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1328-18"><a href="bayesian-data-analysis-2.html#cb1328-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Days of sleep deprivation&quot;</span>, </span>
<span id="cb1328-19"><a href="bayesian-data-analysis-2.html#cb1328-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average reaction time (ms)&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1328-20"><a href="bayesian-data-analysis-2.html#cb1328-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1328-21"><a href="bayesian-data-analysis-2.html#cb1328-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb1328-22"><a href="bayesian-data-analysis-2.html#cb1328-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)) <span class="sc">+</span> </span>
<span id="cb1328-23"><a href="bayesian-data-analysis-2.html#cb1328-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_states</span>(.draw, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1328-24"><a href="bayesian-data-analysis-2.html#cb1328-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shadow_mark</span>(<span class="at">past =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>)</span>
<span id="cb1328-25"><a href="bayesian-data-analysis-2.html#cb1328-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1328-26"><a href="bayesian-data-analysis-2.html#cb1328-26" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(p, <span class="at">nframes =</span> <span class="dv">10</span>, <span class="at">fps =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="dv">800</span>, <span class="at">height =</span> <span class="dv">600</span>, <span class="at">res =</span> <span class="dv">96</span>, <span class="at">type =</span> <span class="st">&quot;cairo&quot;</span>)</span></code></pre></div>
<pre><code>Rendering [===&gt;----------------------------------------] at 2.3 fps ~ eta: 4s
Rendering [========&gt;-----------------------------------] at 2.2 fps ~ eta: 4s
Rendering [============&gt;-------------------------------] at 2.1 fps ~ eta: 3s
Rendering [=================&gt;--------------------------] at 2.1 fps ~ eta: 3s
Rendering [=====================&gt;----------------------] at 2.1 fps ~ eta: 2s
Rendering [=========================&gt;------------------] at 2.1 fps ~ eta: 2s
Rendering [==============================&gt;-------------] at 2.1 fps ~ eta: 1s
Rendering [==================================&gt;---------] at 2.1 fps ~ eta: 1s
Rendering [========================================&gt;-----] at 2 fps ~ eta: 0s
Rendering [==============================================] at 2 fps ~ eta: 0s</code></pre>
<div class="sourceCode" id="cb1330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1330-1"><a href="bayesian-data-analysis-2.html#cb1330-1" aria-hidden="true" tabindex="-1"></a><span class="co"># anim_save(&quot;sleep_posterior_predictive.gif&quot;)</span></span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-57-1.gif" /><!-- --></p>
</div>
</div>
</div>
<div id="titanic-study" class="section level2 hasAnchor" number="23.6">
<h2><span class="header-section-number">23.6</span> Titanic study<a href="bayesian-data-analysis-2.html#titanic-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="visualize-that-data" class="section level3 hasAnchor" number="23.6.1">
<h3><span class="header-section-number">23.6.1</span> 1. Visualize that data<a href="bayesian-data-analysis-2.html#visualize-that-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1331-1"><a href="bayesian-data-analysis-2.html#cb1331-1" aria-hidden="true" tabindex="-1"></a>df.titanic <span class="sc">%&gt;%</span> </span>
<span id="cb1331-2"><a href="bayesian-data-analysis-2.html#cb1331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">as.factor</span>(sex)) <span class="sc">%&gt;%</span> </span>
<span id="cb1331-3"><a href="bayesian-data-analysis-2.html#cb1331-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1331-4"><a href="bayesian-data-analysis-2.html#cb1331-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fare,</span>
<span id="cb1331-5"><a href="bayesian-data-analysis-2.html#cb1331-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">y =</span> survived,</span>
<span id="cb1331-6"><a href="bayesian-data-analysis-2.html#cb1331-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb1331-7"><a href="bayesian-data-analysis-2.html#cb1331-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1331-8"><a href="bayesian-data-analysis-2.html#cb1331-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb1331-9"><a href="bayesian-data-analysis-2.html#cb1331-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>),</span>
<span id="cb1331-10"><a href="bayesian-data-analysis-2.html#cb1331-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb1331-11"><a href="bayesian-data-analysis-2.html#cb1331-11" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb1331-12"><a href="bayesian-data-analysis-2.html#cb1331-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
</div>
<div id="specify-and-fit-the-model-2" class="section level3 hasAnchor" number="23.6.2">
<h3><span class="header-section-number">23.6.2</span> 2. Specify and fit the model<a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="frequentist-analysis-2" class="section level4 hasAnchor" number="23.6.2.1">
<h4><span class="header-section-number">23.6.2.1</span> Frequentist analysis<a href="bayesian-data-analysis-2.html#frequentist-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1332-1"><a href="bayesian-data-analysis-2.html#cb1332-1" aria-hidden="true" tabindex="-1"></a>fit.glm_titanic <span class="ot">=</span> <span class="fu">glm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> fare <span class="sc">*</span> sex,</span>
<span id="cb1332-2"><a href="bayesian-data-analysis-2.html#cb1332-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb1332-3"><a href="bayesian-data-analysis-2.html#cb1332-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> df.titanic)</span>
<span id="cb1332-4"><a href="bayesian-data-analysis-2.html#cb1332-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1332-5"><a href="bayesian-data-analysis-2.html#cb1332-5" aria-hidden="true" tabindex="-1"></a>fit.glm_titanic <span class="sc">%&gt;%</span> </span>
<span id="cb1332-6"><a href="bayesian-data-analysis-2.html#cb1332-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>
Call:
glm(formula = survived ~ 1 + fare * sex, family = &quot;binomial&quot;, 
    data = df.titanic)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.6280  -0.6279  -0.5991   0.8172   1.9288  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   0.408428   0.189999   2.150 0.031584 *  
fare          0.019878   0.005372   3.701 0.000215 ***
sexmale      -2.099345   0.230291  -9.116  &lt; 2e-16 ***
fare:sexmale -0.011617   0.005934  -1.958 0.050252 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1186.66  on 890  degrees of freedom
Residual deviance:  879.85  on 887  degrees of freedom
AIC: 887.85

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<div id="bayesian-analysis-1" class="section level4 hasAnchor" number="23.6.2.2">
<h4><span class="header-section-number">23.6.2.2</span> Bayesian analysis<a href="bayesian-data-analysis-2.html#bayesian-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1334-1"><a href="bayesian-data-analysis-2.html#cb1334-1" aria-hidden="true" tabindex="-1"></a>fit.brm_titanic <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> fare <span class="sc">*</span> sex,</span>
<span id="cb1334-2"><a href="bayesian-data-analysis-2.html#cb1334-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="st">&quot;bernoulli&quot;</span>,</span>
<span id="cb1334-3"><a href="bayesian-data-analysis-2.html#cb1334-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> df.titanic,</span>
<span id="cb1334-4"><a href="bayesian-data-analysis-2.html#cb1334-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">file =</span> <span class="st">&quot;cache/brm_titanic&quot;</span>,</span>
<span id="cb1334-5"><a href="bayesian-data-analysis-2.html#cb1334-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">seed =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="model-evaluation-2" class="section level3 hasAnchor" number="23.6.3">
<h3><span class="header-section-number">23.6.3</span> 3. Model evaluation<a href="bayesian-data-analysis-2.html#model-evaluation-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="a-did-the-inference-work-2" class="section level4 hasAnchor" number="23.6.3.1">
<h4><span class="header-section-number">23.6.3.1</span> a) Did the inference work?<a href="bayesian-data-analysis-2.html#a-did-the-inference-work-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1335-1"><a href="bayesian-data-analysis-2.html#cb1335-1" aria-hidden="true" tabindex="-1"></a>fit.brm_titanic <span class="sc">%&gt;%</span> </span>
<span id="cb1335-2"><a href="bayesian-data-analysis-2.html#cb1335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: survived ~ 1 + fare * sex 
   Data: df.titanic (Number of observations: 891) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Population-Level Effects: 
             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Intercept        0.39      0.19     0.03     0.76 1.00     2010     2625
fare             0.02      0.01     0.01     0.03 1.00     1545     2124
sexmale         -2.09      0.23    -2.54    -1.65 1.00     1754     1984
fare:sexmale    -0.01      0.01    -0.02    -0.00 1.00     1479     2041

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb1337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1337-1"><a href="bayesian-data-analysis-2.html#cb1337-1" aria-hidden="true" tabindex="-1"></a>fit.brm_titanic <span class="sc">%&gt;%</span> </span>
<span id="cb1337-2"><a href="bayesian-data-analysis-2.html#cb1337-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-61-1.png" width="960" /></p>
</div>
<div id="b-visualize-model-predictions-2" class="section level4 hasAnchor" number="23.6.3.2">
<h4><span class="header-section-number">23.6.3.2</span> b) Visualize model predictions<a href="bayesian-data-analysis-2.html#b-visualize-model-predictions-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1338-1"><a href="bayesian-data-analysis-2.html#cb1338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit.brm_titanic,</span>
<span id="cb1338-2"><a href="bayesian-data-analysis-2.html#cb1338-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">nsamples =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>Warning: Argument &#39;nsamples&#39; is deprecated. Please use argument &#39;ndraws&#39;
instead.</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>Let’s visualize what the posterior predictive would have looked like for a linear model (instead of a logistic model).</p>
<div class="sourceCode" id="cb1340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1340-1"><a href="bayesian-data-analysis-2.html#cb1340-1" aria-hidden="true" tabindex="-1"></a>fit.brm_titanic_linear <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> survived <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> fare <span class="sc">*</span> sex,</span>
<span id="cb1340-2"><a href="bayesian-data-analysis-2.html#cb1340-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">data =</span> df.titanic,</span>
<span id="cb1340-3"><a href="bayesian-data-analysis-2.html#cb1340-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">file =</span> <span class="st">&quot;cache/brm_titanic_linear&quot;</span>,</span>
<span id="cb1340-4"><a href="bayesian-data-analysis-2.html#cb1340-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb1340-5"><a href="bayesian-data-analysis-2.html#cb1340-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1340-6"><a href="bayesian-data-analysis-2.html#cb1340-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(fit.brm_titanic_linear,</span>
<span id="cb1340-7"><a href="bayesian-data-analysis-2.html#cb1340-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">nsamples =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>Warning: Argument &#39;nsamples&#39; is deprecated. Please use argument &#39;ndraws&#39;
instead.</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
</div>
</div>
<div id="interpret-the-parameters-1" class="section level3 hasAnchor" number="23.6.4">
<h3><span class="header-section-number">23.6.4</span> 4. Interpret the parameters<a href="bayesian-data-analysis-2.html#interpret-the-parameters-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1342-1"><a href="bayesian-data-analysis-2.html#cb1342-1" aria-hidden="true" tabindex="-1"></a>fit.brm_titanic <span class="sc">%&gt;%</span> </span>
<span id="cb1342-2"><a href="bayesian-data-analysis-2.html#cb1342-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1342-3"><a href="bayesian-data-analysis-2.html#cb1342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>lp__) <span class="sc">%&gt;%</span></span>
<span id="cb1342-4"><a href="bayesian-data-analysis-2.html#cb1342-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(),</span>
<span id="cb1342-5"><a href="bayesian-data-analysis-2.html#cb1342-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>,</span>
<span id="cb1342-6"><a href="bayesian-data-analysis-2.html#cb1342-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1342-7"><a href="bayesian-data-analysis-2.html#cb1342-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> .,</span>
<span id="cb1342-8"><a href="bayesian-data-analysis-2.html#cb1342-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> variable,</span>
<span id="cb1342-9"><a href="bayesian-data-analysis-2.html#cb1342-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb1342-10"><a href="bayesian-data-analysis-2.html#cb1342-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_intervalh</span>() <span class="sc">+</span> </span>
<span id="cb1342-11"><a href="bayesian-data-analysis-2.html#cb1342-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>()</span></code></pre></div>
<pre><code>Warning: Method &#39;posterior_samples&#39; is deprecated. Please see ?as_draws for
recommended alternatives.</code></pre>
<pre><code>Warning: &#39;stat_intervalh&#39; is deprecated.
Use &#39;stat_interval&#39; instead.
See help(&quot;Deprecated&quot;) and help(&quot;tidybayes-deprecated&quot;).</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<div class="sourceCode" id="cb1345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1345-1"><a href="bayesian-data-analysis-2.html#cb1345-1" aria-hidden="true" tabindex="-1"></a>fit.brm_titanic <span class="sc">%&gt;%</span> </span>
<span id="cb1345-2"><a href="bayesian-data-analysis-2.html#cb1345-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>(<span class="at">centrality =</span> <span class="st">&quot;mean&quot;</span>,</span>
<span id="cb1345-3"><a href="bayesian-data-analysis-2.html#cb1345-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">ci =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1346-1"><a href="bayesian-data-analysis-2.html#cb1346-1" aria-hidden="true" tabindex="-1"></a>fit.brm_titanic <span class="sc">%&gt;%</span> </span>
<span id="cb1346-2"><a href="bayesian-data-analysis-2.html#cb1346-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggpredict</span>(<span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;fare [0:500]&quot;</span>, <span class="st">&quot;sex&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1346-3"><a href="bayesian-data-analysis-2.html#cb1346-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
</div>
<div id="test-specific-hypotheses-2" class="section level3 hasAnchor" number="23.6.5">
<h3><span class="header-section-number">23.6.5</span> 5. Test specific hypotheses<a href="bayesian-data-analysis-2.html#test-specific-hypotheses-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Difference between men and women in survival?</p>
<div class="sourceCode" id="cb1347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1347-1"><a href="bayesian-data-analysis-2.html#cb1347-1" aria-hidden="true" tabindex="-1"></a>fit.brm_titanic <span class="sc">%&gt;%</span> </span>
<span id="cb1347-2"><a href="bayesian-data-analysis-2.html#cb1347-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> sex,</span>
<span id="cb1347-3"><a href="bayesian-data-analysis-2.html#cb1347-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code>$emmeans
 sex    response lower.HPD upper.HPD
 female    0.743      0.69     0.795
 male      0.194      0.16     0.225

Point estimate displayed: median 
Results are back-transformed from the logit scale 
HPD interval probability: 0.95 

$contrasts
 contrast      odds.ratio lower.HPD upper.HPD
 female / male       12.1      8.39      16.6

Point estimate displayed: median 
Results are back-transformed from the log odds ratio scale 
HPD interval probability: 0.95 </code></pre>
<p>Difference in how fare affected the chances of survival for men and women?</p>
<div class="sourceCode" id="cb1350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1350-1"><a href="bayesian-data-analysis-2.html#cb1350-1" aria-hidden="true" tabindex="-1"></a>fit.brm_titanic <span class="sc">%&gt;%</span> </span>
<span id="cb1350-2"><a href="bayesian-data-analysis-2.html#cb1350-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emtrends</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> sex,</span>
<span id="cb1350-3"><a href="bayesian-data-analysis-2.html#cb1350-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">var =</span> <span class="st">&quot;fare&quot;</span>)</span></code></pre></div>
<pre><code>$emtrends
 sex    fare.trend lower.HPD upper.HPD
 female    0.02083   0.01129    0.0316
 male      0.00845   0.00385    0.0135

Point estimate displayed: median 
HPD interval probability: 0.95 

$contrasts
 contrast      estimate lower.HPD upper.HPD
 female - male   0.0124  0.000884    0.0232

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
</div>
<div id="report-results-1" class="section level3 hasAnchor" number="23.6.6">
<h3><span class="header-section-number">23.6.6</span> 6. Report results<a href="bayesian-data-analysis-2.html#report-results-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1352-1"><a href="bayesian-data-analysis-2.html#cb1352-1" aria-hidden="true" tabindex="-1"></a>df.model <span class="ot">=</span> <span class="fu">add_linpred_draws</span>(<span class="at">newdata =</span> <span class="fu">expand_grid</span>(<span class="at">sex =</span> <span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>),</span>
<span id="cb1352-2"><a href="bayesian-data-analysis-2.html#cb1352-2" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">fare =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1352-3"><a href="bayesian-data-analysis-2.html#cb1352-3" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">factor</span>(sex, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>))),</span>
<span id="cb1352-4"><a href="bayesian-data-analysis-2.html#cb1352-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">object =</span> fit.brm_titanic,</span>
<span id="cb1352-5"><a href="bayesian-data-analysis-2.html#cb1352-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ndraws =</span> <span class="dv">10</span>)</span>
<span id="cb1352-6"><a href="bayesian-data-analysis-2.html#cb1352-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.titanic,</span>
<span id="cb1352-7"><a href="bayesian-data-analysis-2.html#cb1352-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fare,</span>
<span id="cb1352-8"><a href="bayesian-data-analysis-2.html#cb1352-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> survived,</span>
<span id="cb1352-9"><a href="bayesian-data-analysis-2.html#cb1352-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb1352-10"><a href="bayesian-data-analysis-2.html#cb1352-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1352-11"><a href="bayesian-data-analysis-2.html#cb1352-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.model <span class="sc">%&gt;%</span> </span>
<span id="cb1352-12"><a href="bayesian-data-analysis-2.html#cb1352-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span>),</span>
<span id="cb1352-13"><a href="bayesian-data-analysis-2.html#cb1352-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> .linpred,</span>
<span id="cb1352-14"><a href="bayesian-data-analysis-2.html#cb1352-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> .draw,</span>
<span id="cb1352-15"><a href="bayesian-data-analysis-2.html#cb1352-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> sex)) <span class="sc">+</span> </span>
<span id="cb1352-16"><a href="bayesian-data-analysis-2.html#cb1352-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df.model <span class="sc">%&gt;%</span> </span>
<span id="cb1352-17"><a href="bayesian-data-analysis-2.html#cb1352-17" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">&quot;female&quot;</span>),</span>
<span id="cb1352-18"><a href="bayesian-data-analysis-2.html#cb1352-18" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> .linpred,</span>
<span id="cb1352-19"><a href="bayesian-data-analysis-2.html#cb1352-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">group =</span> .draw,</span>
<span id="cb1352-20"><a href="bayesian-data-analysis-2.html#cb1352-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> sex)) <span class="sc">+</span> </span>
<span id="cb1352-21"><a href="bayesian-data-analysis-2.html#cb1352-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set1&quot;</span>)</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
</div>
<div id="politeness-data" class="section level2 hasAnchor" number="23.7">
<h2><span class="header-section-number">23.7</span> Politeness data<a href="bayesian-data-analysis-2.html#politeness-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>(I’m skipping some of the steps of our recipe for Bayesian data analysis here.)</p>
<div id="visualize-the-data-2" class="section level3 hasAnchor" number="23.7.1">
<h3><span class="header-section-number">23.7.1</span> 1. Visualize the data<a href="bayesian-data-analysis-2.html#visualize-the-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1353-1"><a href="bayesian-data-analysis-2.html#cb1353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df.politeness,</span>
<span id="cb1353-2"><a href="bayesian-data-analysis-2.html#cb1353-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> attitude,</span>
<span id="cb1353-3"><a href="bayesian-data-analysis-2.html#cb1353-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> pitch,</span>
<span id="cb1353-4"><a href="bayesian-data-analysis-2.html#cb1353-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> gender,</span>
<span id="cb1353-5"><a href="bayesian-data-analysis-2.html#cb1353-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> gender)) <span class="sc">+</span> </span>
<span id="cb1353-6"><a href="bayesian-data-analysis-2.html#cb1353-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>,</span>
<span id="cb1353-7"><a href="bayesian-data-analysis-2.html#cb1353-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">height =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb1353-8"><a href="bayesian-data-analysis-2.html#cb1353-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_cl_boot&quot;</span>,</span>
<span id="cb1353-9"><a href="bayesian-data-analysis-2.html#cb1353-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb1353-10"><a href="bayesian-data-analysis-2.html#cb1353-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb1353-11"><a href="bayesian-data-analysis-2.html#cb1353-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<pre><code>Warning: Removed 1 rows containing non-finite values (stat_summary).</code></pre>
<pre><code>Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
<div id="specify-and-fit-the-model-3" class="section level3 hasAnchor" number="23.7.2">
<h3><span class="header-section-number">23.7.2</span> 2. Specify and fit the model<a href="bayesian-data-analysis-2.html#specify-and-fit-the-model-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="frequentist-analysis-3" class="section level4 hasAnchor" number="23.7.2.1">
<h4><span class="header-section-number">23.7.2.1</span> Frequentist analysis<a href="bayesian-data-analysis-2.html#frequentist-analysis-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1356-1"><a href="bayesian-data-analysis-2.html#cb1356-1" aria-hidden="true" tabindex="-1"></a>fit.lm_polite <span class="ot">=</span> <span class="fu">lm</span>(<span class="at">formula =</span> pitch <span class="sc">~</span> gender <span class="sc">*</span> attitude,</span>
<span id="cb1356-2"><a href="bayesian-data-analysis-2.html#cb1356-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> df.politeness)</span></code></pre></div>
</div>
<div id="bayesian-analysis-2" class="section level4 hasAnchor" number="23.7.2.2">
<h4><span class="header-section-number">23.7.2.2</span> Bayesian analysis<a href="bayesian-data-analysis-2.html#bayesian-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1357-1"><a href="bayesian-data-analysis-2.html#cb1357-1" aria-hidden="true" tabindex="-1"></a>fit.brm_polite <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> pitch <span class="sc">~</span> gender <span class="sc">*</span> attitude, </span>
<span id="cb1357-2"><a href="bayesian-data-analysis-2.html#cb1357-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> df.politeness, </span>
<span id="cb1357-3"><a href="bayesian-data-analysis-2.html#cb1357-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">file =</span> <span class="st">&quot;cache/brm_polite&quot;</span>,</span>
<span id="cb1357-4"><a href="bayesian-data-analysis-2.html#cb1357-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">seed =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
</div>
<div id="test-specific-hypotheses-3" class="section level3 hasAnchor" number="23.7.3">
<h3><span class="header-section-number">23.7.3</span> 5. Test specific hypotheses<a href="bayesian-data-analysis-2.html#test-specific-hypotheses-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="frequentist" class="section level4 hasAnchor" number="23.7.3.1">
<h4><span class="header-section-number">23.7.3.1</span> Frequentist<a href="bayesian-data-analysis-2.html#frequentist" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1358-1"><a href="bayesian-data-analysis-2.html#cb1358-1" aria-hidden="true" tabindex="-1"></a>fit.lm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1358-2"><a href="bayesian-data-analysis-2.html#cb1358-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">joint_tests</span>()</span></code></pre></div>
<pre><code> model term      df1 df2 F.ratio p.value
 gender            1  79 191.028  &lt;.0001
 attitude          1  79   6.170  0.0151
 gender:attitude   1  79   1.029  0.3135</code></pre>
<p>It looks like there are significant main effects of gender and attitude, but no interaction effect.</p>
<p>Let’s check whether there is a difference in attitude separately for each gender:</p>
<div class="sourceCode" id="cb1360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1360-1"><a href="bayesian-data-analysis-2.html#cb1360-1" aria-hidden="true" tabindex="-1"></a>fit.lm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1360-2"><a href="bayesian-data-analysis-2.html#cb1360-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> attitude <span class="sc">|</span> gender) <span class="sc">%&gt;%</span> </span>
<span id="cb1360-3"><a href="bayesian-data-analysis-2.html#cb1360-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>)</span></code></pre></div>
<pre><code>gender = F:
 contrast  estimate   SE df t.ratio p.value
 inf - pol     27.4 11.0 79   2.489  0.0149

gender = M:
 contrast  estimate   SE df t.ratio p.value
 inf - pol     11.5 11.1 79   1.033  0.3048</code></pre>
<p>There was a significant difference of attitude for female participants but not for male participants.</p>
</div>
<div id="bayesian" class="section level4 hasAnchor" number="23.7.3.2">
<h4><span class="header-section-number">23.7.3.2</span> Bayesian<a href="bayesian-data-analysis-2.html#bayesian" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s whether there was a main effect of gender.</p>
<div class="sourceCode" id="cb1362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1362-1"><a href="bayesian-data-analysis-2.html#cb1362-1" aria-hidden="true" tabindex="-1"></a><span class="co"># main effect of gender</span></span>
<span id="cb1362-2"><a href="bayesian-data-analysis-2.html#cb1362-2" aria-hidden="true" tabindex="-1"></a>fit.brm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1362-3"><a href="bayesian-data-analysis-2.html#cb1362-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> gender) <span class="sc">%&gt;%</span> </span>
<span id="cb1362-4"><a href="bayesian-data-analysis-2.html#cb1362-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>)</span></code></pre></div>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code> contrast estimate lower.HPD upper.HPD
 F - M         108      94.1       124

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
<p>Let’s take a look what the full posterior distribution over this contrast looks like:</p>
<div class="sourceCode" id="cb1365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1365-1"><a href="bayesian-data-analysis-2.html#cb1365-1" aria-hidden="true" tabindex="-1"></a>fit.brm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1365-2"><a href="bayesian-data-analysis-2.html#cb1365-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> gender) <span class="sc">%&gt;%</span> </span>
<span id="cb1365-3"><a href="bayesian-data-analysis-2.html#cb1365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1365-4"><a href="bayesian-data-analysis-2.html#cb1365-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_emmeans_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1365-5"><a href="bayesian-data-analysis-2.html#cb1365-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> .value)) <span class="sc">+</span> </span>
<span id="cb1365-6"><a href="bayesian-data-analysis-2.html#cb1365-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>()</span></code></pre></div>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p>Looks neat!</p>
<p>And let’s confirm that we really estimated the main effect here. Let’s fit a model that only has gender as a predictor, and then compare:</p>
<div class="sourceCode" id="cb1367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1367-1"><a href="bayesian-data-analysis-2.html#cb1367-1" aria-hidden="true" tabindex="-1"></a>fit.brm_polite_gender <span class="ot">=</span> <span class="fu">brm</span>(<span class="at">formula =</span> pitch <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> gender, </span>
<span id="cb1367-2"><a href="bayesian-data-analysis-2.html#cb1367-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">data =</span> df.politeness, </span>
<span id="cb1367-3"><a href="bayesian-data-analysis-2.html#cb1367-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">file =</span> <span class="st">&quot;cache/brm_polite_gender&quot;</span>,</span>
<span id="cb1367-4"><a href="bayesian-data-analysis-2.html#cb1367-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">seed =</span> <span class="dv">1</span>)</span>
<span id="cb1367-5"><a href="bayesian-data-analysis-2.html#cb1367-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1367-6"><a href="bayesian-data-analysis-2.html#cb1367-6" aria-hidden="true" tabindex="-1"></a><span class="co"># using the gather_emmeans_draws to get means rather than medians </span></span>
<span id="cb1367-7"><a href="bayesian-data-analysis-2.html#cb1367-7" aria-hidden="true" tabindex="-1"></a>fit.brm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1367-8"><a href="bayesian-data-analysis-2.html#cb1367-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">spec =</span> pairwise <span class="sc">~</span> gender) <span class="sc">%&gt;%</span> </span>
<span id="cb1367-9"><a href="bayesian-data-analysis-2.html#cb1367-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1367-10"><a href="bayesian-data-analysis-2.html#cb1367-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_emmeans_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1367-11"><a href="bayesian-data-analysis-2.html#cb1367-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_hdi</span>()</span></code></pre></div>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code># A tibble: 1 × 7
  contrast .value .lower .upper .width .point .interval
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1 F - M      108.   94.1   124.   0.95 mean   hdi      </code></pre>
<div class="sourceCode" id="cb1370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1370-1"><a href="bayesian-data-analysis-2.html#cb1370-1" aria-hidden="true" tabindex="-1"></a>fit.brm_polite_gender <span class="sc">%&gt;%</span> </span>
<span id="cb1370-2"><a href="bayesian-data-analysis-2.html#cb1370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixef</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1370-3"><a href="bayesian-data-analysis-2.html#cb1370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;term&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 2 × 5
  term      Estimate Est.Error  Q2.5 Q97.5
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Intercept     247.      5.68  236. 258. 
2 genderM      -108.      8.08 -124. -92.1</code></pre>
<p>Yip, both of these methods give us the same result (the sign is flipped but that’s just because emmeans computed F-M, whereas the other method computed M-F)! Again, the <code>emmeans()</code> route is more convenient because we can more easily check for several main effects (and take a look at specific contrast, too).</p>
<div class="sourceCode" id="cb1372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1372-1"><a href="bayesian-data-analysis-2.html#cb1372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># main effect attitude</span></span>
<span id="cb1372-2"><a href="bayesian-data-analysis-2.html#cb1372-2" aria-hidden="true" tabindex="-1"></a>fit.brm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1372-3"><a href="bayesian-data-analysis-2.html#cb1372-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> attitude) <span class="sc">%&gt;%</span> </span>
<span id="cb1372-4"><a href="bayesian-data-analysis-2.html#cb1372-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>)</span></code></pre></div>
<pre><code>NOTE: Results may be misleading due to involvement in interactions</code></pre>
<pre><code> contrast  estimate lower.HPD upper.HPD
 inf - pol     19.7      4.49      35.4

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
<div class="sourceCode" id="cb1375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1375-1"><a href="bayesian-data-analysis-2.html#cb1375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># effect of attitude separately for each gender</span></span>
<span id="cb1375-2"><a href="bayesian-data-analysis-2.html#cb1375-2" aria-hidden="true" tabindex="-1"></a>fit.brm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1375-3"><a href="bayesian-data-analysis-2.html#cb1375-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> attitude <span class="sc">|</span> gender) <span class="sc">%&gt;%</span> </span>
<span id="cb1375-4"><a href="bayesian-data-analysis-2.html#cb1375-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>)</span></code></pre></div>
<pre><code>gender = F:
 contrast  estimate lower.HPD upper.HPD
 inf - pol     27.4      4.69      49.3

gender = M:
 contrast  estimate lower.HPD upper.HPD
 inf - pol     11.6    -10.06      33.9

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
<div class="sourceCode" id="cb1377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1377-1"><a href="bayesian-data-analysis-2.html#cb1377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in case you want the means instead of medians </span></span>
<span id="cb1377-2"><a href="bayesian-data-analysis-2.html#cb1377-2" aria-hidden="true" tabindex="-1"></a>fit.brm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1377-3"><a href="bayesian-data-analysis-2.html#cb1377-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> attitude <span class="sc">|</span> gender) <span class="sc">%&gt;%</span> </span>
<span id="cb1377-4"><a href="bayesian-data-analysis-2.html#cb1377-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1377-5"><a href="bayesian-data-analysis-2.html#cb1377-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_emmeans_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1377-6"><a href="bayesian-data-analysis-2.html#cb1377-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean_hdi</span>()</span></code></pre></div>
<pre><code># A tibble: 2 × 8
  contrast  gender .value .lower .upper .width .point .interval
  &lt;fct&gt;     &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
1 inf - pol F        27.5   4.69   49.3   0.95 mean   hdi      
2 inf - pol M        11.6 -10.1    33.9   0.95 mean   hdi      </code></pre>
<p>Here is a way to visualize the contrasts:</p>
<div class="sourceCode" id="cb1379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1379-1"><a href="bayesian-data-analysis-2.html#cb1379-1" aria-hidden="true" tabindex="-1"></a>fit.brm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1379-2"><a href="bayesian-data-analysis-2.html#cb1379-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(<span class="at">specs =</span> pairwise <span class="sc">~</span> attitude <span class="sc">|</span> gender) <span class="sc">%&gt;%</span> </span>
<span id="cb1379-3"><a href="bayesian-data-analysis-2.html#cb1379-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;contrasts&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1379-4"><a href="bayesian-data-analysis-2.html#cb1379-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather_emmeans_draws</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1379-5"><a href="bayesian-data-analysis-2.html#cb1379-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .value,</span>
<span id="cb1379-6"><a href="bayesian-data-analysis-2.html#cb1379-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> gender,</span>
<span id="cb1379-7"><a href="bayesian-data-analysis-2.html#cb1379-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="fu">stat</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>))) <span class="sc">+</span> </span>
<span id="cb1379-8"><a href="bayesian-data-analysis-2.html#cb1379-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> contrast) <span class="sc">+</span></span>
<span id="cb1379-9"><a href="bayesian-data-analysis-2.html#cb1379-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span> </span>
<span id="cb1379-10"><a href="bayesian-data-analysis-2.html#cb1379-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, </span>
<span id="cb1379-11"><a href="bayesian-data-analysis-2.html#cb1379-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1379-12"><a href="bayesian-data-analysis-2.html#cb1379-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;gray80&quot;</span>, <span class="st">&quot;skyblue&quot;</span>))</span></code></pre></div>
<p><img src="23-bayesian_data_analysis2_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<p>Here is one way to check whether there was an interaction between attitude and gender (see <a href="https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html">this vignette</a> for more info).</p>
<div class="sourceCode" id="cb1380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1380-1"><a href="bayesian-data-analysis-2.html#cb1380-1" aria-hidden="true" tabindex="-1"></a>fit.brm_polite <span class="sc">%&gt;%</span> </span>
<span id="cb1380-2"><a href="bayesian-data-analysis-2.html#cb1380-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(pairwise <span class="sc">~</span> attitude <span class="sc">|</span> gender) <span class="sc">%&gt;%</span> </span>
<span id="cb1380-3"><a href="bayesian-data-analysis-2.html#cb1380-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="st">&quot;emmeans&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1380-4"><a href="bayesian-data-analysis-2.html#cb1380-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">contrast</span>(<span class="at">interaction =</span> <span class="fu">c</span>(<span class="st">&quot;consec&quot;</span>),</span>
<span id="cb1380-5"><a href="bayesian-data-analysis-2.html#cb1380-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">by =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code> attitude_consec gender_consec estimate lower.HPD upper.HPD
 pol - inf       M - F             16.2     -17.2      46.9

Point estimate displayed: median 
HPD interval probability: 0.95 </code></pre>
</div>
</div>
</div>
<div id="additional-resources-16" class="section level2 hasAnchor" number="23.8">
<h2><span class="header-section-number">23.8</span> Additional resources<a href="bayesian-data-analysis-2.html#additional-resources-16" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html">Tutorial on visualizing brms posteriors with tidybayes</a></li>
<li><a href="https://mucollective.northwestern.edu/files/2018-HOPsTrends-InfoVis.pdf">Hypothetical outcome plots</a></li>
<li><a href="https://cran.r-project.org/web/packages/bayesplot/vignettes/visual-mcmc-diagnostics.html#general-mcmc-diagnostics">Visual MCMC diagnostics</a></li>
<li><a href="https://chi-feng.github.io/mcmc-demo/">Visualization of different MCMC algorithms</a></li>
<li><a href="https://elevanth.org/blog/2017/11/28/build-a-better-markov-chain/">Article describing the different inference algorithms</a></li>
</ul>
</div>
<div id="session-info-22" class="section level2 hasAnchor" number="23.9">
<h2><span class="header-section-number">23.9</span> Session info<a href="bayesian-data-analysis-2.html#session-info-22" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Information about this R session including which version of R was used, and what packages were loaded.</p>
<div class="sourceCode" id="cb1382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1382-1"><a href="bayesian-data-analysis-2.html#cb1382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.1.2 (2021-11-01)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 10.16

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.5.1       stringr_1.4.0       dplyr_1.0.9        
 [4] purrr_0.3.4         readr_2.1.2         tidyr_1.2.0        
 [7] tibble_3.1.7        tidyverse_1.3.1     transformr_0.1.3   
[10] parameters_0.17.0   gganimate_1.0.7     titanic_0.1.0      
[13] ggeffects_1.1.2     emmeans_1.7.3       car_3.0-13         
[16] carData_3.0-5       afex_1.1-1          lme4_1.1-29        
[19] Matrix_1.4-1        modelr_0.1.8        bayesplot_1.9.0    
[22] broom.mixed_0.2.9.4 GGally_2.1.2        ggplot2_3.3.6      
[25] patchwork_1.1.1     brms_2.17.0         Rcpp_1.0.8.3       
[28] tidybayes_3.0.2     janitor_2.1.0       kableExtra_1.3.4   
[31] knitr_1.39         

loaded via a namespace (and not attached):
  [1] utf8_1.2.2           tidyselect_1.1.2     htmlwidgets_1.5.4   
  [4] grid_4.1.2           lpSolve_5.6.15       munsell_0.5.0       
  [7] codetools_0.2-18     units_0.8-0          DT_0.22             
 [10] future_1.25.0        gifski_1.6.6-1       miniUI_0.1.1.1      
 [13] withr_2.5.0          Brobdingnag_1.2-7    colorspace_2.0-3    
 [16] highr_0.9            rstudioapi_0.13      stats4_4.1.2        
 [19] listenv_0.8.0        labeling_0.4.2       rstan_2.21.5        
 [22] bit64_4.0.5          farver_2.1.0         datawizard_0.4.0    
 [25] bridgesampling_1.1-2 coda_0.19-4          parallelly_1.31.1   
 [28] vctrs_0.4.1          generics_0.1.2       TH.data_1.1-1       
 [31] xfun_0.30            R6_2.5.1             markdown_1.1        
 [34] HDInterval_0.2.2     rstanarm_2.21.3      reshape_0.8.9       
 [37] assertthat_0.2.1     vroom_1.5.7          promises_1.2.0.1    
 [40] scales_1.2.0         nnet_7.3-17          multcomp_1.4-19     
 [43] gtable_0.3.0         globals_0.14.0       processx_3.5.3      
 [46] sandwich_3.0-1       rlang_1.0.2          systemfonts_1.0.4   
 [49] splines_4.1.2        broom_0.8.0          checkmate_2.1.0     
 [52] inline_0.3.19        yaml_2.3.5           reshape2_1.4.4      
 [55] abind_1.4-5          threejs_0.3.3        crosstalk_1.2.0     
 [58] backports_1.4.1      httpuv_1.6.5         Hmisc_4.7-0         
 [61] tensorA_0.36.2       tools_4.1.2          bookdown_0.26       
 [64] ellipsis_0.3.2       jquerylib_0.1.4      posterior_1.2.1     
 [67] RColorBrewer_1.1-3   proxy_0.4-26         ggridges_0.5.3      
 [70] plyr_1.8.7           base64enc_0.1-3      progress_1.2.2      
 [73] classInt_0.4-3       ps_1.7.0             prettyunits_1.1.1   
 [76] rpart_4.1.16         zoo_1.8-10           cluster_2.1.3       
 [79] haven_2.5.0          fs_1.5.2             furrr_0.3.0         
 [82] magrittr_2.0.3       data.table_1.14.2    ggdist_3.1.1        
 [85] lmerTest_3.1-3       reprex_2.0.1         colourpicker_1.1.1  
 [88] mvtnorm_1.1-3        matrixStats_0.62.0   hms_1.1.1           
 [91] shinyjs_2.1.0        mime_0.12            evaluate_0.15       
 [94] arrayhelpers_1.1-0   xtable_1.8-4         shinystan_2.6.0     
 [97] jpeg_0.1-9           readxl_1.4.0         gridExtra_2.3       
[100] rstantools_2.2.0     compiler_4.1.2       KernSmooth_2.23-20  
[103] crayon_1.5.1         minqa_1.2.4          StanHeaders_2.21.0-7
[106] htmltools_0.5.2      mgcv_1.8-40          tzdb_0.3.0          
[109] later_1.3.0          Formula_1.2-4        RcppParallel_5.1.5  
[112] lubridate_1.8.0      DBI_1.1.2            sjlabelled_1.2.0    
[115] tweenr_1.0.2         dbplyr_2.1.1         MASS_7.3-57         
[118] sf_1.0-7             boot_1.3-28          cli_3.3.0           
[121] parallel_4.1.2       insight_0.17.0       igraph_1.3.1        
[124] pkgconfig_2.0.3      foreign_0.8-82       numDeriv_2016.8-1.1 
[127] xml2_1.3.3           svUnit_1.0.6         dygraphs_1.1.1.6    
[130] svglite_2.1.0        bslib_0.3.1          webshot_0.5.3       
[133] estimability_1.3     rvest_1.0.2          snakecase_0.11.0    
[136] distributional_0.3.0 callr_3.7.0          digest_0.6.29       
[139] cellranger_1.1.0     rmarkdown_2.14       htmlTable_2.4.0     
[142] shiny_1.7.1          gtools_3.9.2         nloptr_2.0.0        
[145] lifecycle_1.0.1      nlme_3.1-157         jsonlite_1.8.0      
[148] viridisLite_0.4.0    fansi_1.0.3          pillar_1.7.0        
[151] lattice_0.20-45      loo_2.5.1            fastmap_1.1.0       
[154] httr_1.4.3           pkgbuild_1.3.1       survival_3.3-1      
[157] glue_1.6.2           xts_0.12.1           bayestestR_0.12.1   
[160] png_0.1-7            shinythemes_1.2.0    bit_4.0.4           
[163] class_7.3-20         stringi_1.7.6        sass_0.4.1          
[166] latticeExtra_0.6-29  e1071_1.7-9         </code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-data-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-data-analysis-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"],
"google": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/psych252/psych252book/edit/master/23-bayesian_data_analysis2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
